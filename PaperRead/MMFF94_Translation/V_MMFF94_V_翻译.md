## Merck 分子力场第五部分： 使用实验数据、额外计算数据和经验规则扩展MMFF94*

### 摘要
本文描述了默克分子力场（MMFF94）扩展到更广泛有机系统的过程。它还描述了MMFF94对水合氢离子和氢氧根离子以及各种卤化物、碱金属和碱土金属离子以及诸如$Zn^{2+}$、$Ca^{2+}$、$Cu^{2+}$、$Cu^{+}$、$Fe^{2+}$和$Fe^{3+}$等“蛋白质”金属的初步参数化。该扩展使用了关于一系列氧硫（特别是磺酰胺）和氧磷化合物的电荷分布、分子几何构型和构象能的计算数据，以及核心参数化未覆盖的多种小分子和离子的计算数据。它还使用了从剑桥结构数据库（CSD）提取的大约2800个高质量结构的实验数据。部分额外计算数据用于扩展静电相互作用的显式参数化，并更广泛地定义MMFF94中使用的“键极性”参数（键电荷增量）的有用加和近似。实验和计算数据共同用于定义参考键长和键角，扩展力场将这些参考值与通过仔细校准的经验规则获得的力常数结合使用。扩展的扭转参数部分由为重现MP2/6-31G* 构象能而导出的显式参数组成，部分由仿照DREIDING和UFF中使用的经验规则提供但尽可能针对MMFF94校准的“默认参数”组成。与实验数据的比较表明，MMFF94 能够以相对较小的均方根（rms）偏差（分别为约 $0.02    \AA$和 $2^\circ$）来重现晶体结构中的键长和键角。

### 引言

这是介绍MMFF94（默克分子力场的初始发布版本）系列文章的第五篇也是结论性文章。[^1][^2][^3][^4] 本文描述了（i）将MMFF94的核心参数化扩展到更广泛的有机和生物有机结构，以及（ii）对生物有机建模中常见的一系列离子进行MMFF94的初步参数化。

用于扩展MMFF94参数化的实验数据在下一节描述。第三部分总结了MMFF94的函数形式，第四部分定义了与MMFF原子类型相关的各种“属性”。这些原子类型属性用于各种经验规则和参数分配程序。接下来，第五至第十部分描述了使用实验数据、经验规则和额外计算数据来分配MMFF94核心部分未定义的参数。[^2][^3][^4] 第十一部分以初步方式将参数化扩展到“蛋白质”金属，如$Zn^{2+}$、$Ca^{2+}$、$Mg^{2+}$、$Cu^{2+}$、$Cu^{+}$、$Fe^{2+}$和$Fe^{3+}$，以及水合氢离子和氢氧根离子和各种卤化物、碱金属和碱土金属离子。第十二部分然后针对用于其推导的晶体学结构以及先前用于其他分子力场评估的较小结构集，表征了扩展力场的性能。最后一部分总结了这项工作并给出了结论。

### 用于扩展MMFF94的实验数据

用于扩展MMFF94的实验数据来自剑桥结构数据库（CSD）的5.04版（1992年10月）。[^5] 我们首先提取了139个有机中子衍射结构，这些结构的R因子为0.075或更低，且最多有60个原子。在这个小的初始集合中，我们分批添加了类似大小的X射线结构，首先要求那些R因子为0.05或更低的；为了获得足够的数据，我们最终允许R因子高达0.075的结构。选择筛选还要求，例如，条目为“有机”，残基包含1到12个碳原子，不存在无序或键差异，并且C—C键的均方根偏差为0.010 Å或更好。此外，我们只接受包含H、C、N、O、F、Si、P、S、Cl、Br和I的结构。此过程产生了3777个CSD结构。

我们使用MAX_MOL[^6]通过距离标准分配单键和多键，来准备提取的结构以输入到OPTIMOL[^1]（MMFF的主分子力学平台）。然后，我们使用源自OPTIMOL的程序将所得结构分区成集合，根据当时构成的MMFF是否能正确处理它们。我们图形化检查了所有被拒绝的结构，并通常丢弃那些没有氢原子的结构。然而，对于一些具有“有趣”化学性质的结构，我们使用AMF的IDEALIZE模块中嵌入的标准规则添加了缺失的氢。[^7] 我们还使用AMF修复了键级分配错误的结构。其他OPTIMOL无法处理的结构体现了现有MMFF原子类型程序未覆盖的化学性质。我们丢弃了一些此类情况——例如，涉及鏻盐或锍盐或包含碳基或高度离域阴离子中心的情况——但通过定义额外的原子类型并相应增强OPTIMOL的原子类型能力来容纳其他情况。最终，我们保留了2861个CSD结构用于扩展MMFF94的参数化。一些重复结构（在不同实验条件下确定的化学相同结构）被无意中包括在内，但大多数代表不同的化学实体。

### 默克分子力场的形式

MMFF94 能量表达式可写为：
$$
\begin{gather}
E_{\mathrm{MMFF}} = \sum EB_{ij} + \sum EA_{ijk} + \sum EBA_{ijk} + \sum \mathrm{EOOP}_{ijk;l} \\+ \sum E\mathrm{T}_{ijkl} + \sum \mathrm{EvdW}_{ij} + \sum EQ_{ij}\tag{1}

\end{gather}
$$


这七个组成项分别描述键拉伸、角弯曲、拉伸-弯曲、面外弯曲、扭转、范德华和静电相互作用，其定义总结如下。当距离和角度分别以埃和度为单位给出时，每项均以千卡每摩尔为单位获得[^1-4]
$$
\begin{gather}

EB_{ij} = 143.9325 \frac{k_{b,IJ}}{2} \Delta r_{ij}^{2}
\times (1 + cs \Delta r_{ij} + 7/12cs^{2} \Delta r_{ij}^{2})
\tag{2}\\

EA_{ijk} = 0.043844 \frac{k_{a,IJK}}{2} \Delta \vartheta_{ijk}^{2} (1 + c b \Delta \vartheta_{ijk})
\tag{3}\\

EA_{ijk} = 143.9325k_{a,IJK} (1 + \cos \vartheta_{ijk})
\tag{4}\\

\mathrm{EBA}_{ijk} = 2.51210(k_{ba,IJK} \, \Delta r_{ij} + k_{ba,IJK} \, \Delta r_{kj}) \, \Delta \vartheta_{ijk}
\tag{5}\\

\mathrm{EOOP}_{ijk;l} = 0.043844 \frac{k_{oop,IJK:L}}{2} \chi_{ijk;l}^{2}
\tag{6}\\

ET_{ijkl} = 0.5\,\bigl[V_{1}(1+\cos\Phi) + V_{2}(1-\cos 2\Phi) + V_{3}(1+\cos 3\Phi)\bigr]\tag{7}\\

E_{\text{vdW}} = \varepsilon_{IJ}\, \left(\frac{1.07R_{IJ}^{*}}{R_{ij}+0.07R_{IJ}^{*}}\right)^{7}\, \left(\frac{1.12{R_{IJ}^{*}}^7}{R_{ij}^{7}+0.12{R_{IJ}^{*}}^7} - 2\right)
\tag{8}\\

R_{II}^{*} = A_{I} \alpha_{I}^{1/4}
\tag{9}\\

R_{IJ}^{*} = 0.5(R_{II}^{*} + R_{Jj}^{*})(1 + 0.2(1 - \exp(-12\gamma_{IJ}^{2})))
\tag{10}\\

\gamma_{IJ} = (R_{II}^{*} - R_{JJ}^{*})/(R_{II}^{*} + R_{Jj}^{*})
\tag{11}\\

\epsilon_{IJ} = \frac{181.16 G_{I} G_{J} \alpha_{I} \alpha_{J}}{(\alpha_{I}/N_{I})^{1/2} + (\alpha_{J}/N_{J})^{1/2}} \frac{1}{R_{IJ}^{*6}}
\tag{12}\\
EQ_{ij} =\frac{332.0716 q_i q_j }{ D (R_{ij} + \delta)^n}
\tag{13}
\end{gather}
$$


> Paper 1, 序号相同

在本研究全文中，我们采用以下约定：力场相互作用中涉及的特定原子用 $i, j, k, \ldots$ 表示，而相应的 MMFF 数值原子类型（或者有时，如所指出的，原子种类）用 $l, j, K, \ldots$ 表示。例如，这种表示法明确表明，i–j 键在 $\Delta r_{ij} = r_{ij} - r^0_{ij}$ [式 (2)] 中的力常数 $k_b l$ 和参考键长 $r^0_{ij}$ 取决于相关的 MMFF 原子类型 I 和 J，而键距 $r_{ij}$ 取决于原子坐标。

---

### MMFF94 原子类型及相关属性

先前发布的 MMFF 原子类型集[^8]已被扩展，以适应 MMFF94 核心参数化所需的更精细区分，并覆盖 CSD 数据中代表的更广泛的化学范围。第一部分[^1]的表 III 给出了当前 MMFF 符号原子类型和相应数值原子类型的完整列表。

表 I 定义了与 MMFF 数值原子类型相关的原子属性。这些量用于建立 MMFF94 能量表达式以及根据定义的经验规则确定缺失参数的值。前两列列出了 MMFF 数值原子类型和相关的原子序数。第 3 列标记为“crd”，指定了必须键合的相邻原子数，第 4 列标记为“val”，给出了与该原子类型形成的键总数。如果条目显示两位数，例如原子类型 54 和 55 的“34”，则形式化合价可以是两个连接值中的任意一个——例如，“3”或“4”。第 5 列（“pilp”）中的条目“1”定义了那些具有能够参与共振相互作用（例如，与相邻多重键）的“π 孤对电子”的原子类型。第 6 列标题为“mltb”，指定了预期与具有所列原子类型的原子形成双键（“2”）或三键（“3”）的情况。此列中的条目“1”指定了在后续讨论的键长经验规则中采用“中间”键缩短的情况。这些条目大致对应于可以预期存在向相邻原子强离域的情况。然后，第 7 列通过条目“1”指定了“芳香”原子类型集合，第 8 列（“lin”）类似地描绘了作为中心原子时产生线性理想键角 I-I-K 的双配位原子类型 I。最后一列标题为“sbmb”（代表“单键-多键”），其中的条目“1”指定了那些可以与 sp$^2$ 或 sp 杂化相邻原子形成多重键或离域单键的原子类型。这种单键的一个例子是连接丁二烯两个中心碳原子的键，每个碳原子具有数值原子类型 2。这些“sbmb”条目用于分配第三部分[^3]中定义的“键类型”索引 BT$_I$；每当发现单键（形式键级为 1）时，就会分配一个非标准的键类型索引“1”：(a) 在类型不都是芳香族且表 I 中“sbmb”条目为“1”的原子 i 和 j 之间；或 (b) 在属于不同芳香环的原子对之间（如联苯中的连接 C=C 键）。

表 I.
与 MMFF94 原子类型相关的属性。

| atype[^a] | at.no.[^b] | crd[^c] | val[^d] | plip[^e] | mltb[^f] | arom[^g] | lin[^h] | sbmb[^j] |
| --------- | ---------- | ------- | ------- | -------- | -------- | -------- | ------- | -------- |
| 1         | 6          | 4       | 4       | 0        | 0        | 0        | 0       | 0        |
| 2         | 6          | 3       | 4       | 0        | 2        | 0        | 0       | 1        |
| 3         | 6          | 3       | 4       | 0        | 2        | 0        | 0       | 1        |
| 4         | 6          | 2       | 4       | 0        | 3        | 0        | 1       | 1        |
| 5         | 1          | 1       | 1       | 0        | 0        | 0        | 0       | 0        |
| 6         | 8          | 2       | 2       | 1        | 0        | 0        | 0       | 0        |
| 7         | 8          | 1       | 2       | 0        | 2        | 0        | 0       | 0        |
| 8         | 7          | 3       | 3       | 1        | 0        | 0        | 0       | 0        |

[^a]: MMFF 原子类型。
[^b]: 原子序数。
[^c]: 键合相邻原子数。
[^d]:  化合价（参见正文中对诸如“34”等条目的解释）。
[^e]: 值为 1 表示存在一个或多个 π 孤对电子。
[^f]:  多重键指示符（参见正文）。
[^g]: 值为 1 表示“芳香”原子类型。
[^ h ]: 值为 1 表示一个双配位原子类型，其作为中心原子时产生线性键角。
[^i ]: 单键-多重键指示符（参见正文）。

---

### 静电相互作用参数化的扩展

在进行 MMFF94 参数化的这一扩展时，我们意识到所得力场的性能将关键取决于式 (13) 中使用的部分原子电荷的质量。我们首先考虑在扩展参数化中如何分配这些电荷。

MMFF94 中使用的部分原子电荷 $q_i$ 是由初始的完整或分数的“形式原子电荷”（通常为零，但例如，胍基氮为 +1/3）加上描述来自连接原子 k 的键极性的“键电荷增量” $\omega_{k1}$ 的贡献构建而成。具体来说，$\omega_{k1}$ 给出了原子类型为 l 的原子 i 上，从其键合邻居原子类型为 K 的原子 k 积累而来（并以牺牲 k 为代价）的对最终部分电荷的贡献。因此，MMFF94 计算 $q_i$ 为：

$$
q_i = q_i^0 + \sum \omega_{k1} \tag{14}
$$
其中 $\omega_{k1} = -\omega_{ik}$。

虽然新的范德华参数或许可以从类似原子类型的数据中以合理的精度估算出来，但我们怀疑能否以这种方式获得足够精确的键电荷增量。因此，我们根据如下所述的合适的量子力学数据确定了许多额外的键电荷增量。由于扩展参数化使 MMFF94 识别的不同化学键类型的数量增加了近五倍（即从 107 种增加到 480 种），完整、显式地确定所有所需的键电荷增量成本将高得令人望而却步。然而幸运的是，我们发现核心 MMFF94 键电荷增量 $\omega_{k1}$ 可以相当合理地近似表示为 $\omega_{k1} \approx p_l - p_k$，其中 $p_l$ 和 $p_k$ 是“部分键电荷增量”，主要反映了 I 型和 K 型原子的相对电负性。如下所述，这种近似方法的可用性意味着我们只需要确定足够多的额外键电荷增量的显式参数，以便为每个 MMFF94 原子类型分配一个部分键电荷增量。

以下两个小节描述了额外的参数化键电荷增量的推导以及部分键电荷增量的确定。还讨论了在需要分配负值分数形式原子电荷的系统中出现的一个复杂问题。

#### 额外键电荷增量的参数化以及形式和部分原子电荷的分配

我们使用 GAUSSIAN 92[^9] 为表 II 所列的额外 63 个小分子和分子离子组确定了优化的 HF/6-31G$^*$ 几何结构。为了辅助键电荷增量的参数化，我们随后使用 GAUSSIAN 92 中实现的 CHELPG[^10] 来获得这些体系的静电势拟合电荷。这组化合物侧重于阴离子体系以及含硫和磷的化合物，特别是含氧形式。

与核心 MMFF94 参数化中的做法非常相似，我们通过拟合从头算偶极矩，推导出了在这组分子中遇到的 62 种新化学键类型的键电荷增量。为了使拟合确定，我们将其中 27 个 $\omega_{k1}$（大多数涉及末端原子）固定在与 CHELPG 导出电荷一致的值上，然后使用 PROBE[^11] 将其余的键电荷增量拟合到 HF/6-31G$^*$ 偶极矩（增强了 10%）[^2]。我们还将所有核心 MMFF94 键电荷增量固定在它们先前确定的值上。最小二乘拟合生成了参数文件中标记为“X94”的 35 个优化键电荷增量参数。该文件还包含 39 个受约束或以其他方式分配[^12]的标记为“#X94”的键电荷增量。

当一个给定类型的原子，例如类型 32 的末端氧，携带可变的部分形式电荷时，会出现一个复杂情况，例如，在磷酸根离子中为 -3/4，在 $\text{HPO}_4^{-2}$ 中为 -2/3（其中三个末端氧共享 -2 的净离子电荷），在 $\text{H}_2\text{PO}_4^{-}$ 中为 -1/2，在磷酸中为 0。因为 MMFF94 在这些情况下都将 P—O 键视为具有相同的极性（即相同的键电荷增量），所以末端氧的最终电荷 $q_i$在这些体系中必然与初始 $q_i^0$ 值发生相同程度的变化。相比之下，CHELPG 计算将 $\text{PO}_4^{-3}$ 中末端氧的净部分原子电荷分配为 -1.17，$\text{H}_3\text{PO}_4$ 中为 -0.75。这种变化达到 0.42 个电子，无论在意义上还是幅度上，在化学上似乎都是合理的。另一方面，直接应用式 (14) 会导致末端氧电荷产生 0.75 个电子的更大变化——我们认为这太大了。

为了解决这个难题，我们本可以分配不同的磷或氧原子类型（以及针对各种含氧硫化合物等的不同原子类型）给每个离散的环境。这种方法将允许使用不同的 $P-O$ 键电荷增量，但会导致原子类型激增。相反，我们决定保留最少的原子类型集合，但允许最初附加的形式原子电荷与相邻原子共享。为了实现这种方法，我们将式 (14) 重写为
$$
q_i = (1 - M_i \vartheta_i) q_i^0 + \vartheta_i \sum q_k^0 + \sum \omega_{kI} \tag{15}
$$
其中右边的求和遍及与原子 i 直接相连的 $M_i = crd(I)$ 个 MMFF 原子类型为 $K$ 的原子 $k$。在式 (15) 中，$q_i^0$ 和 $q_k^0$ 仍然是在主要原子类型分配程序中分配的形式原子电荷（例如，上述含氧磷系列中引用的那些）。那么，前两项的和可以理解为给出了“有效”形式原子电荷，这些电荷需要在更简单的式 (14) 中用作 $q_i^0$。（我们将使用术语“主要”和“有效”来表示这种区别。）对于含氧磷系列，我们对 MMFF 类型 32 的末端氧取 $\theta_i = 0.5$。对于这样的氧原子，$M_i$ 为 1，并且相连的磷不携带主要形式原子电荷。因此，末端氧上的有效形式原子电荷是主要值的一半，即在 $PO_4^{-3}$ 中为 $-0.375$，在 $HPO_4^{-2}$ 中为 $-0.333$，在 $H_2PO_4^{-2}$ 中为 $-0.25$，在 $H_3PO_4$ 中为 $0.0$。因此，两种极限情况之间的变化减少到 0.375 个电子，与 CHELPG 计算发现的 0.42 个电子的变化满意地接近。对于中心磷原子，没有分配主要形式原子电荷，但是 4、3、2 或 1 个附着的末端氧（它们携带的主要形式原子电荷分别为 $-0.75$、$-0.666$、$-0.50$ 和 $0.00$）在磷上产生的有效形式原子电荷分别为 $-1.50$、$-1.00$、$-0.50$ 和 $0.00$。

类似地，对于羧酸根氧，在式 (15) 中使用的主要 $q_i^0$ 值为 $-0.5$，但使用 $\theta_{32} = 0.5$ 和 $M_{32} = 1$ 获得的有效 [式 (14)] 值为 $-0.25$。对于羧酸根碳，主要 [式 (15)] 的 $q_i^0$ 值为 0，但有效 [式 (14)] 值为 $-0.5$，因为两个附着的末端氧各自转移了其 $-0.5$ 主要形式电荷的一半。虽然在这最后一种情况下并不严格要求电荷共享，但我们发现需要这样做，以便能为下面的式 (17) 定义一套一致的电负性相关的“部分键电荷增量”。形式电荷调整因子 $\theta_i$ 的完整集合在表 III 中给出。为 $\theta_i$ 选择的值导致在形式原子电荷为负的情况下，每个主要形式原子电荷的一半被转移到直接键合的相邻原子上；当形式电荷为正时，目前不调用电荷共享。

我们应该注意，MMFF94 分配部分原子电荷的机制不能准确地表示不对称但强离域的阴离子（如乙烯氧阴离子 ($H_2C=CH-O^-$) 和乙烯硫阴离子 ($H_2C=CH-S^-$)）中的电荷分布。为了正确模拟这种共振电荷分布，MMFF94 可能需要从一个适当分布的形式原子电荷开始，或者包含类似于 Abraham 及其同事使用的显式三体调整项[^13]。然而，在对称体系（如羧酸根阴离子）中不会出现类似的问题，因为 MMFF94 识别出两个末端氧是等价的，并为每个氧分配了 $-0.5$ 的主要分数形式原子电荷。

#### 键电荷增量的经验规则

最初，MMFF 及其前身 MM2X[^1] 使用简单的公式估算缺失的键电荷增量：
$$
\omega_{kI} = 0.25 (\chi_K - \chi_I) \tag{16}
$$
其中 $\chi_I$ 和 $\chi_K$ 是原子类型 I 和 K 对应的原子种类的 Pauling 电负性[^14]，0.25 是一个比例因子。在这项工作过程中，我们发现可以从一个类似的公式获得对参数化 MMFF94 键电荷增量好得多的估计：
$$
\omega_{kI} = \rho_I - \rho_K \tag{17}
$$

其中 $\rho_I$ 和 $\rho_K$ 现在完全依赖于 MMFF 原子类型，而不仅仅是原子种类。由于它们给出了键电荷增量 $\omega_{kI}$ 的加和分解，我们将 $\rho_I$ 称为“部分键电荷增量”。与式 (16) 的比较表明，它们实质上反映了 MMFF 原子类型的有效电负性。

我们使用迭代程序从已知的键电荷增量 $\omega_{kI}$ 推导出 $\rho_I$。为了使拟合确定，我们定义饱和碳（MMFF 原子类型 1）的 $\rho_I$ 恒等于 0。然后，我们从与原子类型 1 键合的原子类型的相关键电荷增量计算了 $\rho_I$ 的初始值。当应用于全部 195 个参数化键电荷增量（包括为前面小节描述的扩展参数化开发的那些）时，最终的 $\rho_f$ 值集合重现了参数化的 $\omega_{k_1}$，其均方根偏差为 0.06 个电子。这个均方根误差是这些键电荷增量均方根值 0.30 个电子的五分之一。大部分误差集中在相对少数的高极性键上；对于八个这样的情况，发现了 0.15–0.37 个电子的误差。鉴于这些情况有显式的键电荷增量可用，式 (17) 对于需要应用它的那些情况的性能可能比引用的 0.06 个电子的均方根误差所暗示的要好一些。

为了完成静电相互作用参数化的扩展，我们利用推导出的部分键电荷增量，通过式 (17) 计算了在 CSD 数据中遇到的额外化学键类型的显式键电荷增量。然后，我们将这些计算出的键电荷增量作为标记为“E94”的参数存储在相关的参数文件中。然而，在后续的 MMFF94 计算中遇到的新键类型将直接使用式 (17)——或者如果一个或两个 MMFF 原子类型缺少定义的部分键电荷增量，则使用式 (16)。

---

### 键拉伸参数化的扩展

#### 额外参考键长的参数化

此参数化紧密遵循了为 MMFF94 核心计算推导部分定义参考键长所使用的程序。它分两个阶段进行。在拟合中，获得了表 II 中所示的 58 个平衡构象异构体（那些五字符构象索引[^1]以“a”、“b”或“c”结尾的）以及表 IV 所列的 17 个额外构象异构体的 MP2/6-31G$^*$ 优化几何结构。从等同于平均 MP2/6-31G$^*$ 键长的参考值开始，获得了这些参考键长的精修值，并且如下一节所述，也获得了相关的参考键角的精修值。在迭代过程的每个周期中，使用了根据经验规则（后文描述）计算出的力常数。如前所述[^3]，参考键长和键角的迭代确定是交错进行的。对于核心参数化中未遇到的键类型，新确定的键参数随后被添加到核心集中。核心 MMFF94 和这些额外的基于 MP2/6-31G$^*$ 的参数在分发的参数集[^15]中分别标记为“C94”和“X94”。

在第二阶段，参考几何结构是从 CSD 数据中获得的。在对此数据的拟合中，初始参考键长设置为观察到的平均 CSD 键长，并且经验规则力常数在每个迭代周期后被计算和更新。收敛后，既不在“C94”也不在“X94”参数化中的键类型的参数也被添加到 MMFF94 参数集中，标记为“E94”以便识别。对于先前遇到的键类型，在大多数情况下，我们选择保留基于量子力学的“C94”或“X94”值。然而，我们注意到有 36 个实例，包括 6 个涉及核心 MMFF94 键长的实例[^5]，其中从晶体学数据导出的参考值与通过拟合 MP2/6-31G$^*$ 结构导出的参考值相差 0.03 Å 或更多。在这些情况下，我们替换了一个大致代表两次测定平均值的中间值。以这种方式修改的 6 个和 30 个参数集分别标记为“#C94”和“#X94”。此外，我们将两个 CSD 导出的与氢原子键合的参考值替换为经验规则值；众所周知，X 射线测定通常得出的 H—X 键长过短约 $\sim 0.1  \text{\AA}$。这些经验规则参数在分发的参数集[^15]中通过标签“#E94”进行标识。

表 IV.
用于扩展键和角相互作用参数化的额外分子。

| 构象索引$^8$ | 结构                                                        |
| ------------ | ----------------------------------------------------------- |
| PR01a        | 膦                                                          |
| RY01a        | 乙炔                                                        |
| RY02a        | 丙烯                                                        |
| SO01a        | 苯基 — NHSO$_2$ — 苯基, cnsc 邻位交叉, hnso 反式            |
| SO01b        | 苯基 — NHSO$_2$ — 苯基, cnsc 邻位交叉, hnso 顺式            |
| SO02a        | 苯基 — NHSO$_2$ — 甲基, cnsc 邻位交叉                       |
| SO02b        | 苯基 — NHSO$_2$ — 甲基, cnsc 斜扭, hncc 顺式                |
| SO02c        | 苯基 — NHSO$_2$ — 甲基, cnsc 斜扭, hncc 邻位交叉            |
| SO03a        | 甲基 — NHSO$_2$ — 苯基, cnsc 邻位交叉, hnso 邻位交叉        |
| SO03b        | 甲基 — NHSO$_2$ — 苯基, cnsc 邻位交叉, hnso 斜扭            |
| SO03c        | 甲基 — NHSO$_2$ — 苯基, cnsc 反式                           |
| SO04a        | 吡咯 — SO$_2$ — 苯基                                        |
| SO07a        | 苯基 — C(=O) — NHSO$_2$ — 甲基, csnc 邻位交叉               |
| SO07b        | 苯基 — C(=O) — NHSO$_2$ — 甲基, csnc 反式                   |
| SO07c        | 苯基 — C(=O) — NHSO$_2$ — 甲基, o = chh 顺式, csnc 邻位交叉 |
| SO07d        | 苯基 — C(=O) — NHSO$_2$ — 甲基, o = chh 顺式, csnc 斜扭     |
| SO12a        | 硫酸, C2                                                    |

 [^8]  见表 I 的脚注 a。

#### 参考键长的经验规则

如第一部分所述，在分配键拉伸参数时不调用原子类型等价性。相反，当没有完全合格的值可用时，则使用参考键长和键拉伸力常数的经验规则。

参考键长是使用 Schomaker-Stevenson 规则[^16]的修改版本分配的，该版本基于 Blom 和 Haaland 描述的形式[^17]。具体来说，我们采用[^18]：

$$
r_{ij}^{0} = r_{i}^{0} + r_{j}^{0} - c|\chi_{i} - \chi_{j}|^{n} - \delta
$$
其中 $r_{i}^{0}$ 和 $r_{j}^{0}$ 代表原子类型 I 和 J 的共价半径，$\chi_{i}$ 和 $\chi_{j}$ 是由 Allred 和 Rochow 定义的 Pauling 标度电负性，并且仅依赖于原子种类[^19]，c 是比例常数，n 是电负性项的幂依赖关系，$\delta$ 是一个“收缩”因子，它考虑了力场优化的键长往往比相关的参考键长稍长这一事实。比例常数 c，如果 i 或 j 是氢，则取 0.050，否则取 0.085。如同在 Blom 和 Haaland 的工作中一样，幂依赖关系 n 取为 1.4。收缩因子 $\delta$ 赋值为 0.008 Å。该值代表了在 MMFF94 核心计算推导部分定义的参考键长平均低于观察到的 MP2/6-31G$^*$ 优化键长的量。

除两个例外，单键的共价半径 $r_{i}^{0}$ 取自 Blom 和 Haaland（如果可用），或取自标准汇编[^20]。对于氢和碳，通过要求经验规则尽可能接近地预测核心 MMFF94 参考键长，分配了 0.33 和 0.77 Å（而不是 0.34 和 0.79 Å）的单键共价半径。请注意，这些单键半径仅依赖于原子种类，而不依赖于完整的 MMFF 原子类型。多重键和共振离域键的共价半径通过以下方式从单键半径分配。首先，为原子 i 和 j 指定“杂化指数” $H_{i}$ 和 $H_{j}$。在大多数情况下，这些量被赋予值“3”（对应于 sp$^3$ 杂化），但如果表 I 中相关原子类型的“mltb”条目是“1”或“2”，则赋予值“2”，或者如果“mltb”条目是“3”，则赋予值“1”。接下来，根据表 I 中给出的连接性和原子类型属性分配一个与键级相关的索引 BO$_{ij}$。BO$_{ij}$ 初始化为形式 i-j 键级“1”、“2”或“3”，但如果 mltb(I) 和 mltb(J) 都是“1”，则重置为“4”，如果其中一个值是“1”而另一个是“2”，则重置为“5”。最后，当 i 和 j 是属于同一芳香环的芳香原子时，如果 pilp(I) 和 pilp(J) 都是“0”（即，如果两者都没有 π 孤对电子），则 BO$_{ij}$ 设置为“4”，否则设置为“5”；这种区分允许在 BO$_{ij}$ = 5 时应用比 BO$_{ij}$ = 4 时更小的共振相关缩短。

然后，分配的 $H_{i}$、$H_{j}$ 和 BO$_{ij}$ 值按如下方式使用。首先，将 $r_{i}^{0}$ 和 $r_{j}^{0}$ 设置为相应原子种类的列表单键半径。然后，如果 BO$_{ij}$ = 5，则每个减少 0.04 Å；如果 BO$_{ij}$ = 4，减少 0.075 Å；如果 BO$_{ij}$ = 3（三键），减少 0.17 Å；如果 BO$_{ij}$ = 2（完全双键），减少 0.10 Å。最后，当 BO$_{ij}$ = 1（单键）时，杂化指数开始起作用。具体来说，对于 $x = l$, $l$，如果 $H_{x}$ = 1，则 $r_{i}^{0}$ 减少 0.08 Å；如果 $H_{x}$ = 2，则减少 0.03 Å。由这些调整产生的 $r_{i}^{0}$ 和 $r_{j}^{0}$ 值随后用于式 (18) 中。这些调整因子代表了通过检查实验观察到的和优化的核心 MMFF94 键长中的模式而确定的经验校正。可以注意到，所列出的完全双键和三键的校正与 Pauling 引用的结果一致[^21]。

#### 键拉伸力常数的经验规则

在已提出的众多键拉伸力常数的经验规则中[^22]，Badger 规则[^23]或许是最著名的。然而，在这项工作中，我们使用六次方反比关系将所需的力常数与列表参考值联系起来。这种六次方依赖关系早些时候由 Roy 提出[^24]。最近，Byler 等人[^25]表明，使用指数 5.35 的类似关系能准确地关联 C-N 键的力常数和键长。此处为简单起见，我们使用指数六并采用

$$
kb_{ij} = kb_{rel}(r_{rel}^{0}/r_{ij}^{0})^{6}
$$
其中 $kb_{ref}$ 和 $r^{0}_{ref}$ 是表 V 中给出的力常数和相关参考键长，$r^{0}_{ij}$ 是从键拉伸参数文件中检索的或根据式 (18) 计算出的参考键长。请注意，$kb_{ref}$ 和 $r^{0}_{ref}$ 依赖于 i 和 j 的原子种类，而不是它们完整的 MMFF 数值原子类型 I 和 J。然而，为了简化符号，在书写式 (19) 时已省略了这种依赖性。

在表 V 中，大多数参考键长 $r^{0}_{ref}$ 是取自 Peterson 和 Csizmadia$^2$ 的“标准几何模型”的单键键长；只有 N—N、N—O 和 O—S 键的 $r^{0}_{ref}$ 值有明显差异。对于标记为“C94”的条目，相关的参考力常数 $kb_{ref}$ 是通过要求式 (19) 给出的力常数 $kb_{ij}$ 在使用相关参考键长 $r^{0}_{ij}$ 的经验规则中尽可能接近地预测核心 MMFF94 力常数来确定的。当使用这些 $r^{0}_{ij}$ 值时，式 (19) 重现了全部 107 个核心 MMFF94 力常数，其均方根偏差相对较小，为 0.75 md/Å$^2$，约为均方根值 5.81 md/Å 的八分之一。表 V 中标记为“E94”的条目的力常数 $kb_{ref}$ 无法以类似方式校准，因为没有推导出 $kb_{ij}$ 的显式参数化值。相反，这些力常数是通过使用 Herschbach 和 Laurie$^28$ 的 Badger 规则参数化在列表的 $r^{0}_{ref}$ 键长处评估得到的。如果出现式 (19) 所需的参数未包含在参数文件中的情况（参见表 V），则 $kb_{ij}$ 的经验规则将直接使用 Herschbach 和 Laurie 实现的 Badger 规则，其中 $r_{ij}^0$ 由式 (18) 给出。

表 V. 用于式 (19) 的键拉伸经验规则力常数的 MMFF94 参数。

| $i$  | $j$  | $r^{0,a}_{ref}$ | $kb_{ref}^{b}$ | 来源$^c$ | $i$  | $j$  | $r^{0,a}_{ref}$ | $kb_{ref}^{b}$ | 来源$^c$ |
| ---- | ---- | --------------- | -------------- | -------- | ---- | ---- | --------------- | -------------- | -------- |
| H    | C    | 1.084           | 5.15           | C94      | O    | O    | 1.48            | 3.6            | E94      |
| H    | N    | 1.001           | 7.35           | C94      | O    | F    | 1.42            | 4.6            | E94      |
| H    | O    | 0.947           | 9.10           | C94      | O    | Si   | 1.63            | 5.2            | E94      |
| H    | F    | 0.92            | 10.6           | E94      | O    | P    | 1.66            | 4.7            | E94      |
| H    | Si   | 1.48            | 2.3            | E94      | O    | S    | 1.470           | 9.90           | C94      |
| H    | P    | 1.415           | 2.95           | C94      | O    | Cl   | 1.70            | 4.1            | E94      |
| H    | S    | 1.326           | 4.30           | C94      | O    | Br   | 1.85            | 3.4            | E94      |
| H    | Cl   | 1.28            | 4.3            | E94      | O    | I    | 2.05            | 1.6            | E94      |
| H    | Br   | 1.41            | 4.2            | E94      | F    | Si   | 1.57            | 6.4            | E94      |
| H    | I    | 1.60            | 2.7            | E94      | F    | P    | 1.54            | 7.1            | E94      |
| C    | C    | 1.512           | 3.80           | C94      | F    | S    | 1.55            | 6.9            | E94      |
| C    | N    | 1.439           | 4.55           | C94      | Si   | Si   | 2.32            | 1.3            | E94      |
| C    | O    | 1.393           | 5.40           | C94      | Si   | P    | 2.25            | 1.5            | E94      |
| C    | F    | 1.353           | 6.20           | C94      | Si   | S    | 2.15            | 2.0            | E94      |
| C    | Si   | 1.86            | 2.6            | E94      | Si   | Cl   | 2.02            | 3.1            | E94      |
| C    | P    | 1.84            | 2.7            | E94      | Si   | Br   | 2.19            | 2.1            | E94      |
| C    | S    | 1.812           | 2.80           | C94      | Si   | I    | 2.44            | 1.5            | E94      |
| C    | Cl   | 1.781           | 2.75           | C94      | P    | P    | 2.21            | 1.7            | E94      |
| C    | Br   | 1.94            | 2.60           | E94      | P    | S    | 2.10            | 2.4            | E94      |
| C    | I    | 2.16            | 1.4            | E94      | P    | Cl   | 2.03            | 3.0            | E94      |
| N    | N    | 1.283           | 6.00           | C94      | P    | Br   | 2.21            | 2.0            | E94      |
| N    | O    | 1.333           | 5.90           | C94      | P    | I    | 2.47            | 1.4            | E94      |
| N    | F    | 1.36            | 5.9            | E94      | S    | S    | 2.052           | 2.50           | C94      |
| N    | Si   | 1.74            | 3.7            | E94      | S    | Cl   | 2.04            | 2.9            | E94      |
| N    | P    | 1.65            | 4.8            | E94      | S    | Br   | 2.24            | 1.9            | E94      |
| N    | S    | 1.674           | 3.50           | C94      | S    | I    | 2.40            | 1.7            | E94      |
| N    | Cl   | 1.75            | 3.5            | E94      | Cl   | Cl   | 1.99            | 3.5            | E94      |
| N    | Br   | 1.90            | 2.9            | E94      | Br   | Br   | 2.28            | 2.4            | E94      |
| N    | I    | 2.10            | 1.6            | E94      | I    | I    | 2.67            | 1.6            | E94      |

$^a$ 参考键长 (Å)。

$^b$ 参考力常数 (md/Å)。

$^c$ 标签“C94”表示针对核心 MMFF94 力常数校准的参数；“E94”表示根据 Badger 规则计算的参数（见正文）。

---

### 角弯曲参数化的扩展

#### 额外参考键角的参数化

此参数化也分两个阶段进行。在第一阶段，通过拟合先前引用的 MP2/6-31G$^*$ 数据获得了优化的参考键角 $\vartheta_{ijk}^0$。在此拟合中，$\vartheta_{ijk}^0$ 的初始值设置为优化的 MP2/6-31G$^*$ 键角的平均值；角弯曲力常数 $ka_{ijk}$ 在每个迭代周期中根据后文描述的经验规则计算。然后，将在核心 MMFF94 参数化中未遇到的角类型的导出参数添加到核心“C94”集中。这些额外的基于 MP2/6-31G$^*$ 的参数在分发集[^15]中标记为“X94”。

在第二阶段，对于既未在核心参数化中也未在刚刚描述的 MP2/6-31G$^*$ 数据拟合中确定的参考键角，其初始值设置为观察到的 CSD 键角的平均值。同样，使用了经验规则力常数，并在每个迭代周期后更新。如同在先前的工作中一样[^3]，小环中“不合规”的参考键角会定期重置为其初始值。此外，在每次迭代后重新施加“C94”和“X94”参考键角，以确保最终参数在保持与从头算导出参数一致的同时，尽可能好地拟合 CSD 数据。在少数情况下，观察到个别参数与其起始值有相当大的漂移，但没有显著影响力场优化的几何结构。在最后两个迭代周期（均未使用“收敛加速”[^3]）之前，这些参数被重置为我们判断为物理上合理的值。在“有效收敛”之后（以对 CSD 数据的拟合缺乏显著进一步改善为标志），大多数新导出的参数被添加到参数集中；这些参数通过标签“E94”进行标识[^15]。然而，由于氢原子在 X 射线数据中的位置往往不准确，所有涉及氢的导出参数都首先经过仔细检查。最终，我们在 186 个案例中的 128 个案例中保留了相关的 CSD 导出参考键角。在大多数这些案例中，CSD 数据为给定的角类型提供了 20 次或更多的测定，并且在实验测量的键角中显示出相对较小的变化。其余 58 个涉及氢原子的案例的参考键角是通过类比在相关但定义更好的键角中发现的值和趋势来分配的——此类参数通过标签“#94”进行标识。

#### 参考键角的默认值和经验规则值

每当在参数表中找不到给定 i-j-k 相互作用的特定、完全合格的参数时，MMFF94 会调用一个相当精细的协议，该协议涉及一系列原子类型等价性[^1]。通常，此过程将找到一个特定参数或一个通配符“0-J-0”参数，其中外围原子 i 和 k 的原子类型 I 和 K 已相继等价为“0”，该符号匹配任何起始原子类型。在 MMFF94 中，角弯曲参数进一步由一个表示角类型索引 $AT_{ijk}$ 的索引 M 限定[^3]。参数文件[^15]中包含一套广泛的 M:0-J-0 默认参数，这些参数是通过对所有可用的“C94”、“X94”和“E94” M:I-J-K 参考键角在 I 和 K 上取平均而生成的。

当甚至连 M:0-J-0 默认值都不可用时，会调用一个简单的经验程序来提供一个合理的参考键角。此程序为 $\vartheta_{ijk}^0$ 分配一个 120° 的初始值，但如果 $\text{crd}(J) = 4$，则替换为四面体值 109.45°。对于 $\text{crd}(J) = 2$，如果中心原子是氧，则 $\vartheta_{ijk}^0$ 设置为 105°；如果中心原子的原子序数大于 10，则设置为 95°；或者如果中心原子被归类为线性[在表 I 中由 lin($J$) = 1 表示]，则设置为 180°。然而，如果 $\text{crd}(J) = 3$，val($J$) = 3，且 mltb($J$) = 0（因此 j 是一个三配位原子，预计不会因强共振相互作用而变得接近平面），那么如果 j 是氮，则 $\vartheta_{ijk}^0$ 设置为 107°，否则设置为 92°。最后，如果角 i-j-k 出现在三成员环中，则 $\vartheta_{ijk}^0$ 设置为 60°；如果出现在四成员环中，则设置为 90°。

#### 角弯曲力常数的经验规则

当使用 M:0-J-0 默认值或上述过程来分配 $\theta_{IK}^0$ 时，必须随后调用一个进一步的程序来分配相关的角弯曲力常数。在 MMFF94 中，力常数（单位为 md A/rad$^2$）根据先前发布的规则获得[^9]：

$$
ka_{IK} = \beta Z_i C_j Z_k (r_{ij}^0 + r_{ik}^0)^{-1} \theta_{IK}^0 - 2 \exp(-2D)
$$
其中 $Z$ 和 $C$ 是仅依赖于原子序数的原子参数，而 $D = (r_{ij}^0 - r_{ik}^0)^2 / (r_{ij}^0 + r_{ik}^0)^2$ 是一个衡量 i–j 和 j–k 键长相对差异性的量。比例因子 $\beta$ 通常取为 1.75，如果 i、j 和 k 是四成员环的成员，则降低到此值的 85%，如果这些原子形成三成员环，则降低到此值的 5%（在后一种情况下，三个角弯曲和三个键拉伸相互作用是冗余的；因此，严格来说不需要角弯曲力常数）。原子参数 $Z$ 和 $C$ 列于表 VI 中；它们与先前发布的值略有不同[^9]，因为当前值已针对原始工作中使用的数据进行了全面优化。

---

### 拉伸-弯曲相互作用参数化的扩展

MMFF94 中使用的拉伸-弯曲项的形式在式 (5) 中给出。MMFF94 中明确提供的唯一拉伸-弯曲参数是那些源自从头算 HF/6-31G$^*$ 二阶导数的参数，这些参数几乎全部在其核心参数化中获得[^3]。当此类参数不可用时，默认值取自表 VII。这些值取决于组成原子 i、j 和 k 在周期表中所属的行；它们代表了在二阶导数参数化中涵盖的行组合的显式导出 MMFF94 拉伸-弯曲参数的平均值，或者对于新的行组合，反映了在参数化力常数中观察到的趋势。

---

### 三角中心面外弯曲参数化的扩展

对于面外弯曲 [式 (6)]，对核心参数化中未定义的力常数的请求通过一个与角弯曲类似的连续等价性协议[^1]来处理。对特定参数 $koop_{IK:L}$ 的未满足请求以找到一个通配符参数“0–J–0:0”而终止，该参数仅依赖于中心原子 j 的原子类型 J。对于核心 MMFF94 涵盖的原子类型，这些通配符参数是通过对所有特定参数化的 I–J–K:L 力常数在 I、K 和 L 上取平均而生成的。对于新遇到的原子类型（即 17、26、43、45、58、67、73 和 82），通过结构类比为核心 MMFF94 原子类型导出的值来分配通配符默认值。

---

### 扭转相互作用参数化的扩展

#### 显式参数化

对于此扩展，我们使用了基于 MP2/6-31G$^*$ 优化几何结构下的 MP2/6-31G$^*$ 能量的构象能 (CE) 比较以及基于 MP2/6-31G$^*$ 能量的“扭转剖面” (TP) 比较，这些能量是针对如前所述[^4]生成的扭转增量结构进行的。CE 比较基于表 II、IV 和 VIII 中列出的 40 个结构，涉及化合物系列 PO01、PO05、SO01、SO02、SO03、SO04、SO05、SO07、SO08 和 SO09。这些结构产生了 30 个相对能量比较。TP 比较涵盖了前述以及以下化合物系列：AN09、AN12、NO01、NO02、NO03、NO04、NX02、NX03、OC02、PO03、PO04、PO06、PO07、PO08、PO09、PR02、PR03、PR04、PS01、SI02、SI03、SI04、SO10、SO11、SO12、SO13、SO14、SO15、SO16、SO17、SO18 和 SO19。一组 493 个扭转增量结构被生成，产生了 440 个相对构象能的比较。这些化合物包括各种烷基、酰基和芳基磺酰胺以及各种含氧磷化合物，我们认为对于 MMFF94 未来的药物和生物有机应用，这些体系尤其需要高质量的构象能。

表 VII. 用于式 (5) 的 MMFF94 默认拉伸-弯曲参数。

| 周期表中的行 | $JR$ | $KR$ | $kDa_{U/K}^a$ | $kDa_{K/J}^a$ |
| ------------ | ---- | ---- | ------------- | ------------- |
| 0            | 1    | 0    | 0.15          | 0.15          |
| 0            | 1    | 1    | 0.10          | 0.30          |
| 0            | 1    | 2    | 0.05          | 0.35          |
| 0            | 1    | 3    | 0.05          | 0.35          |
| 0            | 1    | 4    | 0.05          | 0.35          |
| 0            | 2    | 0    | 0.00          | 0.00          |
| 0            | 2    | 1    | 0.00          | 0.15          |
| 0            | 2    | 2    | 0.00          | 0.15          |
| 0            | 2    | 3    | 0.00          | 0.15          |
| 0            | 2    | 4    | 0.00          | 0.15          |
| 1            | 1    | 1    | 0.30          | 0.30          |
| 1            | 1    | 2    | 0.30          | 0.50          |
| 1            | 1    | 3    | 0.30          | 0.50          |
| 1            | 1    | 4    | 0.30          | 0.50          |
| 2            | 1    | 2    | 0.50          | 0.50          |
| 2            | 1    | 3    | 0.50          | 0.50          |
| 2            | 1    | 4    | 0.50          | 0.50          |
| 3            | 1    | 3    | 0.50          | 0.50          |
| 3            | 1    | 4    | 0.50          | 0.50          |
| 4            | 1    | 4    | 0.50          | 0.50          |
| 1            | 2    | 1    | 0.30          | 0.30          |
| 1            | 2    | 2    | 0.25          | 0.25          |
| 1            | 2    | 3    | 0.25          | 0.25          |
| 1            | 2    | 4    | 0.25          | 0.25          |
| 2            | 2    | 2    | 0.25          | 0.25          |
| 2            | 2    | 3    | 0.25          | 0.25          |
| 2            | 2    | 4    | 0.25          | 0.25          |
| 3            | 2    | 3    | 0.25          | 0.25          |
| 3            | 2    | 4    | 0.25          | 0.25          |
| 4            | 2    | 4    | 0.25          | 0.25          |

$^a$索引 $IR$、$JR$ 和 $KR$ 代表原子类型 I、J 和 K 对应的周期表中的行（氢所在的行表示为“O”）（单位：md Å/rad$^2$）。

如同在 MMFF94 的核心参数化中一样，拟合过程使用了程序 TORFIT。[^4] 发现构象能依赖于 98 组先前未参数化的 $V_n$ 扭转参数 ($n = 1, 2, 3$) 以及 20 组先前参数化的集合。后者被包含在扭转拟合中，但固定在其核心 MMFF94 值上。前者被赋予了根据后文描述的经验规则确定的初始值。拟合本身是迭代进行的，如先前所述。[^4] 在 98 组优化的一重、二重和三重扭转参数中，最终有 102 个单独分量被固定为零值，而 C=C 双键和芳香环中键的 8 个 $V_2$ 分量被固定为与非零值，这些值被选择为与核心 MMFF94 值一致。总共确定了 180 个非零 $V_n$ 分量。

表 VIII. 用于扩展扭转相互作用参数化的额外分子。

| 构象索引$^a$ | 结构                                                         |
| ------------ | ------------------------------------------------------------ |
| SO01j        | 苯基—NHSO$_2$—苯基, $\text{cnsc}$ = 180°                     |
| SO01k        | 苯基—NHSO$_2$—苯基, $\text{cnsc}$ 邻位交叉, $\text{nscc}$ = 0° |
| SO02j        | 苯基—NHSO$_2$—甲基, $\text{cnsc}$ = 180°                     |
| SO02k        | 苯基—NHSO$_2$—甲基, $\text{sncc}$ = 0°                       |
| SO02s        | 苯基—NHSO$_2$—甲基, $\text{cnsc}$ 邻位交叉, $n$ 平面         |
| SO02t        | 苯基—NHSO$_2$—甲基, $\text{hncc}$ 顺式, $n$ 平面             |
| SO02u        | 苯基—NHSO$_2$—甲基, $\text{cnsc}$ 斜扭, $\text{hncc}$ 邻位交叉, $n$ 平面 |
| SO04j        | 吡咯—SO$_2$—苯基, $\text{cnsc}$ = 0°                         |
| SO04k        | 吡咯—SO$_2$—苯基, $\text{nscc}$ = 0°                         |
| SO05s        | 甲基—NHSO$_2$—甲基, $\text{cnsc}$ 邻位交叉, $\text{hnso}$ 反式, $n$ 平面 |
| SO05t        | 甲基—NHSO$_2$—甲基, $\text{cnsc}$ 邻位交叉, $\text{hnso}$ 顺式, $n$ 平面 |
| SO07j        | 苯基—C(=O)—NHSO$_2$—甲基, $\text{csnc}$ = 0°                 |
| SO07t        | 苯基—C(=O)—NHSO$_2$—甲基, $\text{ocnh}$ 顺式, $\text{csnc}$ 斜扭, $n$ 平面 |
| SO08t        | 甲基—C(=O)—NHSO$_2$—甲基, $\text{csnc}$ 邻位交叉, $n$ 平面   |
| SO08t        | 甲基—C(=O)—NHSO$_2$—甲基, $o$ = $\text{cnh}$ 顺式, $n$ 平面  |
| SO09t        | 甲磺酰胺, $n$ 平面                                           |
| SO12a        | 硫酸                                                         |

$^a$见表 I 的脚注 a。在一些构象描述中使用了缩写："c" 表示顺式，"sk" 表示斜扭，"g" 表示邻位交叉，"a" 表示反式。

最终参数在分发参数集[^15]中通过标签“X94”进行标识。这些参数重现了 29 个 CE（表 IX）和 440 个 TP 构象比较，其均方根偏差分别为 0.57 和 0.73 kcal/mol，而均方根值分别为 2.53 和 4.90 kcal/mol。这些均方根偏差高于在 MMFF94 核心参数化[^1,4]中发现的 CE 和 TP 比较的 0.31 和 0.50 kcal/mol，可能是因为当前的比较包含更高比例具有两个或更多个高极性键紧密靠近的体系。发现此类体系的描述准确性较差[^4]，也许是因为 MMFF94 与所有其他用于通用分子建模的当代力场一样，过于简化了静电相互作用的处理。尽管如此，除了少数几个 MMFF94 优化未能保持起始 MP2/6-31G$^*$ 构象的情况外，构象能的描述相当好。作为拟合质量的一般衡量标准，我们注意到 29 个 CE 比较中没有一个的相对构象能符号错误，并且 440 个 TP 比较中除 9 个外都具有正确的符号。在后九个中，只有两个涉及 0.4 kcal/mol 或更大的构象能误差，并且没有一个误差超过 1 kcal/mol。

最严重的定性失败发生在构象异构体 SO07b 上，其中氮原子显著变平，并且 N-S 键在 MMFF94 优化过程中旋转了 $\sim 120^\circ$。这种情况没有反映在引用的均方根偏差中，但会使其显著增加，因为 SO07b 塌陷到的 SO07a 结构在 MP2/6-31G$^*$ 势能面上低 7 kcal/mol。第二个定性失败——一个反映在引用的均方根偏差中的失败——是因为构象异构体 SO03c 在 MMFF94 能量面上不适当地优化到了 SO03b 的几何结构。第三个失败发生在 SO02b 和 SO02c 以及它们的 N-平面类似物 SO02s 和 SO02t 上。对于 SO02b 和 SO02c，两个 MP2/6-13G$^*$ 构象异构体在 MP2/6-31G$^*$ 势能面上仅相差 0.3 kcal/mol，并且可以通过绕 C(环)—N 键旋转 41° 和绕 N-S 键旋转 24° 相互转换。通常，在构象空间中不会发现两个平衡结构如此接近。然而，两者都是 MP2/6-31G$^*$ 势能面上的极小值，这一点由中间结构重新优化到其中之一或另一个的事实证明。相比之下，MMFF94 优化从任一初始点都产生一个共同的（中间）结构。

扭转几何结构描述得相当好。当排除构象异构体 SO03c 和 SO07b 时，发现 MMFF94 几何结构对于 61 个平衡构象中的 1156 个扭转角的均方根偏差为 6.53°。这些构象异构体由表 II、IV和 VIII 中那些构象索引[^1]的第五个字符为“a”、“b”、“c”或“d”并且足够大以拥有扭转角的结构组成。该均方根偏差仅比在 MMFF94 核心参数化[^4]中发现的偏差略高。

几年前，我们使用 STO-3G$^*$ 数据为 MMFF 的前身力场 MM2X 对一组类似的磺酰胺进行了参数化。当用本工作中使用的更高质量的 MP2/6-31G$^*$ 数据评估时，发现 MM2X 的性能远不如 MMFF94 准确。对于基于 SO 系列构象异构体的 26 个 CE 比较[^20]，它给出的均方根偏差为 1.23 kcal/mol，大约是 MMFF94 对同一组比较的均方根偏差 0.60 kcal/mol 的两倍。然而，MM2X 描述扭转几何结构的能力与 MMFF94 大致相当。

#### 通配符默认参数的生成与使用

对于无法使用主要数值 MMFF 原子类型和相关扭转类型索引[^4] TT$_{IIKL}$ 解决的一重、二重和三重扭转参数的请求，首先通过第一部分[^1]概述的“递降”等价性程序处理。最终，对 i-j-k-l 扭转角的 $V_1$、$V_2$ 和 $V_3$ 扭转参数的连续等价请求可能会检索到一个完全通配的 M:0-J-K-0 参数（其中 M 表示扭转类型索引 TT$_{IIKL}$），或者，在少数情况下，可能会访问一个“半通配”的 M:0-J-K-L 或 M:I-J-K-0 参数。如果连一个通配符参数都不可用，则调用下一小节描述的经验规则。

参数文件中提供的通配符参数通过两种方式之一生成。对于“C94”（核心 MMFF94）或“X94”参数化中涵盖的 J-K 键类型，通配符参数 M:0-J-K-0、M:0-J-K-L 或 M:I-J-K-0 是通过分别对显式确定的 M:I-J-K-L 参数在 I 和 L 上、在 I 上或在 L 上取平均而生成的。相比之下，对于在扩展 CSD 参数化中遇到的额外扭转相互作用，通配符 M:0-J-K-0 参数是根据下一小节描述的经验规则生成的，并被放入分发参数文件[^15]中，通过标签“E94”或“#E94”进行标识[^31]。这些参数仅依赖于扭转类型和中心两个原子的原子类型。

#### 扭转参数的经验规则

MMFF94 中使用的经验规则是仿照 Mayo 等人在其 DREIDING 力场[^32]和 Rappé 及其同事在 UFF 中使用的规则制定的[^33]。在 MMFF94 中，经验规则例程执行以下逐步协议，并在满足规定条件时终止。

(a) 如果 i-j-k-l 扭转角中的中心原子 j 和 k 任一个被指定为线性的 [即，如果表 I 中 $\lim(j)=1$ 或 $\lim(k)=1$]，则分配零扭转参数。

(b) 如果原子类型 J 和 K 是芳香族的，并且键 j-k 位于芳香环内，则分配一个二重势。独立于扭转类型索引 M 的值，V$_2$(M:IIKL)（以千卡每摩尔为单位）由下式给出：
$$
V_2 = \beta \pi_{jk}(U_J U_K)^{1/2} \tag{21}
$$
其中 $\pi_{jk}$ 与 j-k π 键级相关，$U_j$ 和 $U_k$ 是依赖于原子种类的参数（参见表 X）。如果 j 和 k 都不向 π 体系贡献 π 孤对电子 [即，如果表 I 中列出的 $\text{pip}(J)$ 和 $\text{pip}(K)$ 都是“0”]，则“π 键级” $\pi_{jk}$ 分配为 0.5，否则分配为 0.3。比例因子 $\beta$ 在大多数情况下取为 6，但如果两个中心原子一个是三价的，另一个是四价的（根据相关的 val(J) 和 val(K) 值确定），则取为 3。

(c) 当 j-k 键的形式键级为 2 时，使用式 (21)，其中 $\beta=6$ 且 $\pi_{jk}=1$，前提是 $\text{mlt}(J)=2$ 且 $\text{mlt}(K)=2$（意味着完全双键）。否则，$\pi_{jk}$ 取为 0.4。后者的一个例子将是胍阳离子的共振结构中，MMFF 数值类型 57 的碳和类型 55 的氮之间的形式双键，其中 mltb(57) = 2 但 mltb(55) = 1。$\pi_{jk}$ 的较小值认识到 j-k 并非在所有共振结构中都是双键。

表 X. 用于扭转相互作用的 MMFF94 经验规则参数。

| 原子 | $U^a$ | $V^b$ | 原子 | $U^a$ | $V^b$ |
| ---- | ----- | ----- | ---- | ----- | ----- |
| C    | 2.0   | 2.12  | Si   | 1.25  | 1.22  |
| N    | 2.0   | 1.5   | P    | 1.25  | 2.40  |
| O    | 2.0   | 0.2   | S    | 1.25  | 0.49  |

$^a$ 用于式 (21)。

$^b$ 用于式 (22)。

(d) 当 j 和 k 都是四配位时 [即，crd(j) = 4 且 crd(K) = 4]，分配一个三重势。$V_3(M:IJKL)$ 由下式给出：

$$
V_3 = (V_J V_K)^{1/2}/N_{JK}
$$
其中 $V_j$ 和 $V_k$ 依赖于 j 和 k 的原子种类（参见表 X），而 $N_{jk}$，即关于 j-k 键的扭转相互作用的数量，计算为 crd(j) - 1 和 crd(K) - 1 的乘积。

(e) 当原子 j 是四配位但 k 不是时，会出现几种情况：(1) 如果 k 是三配位但是四价的或者是强离域的 [严格地说，如果 crd(K) 是“3”并且 (i) 如果 val(K) 是“4”或“34”或者 (ii) 如果 mltb(K) 非零]，则返回零扭转参数，因为此扭转键代表一个 sp$^3$-sp$^2$ 转子。(2) 如果 k 是二配位但是三价的 [即，如果 crd(K) = 2 并且如果 val(K) = 3 或 mltb(K) ≠ 0]，也返回零扭转参数。(3) 在所有其他情况下，使用式 (22)，并且 j-k 被视为饱和键。

(f) 当原子 k 是四配位但 j 不是时，适用前一段的规定，但索引互换。

(g) 其余情况涉及中心原子 j 和 k，它们最多是三配位的。当形式 j-k 键级为 1 但 mltb(j) 和 mltb(K) 都非零，或者当 mltb(j) 和 pjlp(K) 都非零，或者当 pjlp(j) 和 mltb(K) 都非零时，在大多数情况下 j-k 被识别为共振相互作用。出现几种情况：(1) 如果两个原子都被归类为具有 π 孤对电子 [pjlp(j) = 1 且 pjlp(K) = 1]，则认为该相互作用不是共振的，并分配零扭转参数。(2) 如果 j 有 π 孤对电子并且 k 可以形成多重键 [即，如果 pjlp(j) 和 mltb(K) 都非零]，则使用式 (21)，其中 $\beta = 6$。如果 j 也能形成强离域的“单”键 [即，如果 mltb(j) = 1]，例如 MMFF 原子类型 10 的酰胺氮]，则分配“π 键级” $\pi_{jk}$ 为 0.5。否则，如果 j 和 k 属于碳所在的行，则分配 $\pi_{jk} = 0.3$，如果 j 或 k 不属于碳所在的行，则分配 $\pi_{jk} = 0.15$。(3) 类似地，如果 k 有 π 孤对电子并且 j 可以形成多重键，则情况 (2) 适用，但索引互换。(4) 如果 j 或 k 可以形成强离域的“单”键 [即，如果 mltb(j) = 1 或 mltb(K) = 1] 并且如果 j 或 k 不是碳，则使用式 (21)，其中 $\beta = 6$ 且 $\pi_{jk} = 0.4$。这个相对较大的 π 键级认识到 j-k 键可能是一个离域的部分双键，共振键级为 1/2 或 1/3，例如胍阳离子共振结构中的 C-N “单键”[注意上面的规则 (c) 确保同一共振结构中的 C=N “双键”以相同方式处理]。(5) 最后，在所有其他情况下，j-k 被视为多重键之间“正常的”、但弱的相互作用（例如丁二烯或联苯中的中心 C-C 键）。然后使用式 (21)，其中 $\beta = 6$ 且 $\pi_{jk} = 0.15$。

(h) 最后，如果前面的条件都不适用，则 j 和 k 必须都是饱和中心，最多为三配位。在大多数此类情况下，例如，使用式 (22) 和表 X 中列出的 $V_x$ 参数。但是，如果 j 和 k 都是氧或硫，每个原子有两个孤对电子，相互作用具有特殊性质。当 j（或 k）是氧时，$W_j$（或 $W_k$）设置为 2.0，但当 j（或 k）是硫时，$W_J$（或 $W_K$）设置为 8.0。然后分配一个二重势 $V_2(IJKL)$ 为：

$$
V_2 = -(W_J W_K)^{1/2}
$$
为了将前述经验规则的表述置于上下文中，我们注意到我们遵循了 Rappé 等人[^33]的做法，允许式 (21) 和 (22) 中的 $U_x$ 和 $V_x$ 参数依赖于原子种类；Mayo 等人在 DREIDING 中抑制了这种依赖性[^32]。我们在两个基本方面与 Rappé 等人不同。首先，对于芳香和共振相互作用，我们在分配二重扭转常数值时做了更精细的区分。这些区分反映了在显式确定的“C94”和“X94”参数中发现的模式。其次，我们选择了特定的函数形式以及具体的 $\beta$、$\pi_{jk}$、$U_x$、$U_y$ 和$W_x$ 参数，通过将所得的 M:0—J-K=0 参数拟合到从显式确定参数获得的平均默认值。

在需要时，本小节和前一小节概述的复合程序提供了合理的默认或经验规则参数。然而，应该记住，许多应用将不需要此类默认级别的参数，因为显式的“C94”和“X94”参数化涵盖了广泛的化学结构范围。

### 范德华相互作用参数化的扩展

MMFF94 既不使用默认参数也不使用经验规则来生成“缺失的”范德华 (vdW) 参数。CSD 参数化中引入的额外原子类型所需的原子极化率 $\alpha_i$ 是通过保留早先发布的初步值[^8]或通过类比“C94”（核心 MMFF94）中类似化学物种的参数生成的。MMFF 原子类型 13、14、17–19、25、26、42、43、45–48、51、53、60–62、67、72–79 和 82 以此方式进行了参数化。通过类比选择的参数在分发参数文件[^15]中通过标签“X94”进行标识。

MMFF94（但不是 MMFF93$^3$4）还包括“蛋白质金属”的 vdW 参数，例如 Zn$^{2+}$、Ca$^{2+}$、Cu$^{2+}$、Cu$^{+}$，以及高自旋 Fe$^{2+}$ 和 Fe$^{3+}$，还有 F$^{-}$、Cl$^{-}$、Br$^{-}$、OH$^{-}$、Li$^{+}$、Na$^{+}$、Mg$^{2+}$ 和 H$_2$O$^{+}$。[^15] 此参数化涉及原子类型 35、49 和 87–99。比例参数 A$_1$ 和 G$_1$ 以及有效电子数 N$_i$ 是通过类比其他情况分配的，但极化率 $\alpha_i$（通过式 (9) 决定 vdW 半径）是显式参数化的。Zn$^{2+}$ 的极化率是通过考虑与 thermolysin 结合的若干配体的配位几何结构获得的，这些配体的晶体结构来自布鲁克海文国家实验室的蛋白质数据库。[^24] 然后，通过适当调整单电荷离子的单水合物和三水合物（表 XI）以及多电荷离子的三水合物和六水合物（表 XII）的 MMFF 能量和结构，获得了其余离子的参数。对于大多数单电荷离子，计算出的结合能可以与气相中实验测定的结合焓进行比较。[^35] 除 OH$^{-}$ 和 H$_2$O$^{+}$ 外，计算出的原子间距离也可以与指定的离子半径进行比较，这些离子半径取自 Pauling[^36] 或 Day 和 Selbin。[^37] 我们还将 Li$^{+}$、Na$^{+}$、F$^{-}$ 和 Cl$^{-}$ 的单水合物的 MMFF 结果与 Jorgensen 及其同事报告的 TIP4P 能量和几何结构进行了比较。[^38] 对于每种离子物种，我们调整了相关的极化率 $\alpha_i$，以使距离 R$_X-O$ 与“X”的离子半径以一致的方式相关联（见表 XI 和 XII），并且在有数据的情况下，使水合物的结合能大致与实验一致。这些参数也标记为“X94”。[^15]

从表 XI 和 XII 可以看出，R$_X-O$ 距离通常随着水合程度从较低到较高而延长 0.05 到 0.1 Å，这大致符合预期。对于三水合物，MMFF94 的距离通常超过所列离子半径约 1.40–1.45 Å（对于负离子）和约 1.30 Å（对于正离子），尽管计算出的 F$^{-}$ 和 Mg$^{2+}$（它们各自电荷类型中最小的离子）的 R$_X-O$ 距离比根据这些关系预期的短约 0.05 Å。计算出的 $R_{X-0}$ 距离因此看起来是合理的。

表 XI.  单电荷离子水合物的 MMFF94 结果。

|            |                | $X(\text{H}_2\text{O})$ | $X(\text{H}_2\text{O})$ | $X(\text{H}_2\text{O})_3^{a}$ | $X(\text{H}_2\text{O})_3^{a}$ |
| ---------- | -------------- | ----------------------- | ----------------------- | ----------------------------- | ----------------------------- |
| $X$        | 离子半径$^{b}$ | $R_{X-O}^{a}$           | $\Delta E^{d}$          | $R_{X-O}^{a}$                 | $\Delta E^{d}$                |
| F$^-$      | 1.36           | 2.65                    | -20.4                   | 2.72$^{e}$                    | -56.8                         |
| Cl$^-$     | 1.81           | 3.18                    | -14.3                   | 3.25$^{f}$                    | -40.9                         |
| Br$^-$     | 1.95           | 3.33                    | -13.1                   | 3.41$^{g}$                    | -37.8                         |
| OH$^-$     | —              | 2.64                    | -21.7                   | 2.72$^{h}$                    | -60.8                         |
| Li$^+$     | 0.60           | 1.83                    | -32.4                   | 1.90                          | -85.0                         |
| Na$^+$     | 0.95           | 2.21                    | -24.1                   | 2.26                          | -65.4                         |
| K$^+$      | 1.33           | 2.61                    | -18.3                   | 2.66                          | -50.4                         |
| H$_2$O$^+$ | —              | 2.49                    | -28.3                   | 2.52$^{h}$                    | -78.5                         |
| NH$_4$$^+$ | —              | 2.59                    | -22.5                   | 2.62$^{h}$                    | -62.3                         |
| Cu$^+$     | 0.96           | 2.23                    | -23.9                   | 2.28                          | -64.9                         |

$^a$ $D_3$ 对称性，除非另有说明。

$^b$ 来自 Pauling (参考文献 36)。

$^c$ 到水分子氧的距离 (Å)；在水合氢离子和铵水合物中，分别来自 O 和 N 原子。

$^d$ 相互作用能 (kcal/mol)；计算为相对于无限分离水合物物种的能量。

$^e$ 不对称；F$\cdots$ O 距离为 2.67、2.70 和 2.78 Å。

$^f$ 不对称；Cl$\cdots$ O 距离为 3.14、3.22 和 3.39 Å。

$^g$ 不对称；Br$\cdots$ O 距离为 3.28、3.36 和 3.58 Å。

$^h$ $C_3$ 对称性。

表 XII. 多电荷离子水合物的 MMFF94 结果。

|           |              | $X(\text{H}_2\text{O})_3^a$ | $X(\text{H}_2\text{O})_3^a$ | $X(\text{H}_2\text{O})_6^b$ | $X(\text{H}_2\text{O})_6^b$ |
| --------- | ------------ | --------------------------- | --------------------------- | --------------------------- | --------------------------- |
| $X$       | 离子半径$^o$ | $R_{X-0}$                   | $\Delta E^e$                | $R_{X-0}$                   | $\Delta E^e$                |
| Mg$^{2+}$ | 0.65         | 1.90                        | -177.3                      | 2.08                        | -288.1                      |
| Ca$^{2+}$ | 0.99         | 2.30                        | -129.3                      | 2.40                        | -225.6                      |
| Cu$^{2+}$ | 0.72$^i$     | 2.02                        | -162.2                      | 2.16                        | -271.2                      |
| Fe$^{2+}$ | 0.76         | 2.06                        | -156.8                      | 2.19                        | -264.5                      |
| Fe$^{3+}$ | 0.64         | 1.94                        | -262.8                      | 2.06                        | -456.0                      |
| Zn$^{2+}$ | 0.74         | 2.04                        | -158.9                      | 2.18                        | -267.1                      |

$^a$ $D_3$ 对称性。

$^b$ $O_h$ 对称性。

$^c$ 来自 Pauling (参考文献 36)。

$^d$ 到水分子氧的距离 ($\overset{\circ}{\text{A}}$)。

$^e$ 相互作用能 (kcal/mol)；计算为相对于无限分离水合物物种的能量。

$^f$ 来自参考文献 37。

Kebarle[^35] 报道了除 Cu$^{+}$ 外所有单电荷离子的实验观察到的气相结合焓。按它们在表 XI 中出现的顺序，Kebarle 的单水合物值分别为 $-23.3$、$-13.1$、$-12.6$、$-25$、$-23$、$-22$、$-19.9$、$-24.4$ 和 $-20$ kcal/mol，三水合物值分别为 $-53.6$、$-37.5$、$-36.4$、$-56.4$、$-81$、$-60$、$-45.9$、$-69$ 和 $-45.3$ kcal/mol。[^35] 比较表明，MMFF94 的值通常更负一些，正如我们假设的完全溶剂化与气相复合物应有的情况。[^39] 在少数情况下出现例外。例如，对于 F$^{-}$，MMFF94 的单水合物能量 $-20.4$ kcal/mol 没有实验值 $-23.3$ kcal/mol 那么负，尽管 MMFF94 的三水合物结合能 $-56.8$ kcal/mol 比实验值 $-53.6$ kcal/mol 更负。由于 MMFF94 旨在用于凝聚相模拟，我们认为匹配三水合物的性质更为重要。第二个例外出现在 NH$_4$$^{+}$ 上，其中 MMFF94 的单水合物和三水合物能量分别为 $-22.5$ 和 $-62.3$ kcal/mol，明显比实验值 $-17.2$ 和 $-45.3$ kcal/mol 更负。我们本可以通过增加季氮（MMFF 原子类型 34）的极化率来减小计算值的大小，从而增加 vdW 半径并延长计算出的 N$^{+}$ ... O 距离。然而，我们选择不这样做，因为所讨论的极化率 ($1.00  \overset{\circ}{\text{A}}^3$) 已经在当前离子物种参数化进行之前完成的 MMFF94 参数化部分中被广泛使用。可能是铵离子水合作用太强，其参数化需要修改。

### 扩展 MMFF94 参数化的性能

在本节中，我们检验扩展力场重现从剑桥结构数据库获得的结构和能量数据的能力。先前已描述了对构象能从头算数据的拟合。

#### 与参数化所用 CSD 数据的拟合

如前所述，参数化数据包括 2861 组 X 射线和中子衍射结构。为了评估 MMFF94 重现这些结构数据的能力，我们比较了这些结构的 MMFF94 优化几何结构和实验几何结构。由于氢原子位置不能通过拟合 X 射线数据可靠地确定，我们只检查了不涉及氢原子的键长和键角。此外，由于晶体堆积因素容易使分子构象变形，我们没有考虑扭转（但请参见下一小节）。由于键角有时显著依赖于分子构象[^40]，我们应用了弱惩罚函数约束以防止扭转角与实验值偏离过大。这些约束对给定扭转角中每平方度的偏差增加了 $1.5 \times 10^{-4}$ kcal/mol 的惩罚。对于绕 C$_{sp}-C_{sp}$ 键的 $15^\circ$ 刚性旋转，它们使能量增加 $\sim 0.3$ kcal/mol，对于 $60^\circ$ 旋转，则增加 $\sim 5$ kcal/mol。然而，在应用这些约束之前，我们首先优化了氢原子位置，以确保没有约束涉及不现实的扭转角。

所得比较对于 40,562 个键长产生的均方根偏差为 $0.023  \overset{\circ}{\text{A}}$，对于 58,087 个键角产生的均方根偏差为 $1.96^\circ$。这些偏差是可观的，尽管在将 MMFF94 与 30 个小分子的实验进行比较时发现了更小的均方根偏差 $0.014  \overset{\circ}{\text{A}}$ 和 $1.2^\circ$[^3]，并且在与 MP2/6-31G$^*$ 优化几何结构的比较中发现了更小的均方根偏差 $0.006  \overset{\circ}{\text{A}}$ 和 $1.16^\circ$[^1]。特别是对于键长，较大的偏差可能部分反映了 MMFF94 无法完全代表 CSD 数据中存在的真实化学变化的情况。例如，对于脂肪族 C—F 键就出现了这样一种情况，其中三氟甲基中的键长约为 1.32 Å，当碳原子是单氟化时，键长急剧上升到 $\sim 1.40  \text{\AA}$。如先前讨论的[^3]，MMFF94 给出了一个中间值，这是有意选择的折衷结果。无疑还存在其他类似情况。

MMFF94 和 CSD 几何结构之间的差异并不一定都代表 MMFF94 模型的缺陷。部分差异可归因于在定义 X 射线键长和键角值时使用了平均原子位置。在这方面，Clark 等人[^41] 断言，如果结构未针对刚体运动进行校正，X 射线键长可能过短 0.005–0.015 Å。与他们的评估一致，我们发现 MMFF94 键长（其中大部分主要由基于 MP2/6-31G$^*$ 的参考值决定）平均超过 CSD 键长 0.010 Å。其次，在重现 CSD 几何结构时遇到的较大表观误差的部分原因可能归因于实验值本身的不确定性。即使在低 R 因子下测定，晶体学结构的质量似乎也存在显著差异。[^41,42]

#### 与先前用于评估分子力场的 CSD 数据的拟合

为了表征 Tripos 5.2 力场，Clark 等人[^41] 几年前从当时版本的 CSD 中提取了前 76 个 R 因子低于 0.05 的结构。最近，Mayo 等人使用相同的结构来基准测试他们的 DREIDING 力场[^32]，而 Momany 和 Rone[^43] 使用了其中的 49 个结构来帮助评估他们用于 CHARMm 的 QUANTA 3.2 参数化。为了测试 MMFF94，我们提取了相同的结构，并按照先前描述的方式进行了准备。有趣的是，在用于扩展 MMFF94 参数化的更大的 2861 个结构集中，只有 5 个结构出现。与其他研究者一样，我们移除了抗衡离子和配位水分子；当两个化学性质相同的分子占据晶胞时，我们任意删除了一个。如同刚刚引用的课题组一样，我们仅报告不涉及氢原子的键、角、扭转和原子位置的偏差，并且在重原子刚性最小二乘叠加后，将 MMFF94 与 CSD 原子位置进行比较。在他们的研究中，Tripos 课题组使用了共轭梯度算法，并将每个结构优化直到所有原子的均方根梯度达到 0.1 kcal/mol·Å。[^41] Mayo 等人采用了相同的收敛标准，但使用了变度量算法。[^44] 相比之下，Momany 和 Rone 采用了强大的 Newton–Raphson 程序，并使用低得多的均方根梯度 $1 \times 10^{-6}$ kcal/mol·Å 作为收敛标准。我们的优化也使用了变度量算法[^1]，但进行到均方根梯度为 $1 \times 10^{-6}$ kcal/mol·Å。因此，MMFF94 结构，如同 Momany 和 Rone 的结构一样，严格代表了驻点（并且几乎可以肯定是能量极小值）。

详细的 MMFF94 结果在表 XIII 中给出，涉及 76 个 CSD 结构中的 75 个；一个结构，CSD 参考代码为“AFMSCY”，是一个锍盐 ($R_3S^+$)，无法用 MMFF 处理。如本研究前文所述，我们一开始就决定不将此类物种包含在扩展参数化中，尽管这样做并不困难。CSD 结构的化学名称可以在 Clark 及其同事的文章中找到[^41]，结构在那里以及 Mayo 等人的文章中有描述[^32]。每个结构中的原子、键、角和扭转的数量与 Mayo 等人列出的相同。

在检查表 XIII 时，我们首先注意到，键长的均方根偏差 0.021 Å 与上一小节中对更大 CSD 结构集发现的偏差几乎相同，键角的均方根偏差 1.97° 也是如此。这些均方根偏差约为 DREIDING 力场报告的 0.035 Å 和 3.224° 的 60%[^32]。因此，参数化更具体的 MMFF94 力场确实更准确地描述了分子几何结构的这些方面。作为比较，Clark 等人报告 Tripos 5.2 力场的键长均方根偏差为 0.025 Å，键角均方根偏差为 2.50°；Momany 和 Rone 没有报告键和角的偏差结果。我们认为 MMFF94 的偏差相当可观，并注意到与 CSD 几何结构的完全一致是不可预期的。

当考虑扭转角和原子位置的偏差时，出现了不同且更复杂的情况。因此，MMFF94 的均方根偏差分别为 16.46° 和 0.474 Å，而 DREIDING 报告的偏差为 8.948° 和 0.235 Å，仅约为一半。类似地，Clark等人报告 Tripos 5.2 力场的扭转角均方根偏差为 9.65°，原子位置均方根偏差为 0.25 Å，再次与 CSD 数据吻合得更好。另一方面，Momany 和 Rone 发现他们的 CHARMm 参数化的原子位置均方根偏差为 0.438 Å，仅比 MMFF94 略好；他们没有报告扭转角。在评估这种表观准确性的差异时，Momany 和 Rone 指出，晶体几何结构通常显示的扭转角与在真空中孤立分子（即力场优化进行的条件）所发现的扭转角存在显著差异。他们进一步指出，Tripos 5.2 和 DREIDING 的研究忽略了静电相互作用，而这恰恰是当结构从晶体晶格的几何限制和/或静电稳定影响中移除时最可能引起构象变化的因素。他们还提出，Clark 等人和 Mayo 等人使用的相对宽松的收敛标准可能产生了部分优化的结构，其中扭转角尚未接近其平衡值。

为了检验他们的假设，Momany 和 Rone 在晶体学环境的背景下重新优化了 14 个最棘手的 CSD 结构。他们发现这 14 个结构的原子位置均方根偏差下降了一半，从 0.802 Å 降至 0.399 Å。此外，当他们忽略静电相互作用并在真空中将结构优化到均方根梯度为 0.1 kcal/mol·Å 时，他们发现同一组结构的均方根偏差仅为 0.376 Å。以类似的方式，我们发现当收敛截断值提高到 0.1 kcal/mol·Å 时，MMFF94 的扭转角均方根偏差从 16.46° 下降到 13.64°，然后当静电相互作用也被抑制时，进一步下降到 10.03°。同时，原子位置的均方根偏差首先从 0.474 Å 下降到 0.424 Å，然后下降到 0.336 Å。虽然这些均方根偏差仍然大于 Tripos 5.2 和 DREIDING 力场报告的偏差，但差异已大大缩小。此外，可以预期，忽略静电相互作用这种简单手段会破坏像 CHARMm 或 MMFF94 这样依赖于静电、扭转和范德华贡献之间精心协调的相互作用的力场的平衡。最后，我们注意到 Mayo 等人也报告了使用基于 Gasteiger 电荷的静电相互作用的比较。这些计算确实显示了更大的原子位置均方根偏差，但只是略微更大。尽管 Gasteiger 电荷比 MMFF94 电荷小得多[^2]，但这最后的观察结果并不那么容易解释。然而，优化到 0.1 kcal/mol·Å 梯度的部分优化效果可能比我们赋予它的权重更重要，因为每当优化未能达到势能面上的驻点时，优化器本身的特性就会发挥作用。在这方面，我们注意到 Momany 和 Rone 使用的 Newton–Raphson 优化器拥有关于能量曲面曲率的完整信息，并立即生成包含复杂（在笛卡尔空间中）扭转运动的搜索方向。相比之下，OPTIMOL/MMFF 中使用的优化器，与 Mayo 等人使用的类似，采用变度量算法。然而，我们相信我们的算法非常高效，它采用块对角估计作为逆 Hessian 矩阵，然后通过 BFGS 方案[^45] 连续更新。与 DREIDING 优化器（据我们了解，它对初始逆 Hessian 使用简单的对角猜测）相比，我们的算法在均方根梯度为 0.1 kcal/mol·Å 时可能产生更接近完全的扭转优化。

诚然，前述内容是推测：我们可以肯定地说，扭转角和原子位置的比较充满困难。我们认为，除非 (i) 实验测量的条件得到适当模拟（例如，通过显式的晶相模拟），并且如果使用几何优化，除非 (ii) 势能面上的极小值被准确定位，否则此类比较几乎没有意义。

### 结论性讨论

本文描述了将 MMFF94 扩展到比第二部分[^2]、第三部分[^3]和第四部分[^4]中介绍的核心参数化所涵盖的更广泛的药物和化学结构。此扩展的一个关键是从剑桥结构数据库中提取并使用了大约 2800 个高质量的晶体学结构。我们还生成了各种小分子和离子的 HF/6-31G$^*$ 优化几何结构，并获得了这些（表 II）以及许多额外结构（表 IV 和 VIII）的 MP2/6-31G$^*$ 优化几何结构。从这些额外计算数据导出的参数使得磺酰胺和某些含氧磷化合物的电荷分布、几何结构和构象能得以在较高水平上描述。对于未来的药物和生物有机应用，这些类型的化合物是 MMFF94 核心参数化未包含的最重要化合物之一。

一系列经过仔细校准的经验规则和默认参数分配在 MMFF94 的扩展中起着至关重要的作用。鉴于静电贡献在模拟分子间相互作用中的重要性，其中的关键是一个用于从“部分键电荷增量”（式 (17)）分配未知键电荷增量的经验规则。这些量实质上反映了 MMFF 原子类型的有效电负性，是通过要求它们尽可能好地重现显式参数化的键电荷增量来确定的。

对于键和角，MMFF94 的扩展被证明是相当直接的。我们通过首先拟合 MP2/6-31G$^*$ 优化结构的几何结构，然后拟合 CSD 结构的几何结构，确定了额外的参考键长和键角。然后我们开发了参考键长 [式 (18)] 和键拉伸力常数 [式 (19)] 的经验规则，并专门校准了每个规则以重现核心 MMFF94 参数。对于参考键角，我们通过对参数化的参考键角取适当的平均值，为每个中心原子类型生成了一个默认角度。然后我们采用了先前发布的一个经验规则[^29] 来获得角弯曲力常数 [参见式(20)]。这个经验规则先前已被校准以重现各种分子中光谱观测到的力常数。
还描述了用于扩展 MMFF94 的拉伸-弯曲相互作用、面外弯曲相互作用、扭转相互作用和范德华相互作用参数化的程序。对于扭转相互作用，我们首先将额外的扭转参数拟合到 MP2/6-31G$^*$ 导出的磺酰胺和含氧磷化合物等的构象能。为了进一步扩展参数化，我们首先通过对显式拟合从头算构象能获得的扭转参数进行适当平均，生成了仅依赖于两个中心原子的原子类型（以及“扭转类型”索引）的默认值。然后我们制定了一个用于生成额外默认（“通配符”）参数的经验规则。该规则仿照先前为 DREIDING[^32] 和 UFF[^33] 力场设计的规则，但不同之处在于它使用了略有不同的函数形式，做了更精细的上下文相关区分，并且通过要求生成的扭转参数紧密重现显式参数化中获得的参数，专门为 MMFF94 进行了校准。

范德华参数化的扩展还包括了容纳离子物种所需的额外原子类型，例如“蛋白质”金属 Zn$^{2+}$、Ca$^{2+}$、Cu$^{2+}$、Cu$^{+}$、Fe$^{2+}$ 和 Fe$^{3+}$；水合氢离子和氢氧根离子；以及各种卤化物、碱金属和碱土金属离子。仅进行了初步的参数化，但 MMFF94 对水合物的结果（表 XI 和 XII）似乎在相互作用距离上遵循合理的趋势，并且在利用实验数据的情况下，在结合能上也遵循合理趋势。然而，最好记住，“静电”相互作用，例如配体和蛋白质金属（例如 Zn$^{2+}$）之间的相互作用，可能需要通过一个考虑部分化学键形成和配位点之间伴随电荷转移的模型来处理。

在这里，毫不奇怪[^46]，我们发现 MMFF94 的在真空优化常常使构象与晶体中观察到的构象发生显著变化。确定 MMFF94 在能量最小化研究中——或者更好的是，在分子动力学模拟中——当计算在晶格背景下进行时，重现晶体几何结构的效果如何，将是很有意义的。
迄今为止，MMFF 主要被用于能量最小化研究以及由主体程序 OPTIMOL$^1,47$ 支持的其他计算和分析。然而最近，一个版本的 MMFF 已被实现在商业分发的程序 CHARMm$^4,48$ 中，并且 MMFF94 预计也将在学术版本 CHARMM$^49$ 中可用。此外，目前正在进行将 MMFF94 实现在 MacroModel 程序套件的 BatchMin 模块中的工作。[^50] 鉴于在构象能方面获得的良好结果，包括与蛋白质构象相关的构象比较结果[^4]，以及为实现分子间相互作用的平衡表示所付出的仔细关注[^2]，我们认为 MMFF94 既是一个“蛋白质”力场，也是一个“有机”力场。我们期望它在两个领域的结构和性质建模中都能表现良好。

### 致谢

我感谢 Joseph Andose 实现了式 (18) 的早期版本，并感谢 Robert Nachbar 和 Simon Kearsley 提供了有助于准备 CSD 数据和刚性叠加分子结构的程序。