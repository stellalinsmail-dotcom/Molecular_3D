## Merck 分子力场第三部分：MMFF94 的分子几何结构与振动频率

### 摘要

本文描述了 MMFF94 在分子几何和变形方面的参数化和性能。它定义了用于表示键长和角度变化的价坐标项的形式，并描述了从 HF/6-31G\* 数据推导二次力常数以及从拟合 MP2/6-31G\* 优化几何推导参考键长和角度的过程。提供的比较表明，MMFF94 准确再现了其参数化中使用的计算数据，并证明从这些数据推导同时赋予了再现实验的能力。特别是，MMFF94 再现了 30 种有机分子的实验测定键长和角度，均方根 (rms) 偏差分别为 0.014 Å 和 1.2°。MM3 以相同的精度再现键角，但更准确地再现实验键长，部分原因是它直接拟合了热平均实验键长；而 MMFF94 则拟合了（通常较短的）能量最小值，这适用于旨在用于分子动力学模拟的非谐力场。比较还表明，UFF 和 CHARMm 的最新版本（QUANTA 3.3 参数化）在分子几何上的准确性均低于 MMFF94 或 MM3。对于振动频率，MMFF94 和 MM3 对于 15 个小的、主要是有机分子的实验总体均方根偏差分别为 61 cm$^{-1}$ 和 57 cm$^{-1}$，表现相当。在许多情况下，MM3 的推导使用了与其他已发表频率显著不同的观测频率——在一个案例中相差近 400 cm$^{-1}$——而这些已发表频率本身已通过高质量从头计算得到理论确认。总体而言，与实验几何和振动频率的比较表明，对于 MM3 已参数化的有机体系，MMFF94 达到了类似 MM3 的精度。然而，由于 MMFF94 主要源自计算数据，因此有可能以同等严谨度对许多其他体系进行参数化，而这些体系很少或没有有用的实验数据。对于此类体系，可以预期同样良好的性能。

### 引言 
这是介绍 MMFF94 系列文章的第三部分。1-4 本文描述了 MMFF94 的参数化，并表征了其在分子几何和振动频率方面的性能，特别是与广泛使用且备受推崇的 MM3 力场5 的关系。第二部分给出了 MMFF94 能量表达式中由键长和角度变化引起的价坐标项的形式。第三部分随后重点介绍了描述键拉伸、角弯曲、拉伸-弯曲相互作用和面外弯曲所需的二次力常数的参数化，第四部分描述了键长和角度参考值的推导；第五部分说明了这些参数化方面如何结合以生成一组相互一致的参数。第六部分表征了 MMFF94 在分子几何和振动频率方面的性能。还给出了 MM3、UFF6 和 CHARMm7 在几何方面以及 MM3 在振动频率方面与实验的比较。第七部分展示了 MMFF94 参数的一个子集，并说明了如何获取完整集合（相关的附录 A，补充材料，讨论了参数表的格式和使用）。最后的讨论总结了这项工作，并指出了函数形式和参数化方法未来可能的改进。

### MMFF94 用于键拉伸和角弯曲相互作用的函数形式



总 MMFF94 能量可以写为：
$$
E_{MMFF} = \sum EB_{ij} + \sum EA_{ijk} + \sum EBA_{ijk} + \sum EOOP_{ijk,j} + \sum ET_{ijk,l} + \sum EvdW_{ij} + \sum EQ_{ij}
$$
其中求和遍及适当的原子索引对、三元组或四元组。本节考虑方程 (1) 中的前四项。下文引用的数值常数使得当距离和角度分别以埃和度为单位测量时，所有项均以千卡每摩尔为单位计算。

#### 四次键拉伸

MMFF94 中使用的形式为：
$$
\begin{align}
EB_{ij} =& 143.9325 \, kb_{ij}/2 * \Delta r_{ij}^2 \\
&*(1 + cs * \Delta r_{ij} + 7/12cs^2 * \Delta r_{ij}^2)
\end{align}
$$
其中 $kb_{ij}$ 是键拉伸力常数 ($md/\AA$)，$\Delta r_{ij} = r_{ij} - r_{ij}^0$ 是键合原子 i 和 j 的实际键长与参考键长之差 ($\AA$)，$cs = -2 \, \AA^{-1}$ 是“三次拉伸”常数。此函数对应于具有“alpha”为 $2 \, \AA^{-1}$ 的 Morse 函数展开至四阶。8 与更简单、常用的二次形式相比，此四次展开适用于远离平衡键长得多的位移。它优于 MM2$^9$ 和 MM2X10 中使用的三次展开，后者在键长 $r_{ij}$ 逐渐增加时非物理地发散至负无穷（对于 $cs < 0$）。为 $cs$ 选择的值代表我们在使用 Biosym Consortium 开发的 PROBE 程序11 进行探索性力场优化时获得的 Morse 函数“alpha”的大致平均值 $2 \, \AA^{-1}$。它与 MM2 中使用的值相同，但显著小于 MM3.5 中使用的 $2.55 \, \AA^{-1}$。一项最近使用多组态波函数结合双 zeta 加极化基组的研究发现，对于多种键类型，值接近 $2 \, \AA^{-1}$。12 因此，MMFF94 中使用的 $cs$ 值是一个代表性值，应能捕捉键非谐性的基本部分。

力常数 $kb_{ij}$ 和参考键长 $r_{ij}^0$ 取决于原子 i 和 j 对应的 MMFF 原子类型 I 和 J。为了表示这种依赖性，我们使用 i, j, k ... 来指代原子，而 $ I, J, K \ldots $ 表示相应的原子类型（或在某些情况下表示原子种类）。当前的 MMFF 原子类型在第 1 部分中定义。重要的是要注意，原子类型并不总是足以完全定义所讨论键的性质。例如，考虑 1,3-丁二烯的情况，其中四个 $ sp^2 $ 杂化碳原子均被指定为 MMFF 原子类型 2。为了区分末端碳原子形成的完全双键与两个中心碳原子之间的离域单键，一些力场会引入额外的原子类型。[^13] 这种方法会迅速导致等效但标记不同的参数成倍增加。相比之下，MMFF94 使用形式键序来分配一个键类型索引 $ BT_{ij} $，该索引与原子类型一起，明确地将化学环境与键拉伸的适当参数关联起来。因此，每个拉伸参数由三个数值索引标记——一个用于键类型，两个用于原子类型。实际上，这种方法使得能够为“共轭单键”（例如丁二烯和联苯中的键）使用特殊的参考键长和力常数集合。为了提供最大的灵活性，MMFF94 目前为大多数 $ sp- $ 或 $ sp^2 $ 杂化氮和/或碳原子之间的形式单键定义了键类型索引的特殊值。[^4]

#### 三次角弯曲

大多数角弯曲相互作用由三次展开描述：
$$
EA_{ijk} = 0.043844 \frac{k a_{ijk}}{2} * \Delta \vartheta_{ijk}^2 (1 + c_b * \Delta \vartheta_{ijk}) \tag{3}
$$
其中 $ k a_{ijk} $ 是角弯曲力常数 (md $ \overset{\circ}{A}/\text{rad}^2 $)，$ \Delta \vartheta_{ijk} = \vartheta_{ijk} - \vartheta_{ijk}^0 $ 是实际与参考 $ i-j-k $ 键角之差（以度为单位），$ cb = -0.007 \deg^{-1} (\text{或更精确地，} -0.4 \text{ rad}^{-1}) $ 是“三次弯曲”常数。此表达式考虑了角弯曲的非谐性。三次弯曲常数足够小，以确保当 $\theta$ 接近 180° 时 $ EA_{ijk} $ 不会出现非物理行为。该值是通过考虑在水、氨和乙烯的 HF/6-31G\* 计算中，键角变化对角弯曲力常数的影响而获得的；在后两种情况下，使用了先前描述的形式[^8] 来提取力常数。虽然此数据集很小，但所有三个体系表现相似，表明 $ cb $ 的这个值应该是合理的。

对于线性或近线性键角，例如炔烃、腈、异腈、叠氮化物和重氮化合物中出现的键角，MMFF94 采用 DREIDING14 和 UFF:6 中使用的形式：
$$
EA_{ijk} = 143.9325 \, k a_{ijk} * (1 + \cos \vartheta_{ijk}) \tag{4}
$$
其中 $ k a_{ijk} $ 和 $ \theta_{ijk}^0 $ 如上所定义。与方程 (3) 不同，方程 (4) 在 $ \theta_{ijk} = 180^\circ $ 处具有明确的一阶和二阶导数。[^14]

在所有原子 $ i $ 和 $ k $ 键合到一个共同中心原子 $ j $ 的情况下，都包含角项 $ i-j-k $。用于分配力常数 $ k a_{ijk} $ 和参考角 $ \theta_{ijk}^0 $ 的过程类似于键拉伸所用的过程。在当前情况下，定义了一个角类型索引 $ AT_{ijk} $，以允许使用更小的原子类型集合。然而，在这里，这些特殊索引不仅当键 $ i-j $、键 $ j-k $ 或两者都涉及 $ sp- $ 或 $ sp^2 $ 杂化原子之间的单键时需要，而且当 $ i-j-k $ 是三员环或四员环中的一个角时也需要（参见附录 A）。因此，角弯曲参数由一个角类型和三个原子类型索引来表征。角类型索引以及用于将角弯曲相互作用与参数文件中的条目关联起来的过程在附录 A（补充材料）中描述。

#### 拉伸-弯曲相互作用

MMFF94 中使用的形式是：
$$
\mathrm{EBA}_{ijk} = 2.51210 \left( k b a_{IJK} \Delta r_{ij} + k b a_{KJI} \Delta r_{kj} \right) * \Delta \vartheta_{ijk}
\tag{5}
$$


其中 $ k b a_{ijk} $ 是 $ i-j $ 拉伸与 $ i-j-k $ 弯曲耦合的力常数 (md / rad)，$ k b a_{k j} $ 是 $ k-j $ 拉伸与 $ i-j-k $ 弯曲耦合的力常数，$ \Delta r $ 和 $ \Delta \theta $ 如上所定义。当力常数为正时（通常如此），拉伸-弯曲项允许键长 $ r_{ij} $ 和 $ r_{jk} $ 在角 $ \theta_{ijk} $ 减小时增大，在 $ \theta_{ijk} $ 增大时减小，模拟了 Urey–Bradley 1,3 项的效果。5 方程 (5) 与 MM22 和 MM35 中使用的形式密切相关。一个区别是 MMFF94 保留了所有项（涉及线性键角的项除外），而 MM2（但非 MM3）忽略了由氢键拉伸引起的贡献。第二个区别是 MM2 和 MM3（但非 MMFF94）在保留两个贡献时，将 $ k b a_{ijk} $ 视为等于 $ k b a_{k j} $。列出的参数（参见附录 A）表明在某些情况下需要相当不同的值。

拉伸-弯曲相互作用与列表参数的匹配在附录 A 中描述。目前，当 i−j−k 相互作用对应于线性键角时，省略拉伸-弯曲相互作用。

#### 面外弯曲

MMFF94 使用二次形式：
$$
\mathrm{EOOP}_{ijk;l} = 0.043844 \frac{k_{oop,IJK:L}}{2} \chi_{ijk;l}^{2}
\tag{6}
$$

其中 $ k \, \text{opp}_{i,k,l} $ 是面外弯曲力常数 (md Å/rad$^2$)，$ x_{ijk,l} $ 是键 j−l 与平面 i−j−k 之间的 Wilson 角[^15]（以度为单位），其中 j 是中心原子。注意，在每个三配位中心 j 处会产生三个这样的角，因为任何连接的原子 i, k 和 l 都可以作为“面外”原子。在 MMFF94 中，所有这三个这样的角都被分配相同的 $ k \, \text{opp}_{i,k,l} $ 力常数。形式上，为所有三角中心定义了面外弯曲贡献。然而，对于大多数平衡几何结构强烈非平面的情况，参数文件提供零力常数，例如，饱和脂肪胺中的氮。用于将面外相互作用与列表参数匹配的过程在附录 A 中讨论。

为了使得对于非平面以及平面的三角中心使用面外弯曲项变得可行，MMFF94 对三配位中心的正常角弯曲相互作用使用方程 (3)。相比之下，当 MM2 和 MM3 分配面外项时，它们还以要求这些角之和为 360° 的方式定义相关的“面内”角。虽然这种方法适用于平面三角中心，但它不适合描述非平面中心，例如烯胺、磺酰胺甚至酰胺中出现的中心，因为它不允许使用平均值小于 120° 的参考值来使中心呈金字塔形。相比之下，MMFF94 的表述允许角弯曲参考值用于此目的；然后可以使用剩余的“面外”项来改进对反转势垒的拟合（如果需要的话）。

### 二次力常数的推导

对于 MMFF94 的核心计算推导部分，键拉伸的二次力常数 $ k \, b_{ij} $、角弯曲的 $ k \, a_{ijk} $、拉伸-弯曲相互作用的 $ k \, ba_{ijk} $ 和 $ k \, ba_{k,j} $ 以及面外弯曲的 $ k \, \text{opp}_{i,k,l} $ 是通过将 MMFF 能量表达式的修改版本对一组 349 个分子构象的能量的笛卡尔一阶和二阶导数进行最小二乘拟合来确定的。这些拟合使用了通用程序 PROBE。$^11$ 所需的能量导数是在 HF/6-31G\* 水平上，针对 HF/6-31G\* 优化的几何结构，使用 Gaussian 88、[^16] Gaussian 90、[^17] 或 Gaussian 92[^18] 获得的。为使用 PROBE 而对方程 (1) 进行的主要修改包括：(i) 将 MMFF94 的 Buf-14-7 范德华 (vdW) 项和缓冲静电项替换为 Lennard–Jones 10-6 项和简单库仑项；以及 (ii) 对中心 j 的 Wilson 角使用对称化（平均）值 [方程 (6)] 以替代 MMFF94 中使用的三个略微不等价的角。

在 PROBE 拟合中仅优化了二次力常数；所有其他类别的参数保持不变。为了与计算从头算导数时使用的几何结构保持一致，PROBE 运行使用了通过拟合 HF/6-31G\* 优化几何结构确定的参考 MMFF 键长和键角。无疑，使用在 MP2/6-31G\* 水平上针对 MP2/6-31G\* 优化几何结构评估的从头算导数会更好，但计算资源不足。

为了以自洽的方式考虑非谐键拉伸和角弯曲，PROBE 拟合是迭代进行的。初始力常数使用前驱 MM2X 力常数[^10] 用于键拉伸和经验规则值[^8] 用于角弯曲进行分配。应用 −2 Å$^{-1}$ 的三次拉伸参数和 −0.4 rad$^{-1}$ 的三次弯曲参数，然后得到了所需的二次和四次键拉伸以及三次角弯曲力常数的估计值。这些高阶力常数的估计值用于评估最小二乘拟合准则，但保持固定。然后，二次力常数的新值被用于更新下一次 PROBE 拟合的三次和四次力常数。通常，三到五次这样的迭代产生一组收敛的二次力常数。

PROBE 拟合的其他三个方面值得评论。(1) 由于 PROBE 不允许在匹配力场相互作用与力场参数时使用键序信息，因此必须为 sp$^2$ 杂化碳创建一个新的原子类型，用于丁二烯和取代丁二烯，以区分双键和形式上的单 C—C 键。经过一些困难，开发了成功在 PROBE 和 MMFF 参数表示之间进行映射的程序。(2) 扭转和面外弯曲力常数之间的耦合造成了一些困难。特别是对于芳香体系，用于二重扭转参数的初始值有时不恰当地导致相关的面外弯曲力常数出现显著负值。在这种情况下，我们充分减小二重扭转参数，以产生正的，或至多轻微负的面外力常数；为了复现分子几何结构，一些后者最终不得不重置为轻微正值。(3) 由于 HF/6-31G\* 频率过大，平均大约 10%，[^19] 推导出的力常数被缩放以供 MMFF94 使用（见下文的“比例因子的确定”）。

### 键长和键角参考值的推导

为了推导参考值，我们组装了一个包含 342 个 MP2/6-31G\* 优化构象异构体的集合（在验证中使用了一个稍大的集合），并使用 OPTIMOL/MMFF$^1$ 依次优化每个构象异构体，并将初始（MP2）和最终（MMFF）键长或键角的比较写入输出文件。我们将初始参考键长和键角取为在 MP2/6-31G\* 优化结构中观测值的平均值，并从 MM2X 获取初始二次力常数用于键拉伸，从经验规则获取用于角弯曲。$^{18}$ 为了确保从头算优化和 MMFF 优化的构象保持相似，我们对每个扭转角施加了弱谐波约束（惩罚函数）。$^{20}$

接下来，我们整理了关于每种特征键或键型的从头算优化和 MMFF 优化几何结构之间比较的信息。为了更新键长的参考值，我们从相应的参考值中减去 MMFF 优化和从头算优化键长之间的平均符号差，并将更新后的参考值写入一个新的 MMFF 参数文件，用作下一次迭代的输入。通常，参考键长快速收敛，通常在大约三个迭代周期内。

我们发现一些键角对参考值变化的响应不如其他键角直接，在大多数情况下是因为它们受到约束，例如三角平面中心处三个角之和或平面四员环中四个角之和必须等于 360°。然而，我们能够通过在前几个迭代周期中将平均偏差校正乘以约 1.5 的因子来加速收敛。由于小环中的角特别不顺应，我们定期将其参考值重新初始化为从头算优化值的平均值。大约六到八个迭代周期产生了“有效收敛”，定义为在最后几次迭代中 MMFF 几何结构的准确性几乎没有进一步改善。

在将每组更新后的参考角写入输出参数文件之前，我们进行了进一步调整以在平均意义上强制“嵌入”。例如，如果三角平面中心处的三个键角之和为 360°，则该中心可在二维空间中嵌入。因此，对于每种三角平面中心类型 $ J $，我们统一调整了参考值 $\theta_{I-J-K}^0$，使得结果参考值在按每个贡献的 $ I-J-K $ 角类型的出现次数加权后，平均为 120°。此调整最小化了角参考值与面外力常数之间的耦合；可以证明，不可嵌入的参考角会引出一个具有正或负力常数的面外弯曲项，该力常数与相应的“圆盈余”或“圆亏缺”成正比，$^{21}$ 该量是参考值之和超过或低于 360° 的量。类似地，对于四配位中心，我们要求给定中心类型的平均参考角等于从头算优化角的平均值。

需要提供三条额外的评论。首先，我们通过将前者的迭代与后者的迭代交错进行来共同确定键和角的参考值。其次，我们应用此迭代程序来确定“HF”和“MP2”参考值。后者使用了前面引用的 342 个 MP2/6-31G\* 优化分子几何结构集合，并产生了用于 MMFF94 的参考值。前者使用了类似的 HF/6-31G\* 优化分子几何结构集合，并产生了用于上一节描述的二次力常数推导的参考值。第三，通过分析拟合质量，我们能够识别出给定 MMFF 原子类型无法正确代表其在化学结构中指定范围的情况。一个实例涉及酰胺中的氮原子（MMFF 数值原子类型 10）以及烯胺、脒、胍和其他不饱和氮化合物中的氮原子（现在由数值原子类型 40 表示）。

### 相互一致的 MMFF94 参数的推导

开发 MMFF94 的一个核心目标是推导出一组尽可能相互一致的参数。给定类别参数内部的自洽性——例如，在二次力常数集合内部——直接源于所有此类核心 MMFF94 参数都是同时从参数化中使用的完整计算数据集推导出来的这一事实。实现不同类别参数之间的自洽性需要一个两阶段方法。首先，我们在拟合计算数据（例如，关于分子偶极矩和分子间相互作用能量与几何结构的数据）$^2$ 时确定了非键静电和 vdW 参数，这些参数主要由这些参数决定。其次，然后我们进行了大约四次完整迭代，包括：(i) 本文描述的推导二次力常数和参考值的程序；以及 (ii) 第四部分$^3$ 描述的推导扭转参数的程序。这种方法允许在逐步细化的其他类别参数值的背景下确定每个类别中的参数。

### MMFF94 的性能表现

#### MP2/6-31G\* 几何结构

如第一部分$^1$ 所述，MMFF94 复现了 358 个 MP2/6-31G\* 平衡构象异构体的 4205 个从头算优化键长，其中大多数用于其推导，均方根误差为 0.006 Å。类似地，它复现了 7021 个 MP2/6-31G\* 键角，均方根偏差为 1.16°。可比的 MM2X$^{1,10}$ 误差分别为 0.018 Å 和 1.70°。对于氮的面外弯曲，MMFF94 准确预测了饱和胺的几何结构（均方根偏差 0.91°，而 MP2/6-31G\* 结构的均方根 Wilson 角为 57.5°）和不饱和胺的几何结构（均方根偏差和值分别为 2.05° 和 43.8°）。然而，对于酰胺，MMFF94 给出的均方根偏差为 9.38°，大约是 MP2/6-31G\* 均方根值 22.6° 的五分之二。但即使在这里，力场总体上正确地复现了 MP2/6-31G\* 结构中发现的角锥化程度。

#### 实验分子几何结构

在本小节中，我们比较了 30 种有机分子的力场和实验几何结构。特别是，我们展示了 MMFF94 几何结构复现实验的效果几乎与已发表的 MM3 几何结构一样好——我们认为这是一个显著的成就，因为 MM3 被广泛认为是小分子建模的最佳可用力场。MMFF94 的性能也特别令人鼓舞，因为它表明，将 MMFF94 拟合到理论 MP2/6-31G\* 几何结构所采用的方法（其中许多最近已在其他地方用于与实验比较$^2$）同时赋予了复现实验的能力。

实验、MM3 和 MMFF94 几何结构的比较见表 I。还包括已发表的 UFF 几何结构$^2$ 和新计算的 QUANTA 3.3/CHARMm 几何结构，$^4$ 其中一些分子先前使用早期的 QUANTA 3.2/CHARMm 参数化进行过表征。$^7$ 作为参考，我们引用了那些在核心 MMFF94 参数化中使用了 MP2/6-31G\* 优化几何结构的体系的五个字符的 MMFF 构象索引。$^1$ 在大多数情况下，我们仅列出所引用的 MM3、UFF 或 CHARMm 研究中发表的结构信息。原子标记通常与下面引用的参考文献中使用的一致。

对于乙酰胺，表 I 中引用的凝聚相中子衍射结果反映了一个非平面的酰胺基团。$^{25}$ Wong 和 Wiberg 已经表明，高质量的量子力学计算在气相和包含溶质-溶剂相互作用时也得出非平面的酰胺基团。$^{26}$ MMFF94 预测了一个非平面的酰胺基团，其 H—N—C—O' 扭转角为 4.3°（表 I）和 167.9°（MP2/6-31G\* 角分别为 11.4° 和 164.6°）。相比之下，MM32 产生一个平面的氮，这由与氮形成的三个键角之和为 360° 所证明。未完全报告的 UFF 结构$^{23}$ 可能也是平面的，正如我们发现，QUANTA 3.3/CHARMm 结构$^{24}$ 也是平面的；报告的气相电子衍射结构也是平面的，但是在此假设下推导出来的。考虑结构的其他方面，我们注意到凝聚相中子衍射结构中的氢键相互作用显著缩短了 $ \text{C}'—\text{N} $ 酰胺键（1.335 Å）并延长了 $ \text{C}'—\text{O} $ 双键（1.247 Å），相对于气相电子衍射结果分别为 1.380 和 1.220 Å。[28] 作为比较，MP2/6-31G\* 优化得到 $ \text{C}'—\text{N} $ 键长为 1.373 Å，$ \text{C}'—\text{O} $ 键长为 1.228 Å。

对于反式-N-甲基乙酰胺，[29] MMFF94 预测了类似的非平面结构，如与乙酰胺一样，与氮形成的三个键角之和再次约为 $\sim$ 358° 所示。然而，在这里，MP2/6-31G\* 结构几乎是平面的。因此，正如本研究后面进一步讨论的，MMFF94 在预测酰胺氮的非平面性方面仅部分成功。然而，大多数其他力场总是给出平面的酰胺。例如，Meier 和 Coussens 报告说，Hagler 和 Lifson 的 CVFF 力场对尿素给出了平面结构。[30] 形成鲜明对比的是，MP2/6-31G\* 的尿素结构明确是非平面的（我们发现 Wilson 面外角约为 $\sim$ 42°），并且具有 2.6 kcal/mol 的显著平面化势垒。[30] 对于反式-N-甲基乙酰胺，CHARMm[24] 给出了较短的 $ \text{C}'—\text{N} $ 键长 1.346 Å，与乙酰胺中子衍射结构中观察到的 1.335 Å 值相当。显然，CHARMm 试图模拟氢键合酰胺预期的几何结构，这对于旨在用于凝聚相模拟的力场来说不是一个不合理的选择。不幸的是，目前的力场不允许在气相和水相结构之间随着环境从一个极端变化到另一个极端而获得平滑过渡。然而，几何结构差异应该有多大尚不清楚。

接下来，我们考虑芳香分子吡啶、联苯、呋喃和咪唑。对于吡啶，MMFF94、MM3(Pi)[31] 和 UFF[23] 都相当好地复现了观测到的微波几何结构，[32] 尽管 UFF 在键角方面不太成功。MMFF94 和 MM3(Pi)[31,33] 复现了实验测定的呋喃[34] 中 $ \text{C}—\text{C} $ 键长和咪唑[35] 中 $ \text{C}—\text{N} $ 键长的交替变化，但 UFF[23] 没有。与 MMFF94 一样，MM3(Pi)[36] 和 UFF[23] 都产生非平面几何结构对于联苯，与实验电子衍射结构在定性上一致。对于咪唑，MMFF94 预测 N—H 键长为 1.011 Å，而实验、MM3(Pi) 和 UFF 给出的值都在 1.04–1.05 Å 范围内。在这种情况下，实验中子衍射结构中发现的强分子间氢键显然显著延长了 N—H 键。作为比较，MP2/6-31G\* 优化键长为 1.012 Å，几乎与 MMFF94 值相同。显然，在这种情况下，MM3 和 UFF 已被参数化以复现一个受扰动的实验键长，其值与通常用于它们推导的气相值有很大差异。

对于乙酸，MMFF94 和 MM39 都很好地预测了实验微波几何结构。CHARMm 的早期参数化准确给出了 C—O—H 角，但 QUANTA 3.3 参数给出的角度过大，并且高估了 C—C 距离。对于通过电子衍射研究的甲酸甲酯，MMFF94 在键角上比 MM39 更准确，但在键长上准确性较差。UFF6 对连接羰基碳和酯氧的 C’—O 键长的预测值过大。

对于共轭体系反式-1,3-丁二烯和丙烯醛，MMFF94 预测几何结构的能力与 MM3(Pi) 大致相当。36.43 对于前者，MMFF94 有意将中心 C—C 键长计算得过短，以更好地解释用于扩展 MMFF 参数化的 X 射线数据中发现的类似类型键。我们检查的大多数具有 $ \text{C}_{sp^{2}}-\text{C}_{sp^{2}} $ 单键的晶体结构还具有扩展的“推拉”共轭，这进一步增加了 pi 键级并减少了键长。因此，我们选择用更小的折衷值 1.430 Å 替换从 MP2/6-31G\* 数据推导的理想键长 1.447 Å。对于键角，MMFF94 的最大差异是丙烯醛中 C2—C1=O4 键角的值过小（121.3°）。MP2/6-31G\* 值（124.0°）与实验值相同，表明力场模型存在缺陷。对于 UFF，在此特定情况下未报告值，但报告的同一中心 C2—C1—H5 角过大。MM3 似乎未能复现丙烯醛中 C2=C3—H7/C2=C3—H8 键角的定性趋势。

MMFF94 和 MM34 很好地复现了乙醛和丙酮的实验结构，CHARMm 对前者也是如此，除了 C’—H 键长过短。对于后者，UFF 给出的 C—C—C 角过大。对于环丁酮，MMFF94 预测的 C2—C3 键长（1.548 Å）过小，MP2/6-31G\*（1.551 Å）也是如此，MM34 在大多数方面表现良好，但预测了一个平面环结构。作为参考，MP2/6-31G\* 优化对引用的 C4—C1—C2—C3 扭转角给出 12.4°，与 MMFF94 的 13.9° 值相当。然而，我们应该注意，计算出的平面化势垒很小（$\sim$ 0.2 kcal/mol），使得 MM3 试图模拟的时间平均结构是平面的。作为主要旨在用于分子动力学计算的力场，MMFF94 则相反，试图复现势能面上的（非平面）最小能量结构。

对于甲醛亚胺（$ \text{H}_2\text{C}=\text{NH} $），MMFF94、MM3(Pi) 和 UFF23 都表现得相当好。然而，没有一个能准确描述 H—C—N 顺式和 H—C—N 反式角之间的变化；MP2/6-31G\* 角（分别为 125.5° 和 118.4°）证实了实验结果。MMFF94、MM34 CHARMm 和 UFF6 都准确描述了甲胺和三甲胺。

MMFF94 很好地解释了甲醇的实验毫米波结构，除了 O—H 键长，其实验值 0.945 Å 虽然被 MM32 紧密复现，但可能过短。其他引用的实验测定给出的键长长达 0.960 Å，并且乙醇的微波测定给出的 O—H 键长为 0.971 Å（第二次测定采用了甲醇值）。作为比较，MP2/6-31G\* 键长为 0.970 Å。

MMFF94 很好地解释了甲醇的实验毫米波结构，除了 O—H 键长，其实验值 0.945 Å 虽然被 MM32 紧密复现，但可能过短。其他引用的实验测定给出的键长长达 0.960 Å，并且乙醇的微波测定给出的 O—H 键长为 0.971 Å（第二次测定采用了甲醇值）。作为比较，MP2/6-31G\* 键长为 0.970 Å。

对于烷烃丙烷、异丁烷、环丁烷和环己烷，MMFF94 通常预测的 C—C 和 C—H 键长过短约 0.010–0.015 Å，而 MM3$^5$ 紧密复现了实验 $ r_g $ 值。MP2/6-31G$^*$ 键长几乎与列出的 MMFF94 值相同，表明这种差异要么归因于 MP2/6-31G$^*$ 模型的缺陷，要么归因于能量最小化结构和热平均（通常是 $ r_g $）结构之间的固有差异。作为检查，我们使用三ζ加极化 (TZP) 基组在 MP2 水平上优化了乙烷。$^3$ 我们发现 C—C 和 C—H 键长分别为 1.531 和 1.093 Å。作为比较，实验电子衍射值$^61$ 分别为 1.534 和 1.112 Å，而 MP2/6-31G$^*$ 给出 1.524 和 1.093 Å。这些比较表明，MP2/6-31G$^*$ 和推导出的 MMFF94 C—C 键长可能比实验能量最小值小约 $\sim 0.01$ Å。相比之下，C—H 键长的实验值显然相对于能量最小值因非谐性校正而延长。

对于降冰片烷，MM3$^62$ 复现了电子衍射 C—C 键长$^63$ 中大部分的巨大变化，但 MMFF94 和 UFF$^23$ 没有。在 MP2/6-31G$^*$ 优化结构中，C2—C3 键（沿 CH$_2$—CH$_2$ 桥）延长至 1.555 Å，几乎正好是 MM3 值，但 C1—C2 和 C1—C7 键长分别保持在 1.536 和 1.534 Å。显然，大得多的实验变化，特别是 C2—C3 键延长至 1.573 Å，与 MP2/6-31G$^*$ 模型不符。所有力场方法都相当准确地给出了扭转角（但请注意 C7—C1—C2—C3 角的符号，推测应为负）。

对于 skew-1-丁烯$^64$ 和顺式-2-丁烯，$^65$ MMFF94、MM3$^66$ 和 CHARMm$^72$ 在大多数情况下给出了优异的结果。然而，对于后者，这些方法在碳骨架是否平面和/或末端甲基是否扭转方面存在分歧。CHARMm$^24$ 支持实验提出的非平面结构，而 MMFF94 和 MP2/6-31G$^*$ 各自给出 C$_2$ 对称的优化结构，即使使用较低对称性的 CHARMm 结构作为初始几何结构也是如此。MM3 给出平面碳骨架但略微扭转甲基。

最后，MMFF94 和 MM3$^69$ 都非常好地描述了乙硫醇$^67$ 和二甲基硫醚$^68$ 的几何结构，但 CHARMm 对前者的 C—S—H 键角给出了非常差的值。$^24$ 乙基甲基二硫醚$^70$ 和甲基氢二硫醚$^71$ 也被 MMFF94 很好地描述，除了系统性地高估 S—S 键长，这种高估在 MP2/6-31G$^*$ 优化结构$^22$ 中同样存在。CHARMm$^24$ 在大多数情况下表现良好，但高估了 S—S 扭转角。MM3$^72$ 非常准确地描述了前者，但对后者给出了异常小的 S—S—H 键角 92.0°；MP2/6-31G$^*$ 值 99.6°（与 MMFF94 值相同）证实了实验角 98.3°。

为了将上述比较置于定量基础上，我们在下面列出了针对此处考虑的四种方法发现的与实验几何结构的均方根偏差：

$$
\begin{array}{ccccc}
\hline
&\text{MMFF94} & \text{MM3} & \text{UFF} & \text{CHARMm} \\
\hline
\text{键长 (\AA)} & 0.014 & 0.010 & 0.021 & 0.016 \\
\text{键角} 
(\text{度}) & 1.2 & 1.2 & 2.5 & 3.1 \\
\hline
\end{array}
$$

这些均方根偏差基于表 I 中列出的 MMFF94 的所有 95 个键长和 86 个键角，MM3 的 94 个键长和 84 个键角，UFF 的 51 个键长和 32 个键角，以及 CHARMm 的 44 个键长和 39 个键角。用先前引用的 MP2/6-31G$^*$ 值替换乙酰胺中的 C’—N 和 C’—O 键、咪唑中的 H—N 键、甲醇中的 O—H 键以及降冰片烷中的 C2—C3 键（在这些情况下我们建议实验键长可能有问题）将 MMFF94 的均方根偏差降低至 0.012 Å，大大接近 MM3 的均方根偏差 0.010 Å（即使进行了这些替换），但其他引用的值保持不变。

一些与 MM3 的具体比较值得关注。首先，虽然 MM3 复现实验测定键长优于 MMFF94，但我们需要记住，MMFF94 产生的是能量最小键长，而不是 MM3 模拟的热平均实验 $ r_g $ 值。特别是对于与氢原子的键，后者已经包含了由于非谐性引起的增加，MMFF94 在用于分子动力学计算时——其预期领域——可以预期会复现这些增加。（我们注意到，这些比较可能没有正确反映 MM3 的能力，因为并非所有参考实验结构都给出 $ r_g $ 键长。而且，通过将涉及氢的键与其他键分开可能会提供进一步的见解。然而，给出的比较确实允许我们表明 MMFF94 和 MM3 的键长与实验拟合相当，因此差异不大。）其次，尽管两种力场都准确复现了芳香和共轭体系的实验几何结构，但 MMFF94 这样做无需为 pi 电子系统进行单独的分子轨道计算。第三，我们注意到 MM3 对 1,3-丁二烯的第二个实验观察到的（“顺式”）构象异构体给出了平面结构，$^{36}$ 而所有最近的高水平量子力学计算都预测了一个具有 $C=C-C=C$ 扭转角为 30° 至 41° 的 gauche 结构。$^{73,74}$ 与从头算结果非常一致，MMFF94 给出了一个非平面的 gauche 结构，其 $C=C-C=C$ 角为 43°，平面化势垒为 $\sim 1 \, \text{kcal/mol}$。$^{3,74}$

另一方面，MM3 对参考键长使用与电负性相关的修改赋予了一个显著优势，因为它允许 MM3 正确描述 MMFF94 无法复现的实验键长的某些趋势。MM3 的优势在我们准备本文的早期版本时引起了我们的注意，该版本包括对氟乙烷$^{75}$ 和氯乙烷$^{76}$ 的实验比较，CHARMm 的结果也对这些体系进行了描述。$^7$ 我们决定不包括这些体系，因为氟化物和氯化物的 MM3 结构尚未被描述。突出的比较是氟乙烷中的 C—F 键，实验电子衍射测定$^{75}$ 给出的键长为 1.399 Å。相比之下，MMFF94 给出的键长为 1.359 Å，短了整整 0.04 Å。作为比较，已发表的 QUANTA 3.2/CHARMm 计算给出的 C—F 键长为 1.379 Å，使用较新的 QUANTA 3.3 参数$^{24}$ 的计算给出 1.389 Å，而 MMI 计算给出 1.387 Å。短的 MMFF94 键长反映了一个有意的折衷。因此，我们发现用于扩展 MMFF 参数化$^{4}$ 的晶体结构通常包含 CF$_3$ 基团或其他多重氟化脂肪碳，而不是孤立的 C$_{sp^3}$-F 键。特别是 CF$_3$ 基团中的 C—F 键往往非常短——大约在 1.31 到 1.32 Å 之间。结果，扩展参数化给出了 C—F 参考键长为 1.333 Å，远短于我们通过拟合较低氟化度的 MP2/6-31G\* 结构获得的参考值 1.383 Å。鉴于这种差异，我们选择 1.360 Å 作为折衷值，导致氟乙烷的优化键长过短。虽然完整的几何结构尚未被描述，但 MM2 已被参数化以分析性地将氯化物和氟化物中的参考键长与电负性取代基的数量相关联。$^{77}$ 正如预期的那样，MM2（以及推测 MM3）准确地代表了 C—F（和 C—Cl）键长的范围。对于氟化物，较新的 QUANTA 3.3 和 QUANTA 4.0 CHARMm 参数化以不同的方式实现了大致相同的目标；它们定义了单独的“CF1”、“CF2”和“CF3”原子类型，并分别使用 1.388、1.335 和 1.320 Å 的不同参考 C—F 键长。只有后一种方法可以用于目前构成的 MMFF。

上述比较表明，对于常见的有机体系，MMFF94 的性能优于 UFF。这是可以预期的，因为 UFF 不尝试对化学结构和性质进行详细的参数化，而是针对整个元素周期表，旨在实现广泛、全面的覆盖。然而，对于有机结构，UFF 的覆盖范围不一定比 MMFF94 的宽多少。$^{4}$ 最后，CHARMm 在键长方面的表现比 UFF 稍准确一些，但在键角方面是四种方法中最不准确的。特别麻烦的是它对乙硫醇中 C—S—H 键角的预测很差，其中 QUANTA 3.2、QUANTA 3.3 和 QUANTA 4.0 参数文件都包含一个明显错误的参考键角 109.47°。如果排除此实例，CHARMm 的键角均方根偏差降至 2.1°，与 UFF 相当。

#### 振动频率

在本小节中，我们将 MMFF94 的振动频率与 15 种小的、主要为有机分子的实验测定频率进行比较。与上一小节一样，我们还将 MMFF94 与 MM3 进行比较。按表 II 中出现的顺序并参考实验测定，比较的分子是甲酰胺、$^{78-80}$ 苯、$^{81}$ 甲酸、$^{82}$ 甲醛、$^{83}$ 乙醛、$^{84,85}$ 甲胺、$^{86,87}$ 氨、$^{88}$ 甲醇、$^{89}$ 水、$^{90}$ 甲烷、$^{90}$ 乙烷、$^{91}$ 乙烯、$^{92}$ 硫化氢、$^{93}$ gauche-乙硫醇$^{94}$ 和二甲基二硫醚。$^{95}$ 由于振动频率的实验测定有时容易出错，我们尽可能选择那些有高水平从头算和/或缩放的量子力学力场已发表的体系，因此对于这些体系，在已发表两个或更多不相容的数据集时，可以选择一个特定的实验频率集作为最可能准确的。通常做法是，我们将测量的非谐频率与计算的谐频率进行比较，因为无法轻易可靠地进行更好的比较。

使用表 II 中的数据，MMFF94 和 MM3 的总体均方根偏差为：

$$
\begin{array}{ccc}
\hline
&\text{MMFF94} & \text{MM3} \\
\hline
\text{振动频率 (cm}^{-1}) & 61 & 57 \\
\hline
\end{array}
$$

这些均方根偏差基于 MMFF94 的 171 个列表频率和 MM3 的 157 个频率；当仅限于 MM3 子集时，MMFF94 的均方根偏差为 60 cm$^{-1}$。

比较表明，MMFF94 和 MM3 在预测振动频率方面表现相当。然而，我们应该注意，表 II 中列出的 MM3 均方根偏差在某些情况下高于文献中报道的值。差异与实验频率的选择有关。在以下小节中，我们解释了我们做出选择的基础，并指出它们对我们评估 MM3 的影响。我们还检查了 MMFF94 在预测振动频率时产生的错误性质。最后，我们描述了力常数比例因子的推导和使用。

#### 实验频率的选择

让我们从甲酰胺开始。除一个例外，我们使用了 Li 和 Allinger 引用的“观测到的”振动频率。27 然而，如表 II 所示，这些频率中的几个（以及参数化其他酰胺的 MM3 时使用的几个额外频率）实际上是从缩放的量子力学 (SQM) 力场计算的频率。这些频率在表中以“* ”开头，表示它们不同的来源。所讨论的 SQM 力场是 Fogarasi 和 Balazs29 一段时间前基于缺乏极化函数的单行列式 HF/4-21G 计算开发的。HF/4-21G 理论水平现在已知对于含有杂原子的体系是不充分的。预测的频率对于最低频率的 A" 模式特别可能不可靠，该模式主要描述氮的面外弯曲。Lii 和 Allinger 参数化 MM3 以复现此模式的 SQM 值 507 cm$^{-1}$。然而，Fogarasi 和 Balazs 也引用了许多较低的频率，包括来自使用了包含 d 函数的极化基组的从头算96 的频率 196 cm$^{-1}$ 和来自气相和基质红外研究80 的频率 289 cm$^{-1}$。我们在表 II 中列出了后一个值，以“#”开头表示其仍然不同的来源。作为参考，在 MP2/6-31G\* 优化几何结构下的 MP2/6-31G\* 计算给出此模式的频率为 162 cm$^{-1}$，而在更强烈皱褶的 MP2/TZP 几何结构（Wilson 面外角为 $\sim 19^\circ$，而 MP2/6-31G\* 为 $\sim 12^\circ$）下的 MP2/TZP 计算8 给出 302 cm$^{-1}$。因此，引用的实验值似乎是合理的。对此模式重新计算的 MM3 误差超过 200 cm$^{-1}$，解释了表 II 中相对较高的均方根偏差 74 cm$^{-1}$。

对于苯，$B_{2u}$ C=C 伸缩模式的实验频率选择至关重要。Allinger 等人36 引用此模式的频率为 1693 cm$^{-1}$，97 而 Pulay 等人98 在 MM3 开发之前的工作中引用了表 II 中列出的低得多的频率 1309 cm$^{-1}$。较低的值99 有相当多的支持。因此，Thakur 等人100 独立报告了观测频率 1310 cm$^{-1}$：Guo 和 Karplus101 在 HF/6-31G\* 和 MP2/6-31G 水平分别计算了 1352 和 1377 cm$^{-1}$；Ozkabak 等人102 使用更大基组和/或更高相关波函数计算了与此指派兼容的一系列频率。MM3 错误地复现了较高的值，从而产生了 $\sim 350$ cm$^{-1}$ 的误差。

MM3 对苯的处理说明了相对于实验数据参数化力场的一个不可避免的危险：这些数据在意外的时候可能包含大的错误，然后成为经验模型的一部分。第二个例子出现在乙醛的情况下，其中 Allinger 等人44 引用五个 A" 模式中第三个的实验值103 为 919 cm$^{-1}$。相比之下，Wiberg 等人引用此模式的实验频率为 1107 cm$^{-1}$，84 与它们缩放的 HF/6-31G\* 频率 1111 cm$^{-1}$ 非常一致。在 MM3 参数化的其他地方还出现了其他几个引用实验频率存在巨大差异的实例。举一个例子，Lii 和 Allinger104 引用环己烷中第二低频 A$_{2u}$ 模式为 862 cm$^{-1}$，而 Wiberg 等人[^105] 和 Gough 和Murphy$^{106}$ 引用 1039 cm$^{-1}$ 并分别计算了 1014 和 1040 cm$^{-1}$；MM3 给出 869 cm$^{-1}$，这个值显然误差约 $\sim 170$ cm$^{-1}$。

开发实验确定力场的第二个障碍来自许多已发表频率集的不完整性。在这种情况下，推导出的力场很可能对未观测到或未指派的频率产生错误值。对于这里考虑的体系，缺失频率的例子可能影响 MM3 参数化的缺失频率出现在甲胺、甲醇和二甲基二硫醚中，但似乎只有甲胺产生了任何严重错误。在那种情况下，Schlegel 等人$^{107}$ 引用的实验数据$^{87}$，如表 II 所列，包括第二和第三最低 A" 模式的频率 1337 和 995 cm$^{-1}$，他们为此计算的值分别为 1391 和 992 cm$^{-1}$。我们的 HF/6-31G\* 计算在乘以相当标准的因子 0.9 后产生频率 1332 和 947 cm$^{-1}$。因此，引用的实验频率，即使取自固态测量，似乎也是很有根据的。此外，较高频率模式似乎对应于在气相光谱中在 1335 cm$^{-1}$ 处观测到的弱模式。$^{108}$ 然而，在 Schmitz 和 Allinger$^{48}$ 引用的实验测定$^{109}$ 中，没有报告这些模式的频率。如表 II 所示，MM3 很好地复现了较低频率模式，但预测较高频率为 1180 cm$^{-1}$，这个值误差大约 150 cm$^{-1}$。当包括这些 A" 模式时，甲胺的均方根偏差对于 MM3 增加到 46 cm$^{-1}$，是原始出版物中报告数字的两倍。类似的问题也可能出现在正丁烷中，其中 Li 和 Allinger$^{104}$ 计算了第三最低 B$_{g}$ 模式的 MM3 频率为 1053 cm$^{-1}$。他们没有引用此模式的实验频率，但 Murphy 等人$^{110}$ 从他们缩放的 HF/6-31G 力场计算了显著更高的频率 1202 cm$^{-1}$。

使用实验数据参数化振动频率的第三个、更微妙的危险源于匹配计算和观测振动模式特征的困难，特别是在分子对称性低时。虽然实验研究通常对振动模式进行定性描述，但在低对称性情况下，人们通常必须假设给定对称性的计算模式以相同的顺序出现，并反映与实验确定模式相同的组成。相比之下，在构建表 II 时，我们通过比较 MMFF 的振动模式组成与在 HF/6-31G\* 水平计算的模式组成$^{111}$ 来建立对应关系。虽然不完美，但 HF/6-31G\* 模型足够准确，使其计算模式能够相对容易和可靠地与实验匹配。另一方面，对于 MM3，我们假设了与模式对称性一致的最有利匹配。

#### MMFF94 频率中的错误

大多数伸缩模式描述得相当好。然而，如表 II 所示，MMFF94 在复现与氢键的伸缩频率方面表现不均。特别是，计算频率对于 O—H 键往往过高，对于饱和 C—H 键则过低。值得注意的是，虽然甲酸和甲醛中的 C(=O)—H 伸缩频率过高，但烯烃和芳香族 C—H 伸缩（它们也是基于连接在 sp$^2$ 杂化碳上的氢）被很好地描述。对于 C=O 伸缩模式出现了类似的模式，其中计算频率在甲酰胺和甲酸中过高，在乙醛中大致正确，对于甲醛则过低。当然，调整相关的 C=O 和 X—H 力常数以改进拟合将是容易的，正如 MM3（对羰基氧使用几种原子类型）已经相当成功地做到的那样。然而，为了通用性，我们选择简单地均匀缩放从 HF/6-31G 能量表面获得的力常数。

弯曲模式在准确性上显示出相当大的变化，但没有明显的模式。然而，面外弯曲的频率通常被高估，例如，在苯的六种情况中有五种。对于这些模式，MMFF 频率不能统一向下调整，因为面外变形频率在不同程度上显著地由扭转相互作用的贡献决定。例如，这种相互作用在苯中贡献很强，但在甲醛中不起作用。因此，充分降低面外弯曲的比例因子以使苯的变形一致，将进一步降低已经低估的甲醛面外频率。

在饱和体系中，MMFF94 的扭转频率通常过高，如乙醛、甲胺、甲醇、乙烷和乙硫醇的最低频率模式的比较所示。这种高估似乎是参数化 MMFF94 主要为了复现构象能而不是扭转频率的结果。作为比较，MM3 准确预测了乙烷的扭转频率，但产生的扭转势垒为 2.41 kcal/mol，比实验确定的势垒 2.88 kcal/mol 低约 20%。$^{112}$ 增加 MM3 的三重 H—C—C—H 扭转参数会改进势垒，但也会提高计算的扭转频率。$^{5}$ 包含六重扭转项可能同时拟合势垒和频率所必需的。MMFF94 在个别振动频率上产生特别大的错误，对于苯（此处检查的最复杂系统之一）以及对于甲醛和氨（两个最简单的系统）都是如此。这些缺陷几乎肯定反映了 MMFF94 力场的简单性。更接近地复现观测频率可能需要广泛选择“交叉项”，类似于 Hagler 及其同事的 Biosym Consortium 力场中使用的那些。$^{11}$ 我们发现杂核芳香体系被 MMFF94 描述得更差不会感到惊讶，正如 Allinger 小组最近的论文显示最近版本的 MM3 就是这种情况。$^{31}.^{33}$ 但是，在振动频率处理上超过 MMFF94 和 MM3 所达到的精度水平的改进是否对有机和生物有机体系建模具有实际重要性则不太确定。此外，氨的情况提供了一个发人深省的图景，即可能需要多高的复杂度才能实现 uniformly 高精度。因此，在这项工作的早期阶段，我们使用 PROBE$^{11}$ 将一系列力场模型拟合到表 II 中几个分子的能量的 HF/6-31G\* 一阶和二阶导数，并监测推导出的力场模型复现从头算振动频率的程度。对于氨，我们发现一个精细的力场模型，包括键拉伸和面外弯曲之间的交叉项（不仅仅是键拉伸和角弯曲之间），可以复现所有 HF/6-31G\* 频率至 2 cm$^{-1}$ 以内。然而，令我们惊讶的是，当我们省略这个单一的交叉项时，我们发现（重新推导的）力场现在给出“伞形”弯曲模式的频率为 1092 cm$^{-1}$，相对于参考从头算频率 1216 cm$^{-1}$，误差非常大，达 118 cm$^{-1}$。

#### 二次力常数比例因子的确定

前面讨论了与 HF/6-31G\* 能量导数的拟合。这里我们描述用于将推导出的“HF/6-31G\**”力常数与 MMFF94 中使用的值关联起来的比例因子的校准。

在前面章节描述的大迭代过程的最初几个周期中，我们使用了以下比例因子：键拉伸为 0.88；角弯曲为 0.84；拉伸-弯曲相互作用为 0.86；面外弯曲为 0.78。然而，在最终推导键长和键角的参考值以及扭转参数之前，我们通过计算 MMFF94 振动频率并将其与表 II 中所示的实验值进行比较来确定这些比例因子的最佳值。在这样做时，我们将实验频率分为描述与氢的键拉伸、其他键拉伸、角弯曲和面外弯曲的集合。然后我们确定了每个集合内的均方根偏差和实验与计算频率的平均比率。接下来，我们将先前假设的每个比例因子乘以相应振动模式集合的频率平均比率的平方。这个过程产生了以下 MMFF94 比例因子：键拉伸为 0.84；角弯曲为 0.78；拉伸-弯曲相互作用为 0.81（取前两个值的平均值）；面外弯曲为 0.72。这些比例因子与已知的 HF/6-31G\* 计算高估观测频率约 10% 的倾向一致。我们曾考虑为多重键、氢键以及其它单键分别应用不同的键伸缩比例因子，但发现这样对实验频率的拟合效果不会有太大的进一步改善。

#### 酰胺和不饱和胺的几何结构

如何模拟酰胺和不饱和胺（乙烯基胺、芳香胺、胍等）的几何结构是我们在开发MMFF94过程中遇到的最棘手问题之一。因此，对于这两类体系，晶体学测定的结构在氮原子上往往相对平面，尽管已有描述中等环内酰胺中存在适度非平面酰胺的报道。[^113] 另一方面，苯胺的实验微波结构强烈非平面。[^114] 这种差异的出现是因为晶体学结构通常给出的是不同能量最小值的时间平均，而其他实验测定（如引用的苯胺数据）可以给出反映局部能量最小值几何的结构。由于MMFF94主要开发用于分子动力学计算，它试图重现后者。然而，对于仍然流行的能量最小化（与分子动力学相对）研究，我们正在开发一个修改的力场，目前称为“MMFF94s”，该力场为三角离域氮中心产生平面或近乎平面的平衡几何结构。[^115]

在本节的剩余部分，我们将回顾证据表明涉及此类氮中心的从头算结构在大多数情况下是非平面的，并将描述MMFF94重现这些结构的能力。我们将首先指出，MP2/6-31G* 优化的几何结构通常发现酰胺是适度非平面的，并且一致地使不饱和胺相当强烈地皱褶。因此，尽管高水平从头算发现反式-N-甲基乙酰胺近乎平面，[^116] 正如本工作中使用的MP2/6-31G* 计算一样，Sponer和Hobza117最近的计算发现核酸碱基，如苯胺，在此水平上明显皱褶。例如，对于苯胺，我们MP2/6-31G* 优化的平衡几何结构中，$NH_{2}$基团平面与芳香环平面之间的二面角（42.8°）与实验微波结构（42.3°）几乎相同。值得注意的是，MP2/6-31G* 结构中氮的Wilson面外角为47.7°，不比早先报道的饱和胺的均方根角57.5°小多少。

这种非平面性并非人为假象的证据来自我们在更高理论水平上进行的从头算。例如，对于尿素，在MP2/6-31G* 、MP2/TZP、MP4SDO/TZP、QCISD(T)/TZP和MP2/TZ(2d,f)水平上获得的从头算几何结构均显示平均Wilson面外角在40°至43°之间；118 从而使尿素几乎与苯胺一样强烈地金字塔化。我们还详细检查了其他三个体系。对于甲酰胺，如前所述，MP2/6-31G* 优化产生一个略微皱褶的结构，其Wilson面外角约为12°，此处，MP2/TZP优化产生一个面外角约为19°的结构，皱褶更强烈。另一方面，对于乙酰胺，平均面外角（MP2/6-31G* 和MP2/TZP分别为23°和24°）随着基组的改进变化很小。最后，对于胍，MP2/6-31G* 和MP2/TZP的面外角分别约为48°和47°。

基于在尿素中发现的更高极化函数和MP2水平以上电子相关性缺乏影响这一现象是普遍的假设，我们得出结论，MP2/6-31G* 最小能量结构代表了实际孤立（气相）体系。然而，重要的是要认识到相应的凝聚相几何结构未必具有可比性的强烈金字塔化。因此，与羰基氧的氢键应使氧更具电负性，从而增加氮孤对共振离域到C=O双键中并促进平面性。为了评估这种效应可能有多大，我们检查了环状（双氢键）尿素…水和尿素…尿素二聚体的HF/6-31G* 优化结构。我们发现，对于（皱褶稍弱的）HF/6-31G* 几何结构，氮处平均Wilson面外角35°略有下降，在尿素…水二聚体中氢键NH$_{2}$基团降至33°，在环状尿素…尿素二聚体中氢键NH$_{2}$基团降至29°。为了探究强相互作用极限，我们在羰基氧上质子化尿素并优化了MP2/6-31G* 几何结构。此处，氮处的Wilson面外角对于反式NH$_{2}$基团降至4°，对于顺式基团降至14°。

我们的初步结论是，凝聚相能量最小结构可能比气相实验或MP2/6-31G* 优化结构的皱褶程度弱。然而，目前我们将以MP2/6-31G* 结构模型为基准衡量MMFF94的性能。对于不饱和胺，先前总结的面外角比较表明MMFF94准确重现了MP2/6-31G* 结构中反映的金字塔化程度。虽然酰胺的面外角出现较大误差，但MMFF94在整体意义上正确重现了MP2/6-31G* 的金字塔化。具体而言，MMFF94对18个伯酰胺氮给出均方根Wilson角23°，对30个仲酰胺氮给出16°，令人满意地接近MP2/6-31G* 的均方根角分别为25°和14°。我们检查的叔酰胺—N,N-二甲基甲酰胺、N,N-二甲基乙酰胺、N-甲基-γ-丁内酰胺和N-甲基-δ-戊内酰胺—被预测为 somewhat 过于金字塔化，但通常不严重；对于MMFF94，Wilson面外角分别约为7°、14°、19°和26°，而MP2/6-31G* 为0°、13°、13°和13°。在其他相关比较中，我们注意到MMFF94使N-甲酰甲酰胺中的双离域酰亚胺氮平面化，正如MP2/6-31G* 所做的那样，并且MMFF94和MP2/6-31G* 对十个N-羟基酰胺（异羟肟酸）氮均给出均方根面外角37°。最后，我们指出，我们仅通过重新推导早期“MMFF93”组中使用的一些扭转参数才实现了这种良好的整体性能，这些参数一致地高估了酰胺中氮的金字塔化程度。这种重新推导，以及随之对酰胺氮面外弯曲的两个关键力常数的调整（参见附录A），在第四部分中描述。³

有趣的是，Allinger及其合作者使用实验和从头算数据的组合，最近选择参数化MM2和MM3以产生不饱和胺的 substantially 非平面结构，¹¹⁹ 而不是时间平均平面结构。

### MMFF94的键和角变形参数

表III至VI展示了本文早先描述的能量项的一小部分MMFF94参数。然而，完整集可作为第一部分¹的补充材料获取，并以计算机可读形式获得。¹²⁰ 前身MM2X力场的参数在先前研究¹⁰的补充材料中给出。表中列出的参数源于以下数值原子类型的各种组合：1、2、3、5、7、10、28、31和70。前五种原子类型分别描述饱和碳、烯烃碳、羰基碳、连接碳的氢、羰基氧和酰胺氮。接下来两种描述酰胺和水中的极性氢。最后一种，原子类型70，用于水中的氧。这些原子类型涵盖简单烷烃、烯烃、醛、酮和酰胺，以及水。在此有限的化合物类型集合内，列出的参数是完整的：它们涵盖了所有计算推导的参数和第五部分⁴中提出的扩展参数化中定义的所有参数。为了一致性，第二部分²和第四部分³中给出的其他力场项的参数覆盖相同的原子和化合物类型集合。

参数文件格式和用法的详细讨论可在附录A（补充材料）¹²¹中找到。

### 结论性讨论

在本文中，我们完整定义了MMFF94能量表达式中的键拉伸、角弯曲、拉伸-弯曲和面外弯曲项，并完整指定了用于推导参数的计算数据和程序。此外，我们描述了用于键拉伸、角弯曲、拉伸-弯曲相互作用和面外变形的参数说明性子集，并定义了力场相互作用如何与参数表中的条目匹配（附录A）。¹²¹ 完整参数表包含在第一部分¹的补充材料中，并以计算机可读形式提供。¹²⁰

我们确信，对于当前构成的MMFF，最终MMFF94参数集尽可能好地描述了计算数据。然而，MMFF94性能的一些限制可能源于其简单的函数形式。例如，我们注意到MMFF94不允许C—F（及其他）键长随碳上多个电负性取代而发生实验观察到的显著变化。省略连接扭转运动与键拉伸和角弯曲的交叉项也具有容易察觉的后果。例如，需要这些项来重现当酰胺中C—N旋转约90°破坏酰胺基团共振时发生的键长显著增加约0.1 $ \AA $；类似地，尽管通常较小，键长增加发生在其他离域体系中。一个包含更广泛交叉项的MMFF改进版本将能够比MMFF94更准确地描述几何结构和振动频率。然而，先前引用的氨案例清醒地提醒我们，在试图以严格详细的方式拟合能量面的方法中，准确预测频率所遇到的困难。该案例显示，准确重现氨的“伞形”弯曲频率需要包含一个不寻常的交叉项，该项耦合键拉伸与面外弯曲。在我们所知的经验力场中，没有包含这样的项。

尽管存在这些我们大多认为较小的限制，与实验分子几何结构和振动频率的比较表明，此初始版本的MMFF按当前标准表现相当好。特别是，MMFF94重现一组30种有机分子的实验测定几何结构远优于UFF或CHARMm（QUANTA 3.3参数化），并且几乎与MM3一样好。MMFF94的键长和键角的均方根偏差分别为0.014 Å和1.2°。

在检查与实验数据的拟合时，我们注意到MMFF94和MM3对1,3-丁二烯预测了定性不同的平衡扭转角。此处，MM3(Pi)与早期实验建议一致，¹²⁴ 预测第二个平衡构象为顺式结构，而MMFF94符合多种高水平量子力学计算以及后来对实验数据的解释，¹²⁴,122-124 预测为 gauche 结构。然而，我们应注意，从头算平面性势垒足够低（约1 kcal/mol¹²⁴），使得时间平均结构为平面。但是，作为主要定义为用于分子动力学研究的力场，MMFF94试图重现势能面上的最小能量结构。在当前情况下，我们将最小能量结构视为非平面 gauche 构象体；尽管从头算存在误差，我们认为对于如此简单的体系，我们及他人进行的质量计算不太可能定性错误。¹²⁵

实验数据的准确性和完整性在比较MMFF94和MM3重现观测振动频率的性能时显得尤为重要。我们发现对于一系列15个小分子，MMFF94的整体均方根偏差为61 cm$^{-1}$，而MM3为57 cm$^{-1}$，表明两种力场在整体意义上表现相当。然而，对于MM3，我们注意到几个例子，其参数化使用了与其他已发布且经理论确认的值显著不同的观测频率。最突出的案例涉及苯中$ B_{2u} $模式的指认，MM3重现了一个实验频率，该频率与另一种本身已被证明与理论计算频率相容的实验指认相差近400 cm$^{-1}$。我们还注意到一个特别重要的例子，其中MM3使用了一组不完整的振动频率，而不是另一组完整且经理论验证的频率集。在此例中，MM3在不知情的情况下，对甲胺中的A"模式产生了一个频率，该频率似乎误差大约150 cm$^{-1}$。

如几何结构和振动频率给出的例子所示，实验推导的力场可能受限于合适实验数据的可用性，以及此类数据的不完整性和/或其中偶尔存在的大误差。实验测定中的误差很容易源于分子几何结构在解释原始实验数据时遇到的可理解困难¹²⁶，或者对于振动频率，源于明确指认完整振动谱的困难，特别是在低对称性体系中。实际上，认识到实验振动谱的局限性，Allinger及其合作者在开发其后继MM4力场时，常规地根据标度化HF/6-31G* （或更好）计算的结果检查振动指认，并在发现频率存在大差异时通常偏向计算结果。¹²⁷ 就前者而言，即使是最终针对实验数据参数化分子几何结构以补偿HF/6-31G* 水平引入的系统误差的CFF93，¹¹⁰ 在这方面可能也有一些局限性。

相比之下，MMFF94使用MP2/6-31G* 几何结构且不作进一步调整；MP2/6-31G* 几何结构已被证明在准确性上与实验相当。²²,¹²⁸

通过针对由高质量标准理论模型产生的数据进行参数化所赋予的性能一致性和广度，是计算推导力场的一个显著优点。MMFF94可以预期在其参数化覆盖的所有化学结构上，基于高质量从头算数据，表现同样良好。

### 致谢

我感谢Robert Nachbar提供他为其程序VIBRATION开发的代码供OPTIMOL/MMFF实现使用，该程序指定简正振动模式的对称性并确定内坐标相互作用的贡献。我还感谢Chris Culberson提出酰胺在氢键作用下可能比在气相中金字塔化程度更弱的建议。