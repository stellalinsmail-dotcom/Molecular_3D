## Merck 分子力场第二部分：用于分子间相互作用的MMFF94 范德华力与静电参数

### 摘要

本文定义了 MMFF94 在分子间相互作用方面的参数化与性能。它明确规定了用于处理范德华（vdW）和静电相互作用的全新“缓冲”函数形式，并描述了（1）利用高质量从头算数据对涉及脂肪族氢的 vdW 相互作用进行参数化；（2）利用氢键复合物的 HF/6-31G\* 计算对极性体系中的非键相互作用进行参数化。对比表明，HF/6-31G\* 数据中的合理趋势被 MMFF94 很好地复现，且分子间相互作用能量与几何结构与高评价的 OPLS 力场非常接近。因此，MMFF94 在水溶液模拟中实现了对溶剂-溶剂、溶剂-溶质和溶质-溶质相互作用的恰当平衡，这对于模拟的成功至关重要。对 20 个小分子和离子的 MMFF94、OPLS、CHELPG 静电势拟合电荷、QEq、Gasteiger 和 Abraham 电荷的比较也表明，MMFF94 与 OPLS 之间具有高度一致性。与 OPLS 和所有当前广泛使用的力场一样，MMFF94 采用了“有效对势”，该势以平均方式包含了在高介电介质中极性的增强。本文讨论了这种方法的一些局限性，并提出了对 MMFF94 函数形式可能的改进建议。

### 引言

本系列第一部分¹⁻⁴总结了新开发的 Merck 分子力场（MMFF94）的形式、参数化与性能。第二部分完整描述了 MMFF94 中用于非键范德华（vdW）和静电相互作用的核心、计算推导部分的参数化与性能。与第一部分一样，本文也将展示与我们上一代 MM2X 力场的性能对比。本研究关注的非键相互作用对于分子力场准确描述至关重要，因为它们在很大程度上决定了力场在描述溶剂化和主-客体结合能量方面的成功程度。

下一节完整给出了MMFF94中处理vdW与静电相互作用的表达式，并阐述这些形式被选用的依据。第三节说明MMFF94如何以高质量量子力学数据为基准，对脂肪族体系中的非键相互作用进行参数化，并展示MMFF94、MM2X、MM2、MM3及CHARMm（QUANTA 3.2版参数）再现这些量子力学数据的程度。第四节详细列出用于确定初始静电参数的数据与流程，并说明如何调整选定的vdW与静电参数，以再现量子力学计算得到的分子间相互作用能量与几何结构的数值与趋势。第五节给出所得参数的代表性数值，并说明如何获取完整参数集；在OPTIMOL/MMFF计算中用作酶位“环境分子”的相关vdW参数与部分原子电荷列于附录A（补充材料）。第六节将MMFF确定部分原子电荷的方法与OPLS、CHELPG、QEq、Gasteiger等方法进行比较，同时表明MMFF94电荷通常与OPLS电荷吻合良好，但在特征上与另外几种方法给出的电荷存在差异。第七节展示MMFF94在再现用于其参数化的HF/6-31G\*分子间相互作用能量与几何结构的数值与趋势方面的能力；并比较MMFF94与OPLS对氢键二聚体的计算结果，显示两种方法通常高度一致。最后，结论部分总结本研究工作，并指出为进一步提高经验力场（如MMFF94）描述非键相互作用的准确性所需的改进。

### MMFF94 范德华与静电势

范德华相互作用

如前所述，¹ MMFF 采用了一种特殊的“缓冲-14-7”（Buf-14-7）形式 [式 (1)] 来描述范德华（vdW）势，而非 MM2、⁶ MM3、⁶ AMBER、⁷ VFF、⁷ 和 CHARMm⁸ 等力场所使用的 Lennard-Jones 或 Exp-6 形式：

$$
E_{\text{vdW}} = \varepsilon_{IJ}\, \left(\frac{1.07R_{IJ}^{*}}{R_{ij}+0.07R_{IJ}^{*}}\right)^{7}\, \left(\frac{1.12{R_{IJ}^{*}}^7}{R_{ij}^{7}+0.12{R_{IJ}^{*}}^7} - 2\right)
\tag{1}
$$
> Paper I, Eq.8

其中 $R_{ij}$ 为原子间距离。参数 $\varepsilon_{IJ}$ 与 $R_{IJ}^*$ 分别为势阱深度（单位：kcal/mol）与最小能量间距（单位：Å）。下标使用大写字母以表明它们对应于 MMFF 的原子类型 I 与 J，而原子 i 与 j 分别属于这两种类型。

正如我们在别处所示，¹⁰ Buf-14-7 势对稀有气体原子实验数据的再现远优于 Lennard-Jones 或 Exp-6 势。与常规做法一致，当原子 i 与 j 属于不同分子或被三根及以上化学键隔开时，才计算 vdW 与静电相互作用。¹,⁴ 在 MMFF94 中，1-4 vdW 相互作用不进行缩放。

对于同种原子对，其最小能量间距通过指定的原子极化率 α_I 由下式获得：
$$
R_I^* = A_I \alpha_I^{0.25} \quad (2)
$$
其中 A_I 为缩放因子，通常对周期表同一周期的元素取相同值。¹⁰为获得异种原子对的最小能量间距 $R_{IJ}^*$，MMFF94 采用“增强算术平均”：
$$
R_{IJ}^* = 0.5 (R_I^* + R_J^*) \left[1 + B \left(1 - \exp(-\beta^* \gamma_{IJ}^2)\right)\right] \quad (3)\\
\gamma_{IJ} = (R_I^* - R_J^*) / (R_I^* + R_J^*) \quad (4)
$$
当$ R_I^* $与$ R_J^*$相差不超过约三分之一时（通常如此），该平均值与先前提出的“立方平均”行为相似。两者均使 $R_{IJ}^*$ 高于常用算术平均的结果（$R_{IJ}^* = 0.5 (R_I^* + R_J^*)$）。应用于前文[^10]表 V 的稀有气体数据时，采用 MMFF94 取值（$B = 0.2，\beta = 12$）的增强算术平均与实验最小间距的 rms 偏差为 0.042 Å，与立方平均的 0.040 Å 相当，远优于简单算术平均的 0.133 Å。

因此，MMFF94 的表现与 Waldman 和 Hagler[^11] 最近提出的新组合规则相当，他们也把立方平均纳入了比较。然而，当 $y_{IJ}$ 趋近 1 时，增强算术平均与立方平均出现显著差异。在某些热力学积分与扰动方法¹²中，当某原子被“消失”时可达此极限。若用简单算术平均，$R_{IJ}^*$ 在 $R_J^*→0$ 时会趋近 $0.5 R_I^*$；而用立方平均则趋近 $1.0 R_I^*$；若采用 $B = 0.2$ 的增强算术平均，则得到 $0.6 R_I^*$ 这一更合理的极限。

对于范德华势阱深度，同种与异种原子对均采用基于 Slater–Kirkwood 的公式：
$$
\varepsilon_{IJ} = \frac{181.16 G_I G_J \alpha_I \alpha_J}{(\alpha_I/N_I)^{1/2} + (\alpha_J/N_J)^{1/2}} \cdot \frac{1}{R_{IJ}^*{}^6} \quad (5)
$$

> (2-5): Paper I, Eq.9-12

其中 $N_I$ 与 $N_J$ 为 Slater–Kirkwood 有效价电子数，$G_I$ 与 $G_J$ 为缩放因子。如前所述，[^10] G 与 N 参数仅依赖于原子种类（而非完整的 MMFF94 原子类型），并通过稀有气体原子及小分子之间高质量的实验 vdW 数据建立系统关系获得。部分用于计算范德华半径的原子极化率来自实验分子极化率的加性分解；¹³ 其余则如下文所述，通过拟合从头算分子间相互作用能量与几何结构的数值与趋势进行优化（见本文第三、四节）。

对于涉及极性氢原子的相互作用，方程(3)与(5)需进行修正。具体而言，当原子$i$或$j$为极性氢时，我们采用简单算术平均（或等效地，在方程(3)中取$B = 0$）来计算$R_{IJ}^*$。此外，若该相互作用被归类为给体–受体氢键，则进一步将$R_{IJ}^*$乘以因子$DARAD = 0.8$，并将由方程(5)计算得到的$\varepsilon_{IJ}$（使用未缩放的$R_{IJ}^*$）乘以因子$DAEPS = 0.5$。这一处理在氢键受体存在时有效减小极性氢的体积，从而正确描述氢键相互作用；而在其他情况下则保留其“正常”（较大）体积。我们在第IV部分[^4]中发现，在关键情形下（例如环己醇）需要保留较大的vdW体积才能再现构象能量。

除Waldman与Hagler关于组合规则的文章[^11]外，另有两项新近vdW研究值得关注。第一项中，Hart与Rappé[^14]指出，在参考体系中，Morse函数在描述vdW势形状方面优于Lennard-Jones 12-6 (LJ-12-6) 与Exp-6形式。Morse形式还避免了LJ-12-6在短接触距离处的过度排斥，并且与Buf-14-7及实验稀有气体势一样，在vdW最小值之外的距离上比$R^{-6}$上升更快。然而，该形式需要一个额外的“形状”参数，其值依赖于相互作用原子的类型。我们认为，其更复杂的指数形式以及对第三个相互作用相关参数的需求，使得Morse势在分子力学计算中不如Buf-14-7形式有吸引力。[^15]

另一项研究中，Cambi 等人[^16]将原子极化率与最小能量间距$R^*_{\text{min}}$及势阱深度$\varepsilon$联系起来，其方式与我们的做法在定性上相似。此外，他们对势阱深度的计算涉及Slater–Kirkwood有效电子数$N_{\text{eff}}$的系统关系，这些关系与我们前文[^11]方程(20)–(24)中给出的$N$定义类似，但适用范围更广。对各自$\varepsilon$表达式的正式比较表明$1.44^2 N_{\text{eff}} = G^2 N$。因此，他们对$N_{\text{eff}}$的近似包含了$C_8$、$C_{10}$及更高阶色散项的某些增强效应，而这些在我们方法中通过缩放因子$G_I$来体现。他们定义的$N_{\text{eff}}$系统关系可能为$N_I$在我们未定义区间内的行为提供指导。然而，其方法似乎过于僵硬。例如，用他们的方法计算的He–He势阱深度为0.068 kcal/mol，是实验值0.022 kcal/mol的三倍。此外，他们给出的原子极化率与$R_{\text{min}}$（我们的记号为$R^*_I$）之间的关系在$\alpha_I \to 0$时导致$R^*_I \to \infty$，这在物理上并不合理。

#### 静电相互作用

MMFF对标准库仑形式进行了简单修正：

$$
E_{\text{elec}} = 332.0716 \frac{q_i q_j}{D(R_{ij} + \delta)^n} \quad (6)
$$

> 

其中$q_i$与$q_j$为原子$i$与$j$上的部分电荷，$R_{ij}$为核间距（单位：Å），$\delta = 0.05$ Å为静电缓冲常数，$D$为介电常数。与vdW相互作用类似，仅保留被三根及以上化学键隔开的原子对；出于第IV部分[^4]讨论的原因，1-4静电相互作用需乘以0.75的缩放因子。正值$\delta$提供的“距离缓冲”可防止带相反电荷的原子中心过于接近时，无限大的吸引静电能压倒方程(1)中有界（但较大）的repulsive vdW项。与方程(1)一样，这种形式的动机来源于相关研究中距离缓冲的使用。[^17,18]力场同时支持常数介电（$n = 1$）与距离相关介电（$n = 2$）模型；默认取$D = 1.0$、$n = 1$。与默认介电常数为1.5的MM2、MM3不同，MMFF94选择该值以便应用于凝聚相过程，特别是以水为显式溶剂的体系。

方程(6)中的部分原子电荷$q$由初始（通常为零）整数或分数形式电荷叠加键电荷增量$\omega_{KI}$得到，$\omega_{KI}$反映与原子$i$成键的相邻原子$k$所引起的键极性。具体写为：
$$
q_i = q_i^0 + \sum_k \omega_{KI} \quad (7)
$$

> Paper I, Eq.14

其中$q_i^0$为整数或分数形式电荷（如胍基氮上的+1/3），$\omega_{KI}$表示$i$–$k$键对原子$i$贡献的部分电荷（注意$\omega_{IK} = -\omega_{KI}$）。类似方法已在我们的前代力场MM2X[^18]中长期使用，但MMFF对某些原子$q_i^0$的指定更为精细。对于某些原子类型——目前指在主原子类型判定中被赋予负整数或负分数形式电荷的类型——会将初始形式电荷的一部分（如一半）转移（共享）给成键原子$k$。电荷共享在第V部分[^4]中讨论。

### 脂肪族体系中非键相互作用的参数化

本节阐述MMFF94如何针对含脂肪族氢的分子间相互作用进行参数化与验证，并展示MM2X、MM2、MM3及CHARMm（QUANTA 3.2版参数）再现MMFF94参数化所用从头算数据的程度。

#### MMFF94的参数化

我们通过拟合甲烷与氢分子二聚体的量子力学相互作用能量（随距离与取向变化）来确定脂肪族氢的vdW参数。与MM2、MM3一致，我们将连接脂肪族碳的氢原子的部分电荷设为零。针对甲烷二聚体，我们采用Scheiner等人[^19]计算的相互作用能量。他们针对文中图1所示六种取向A–F进行了计算，使用Sadlej的“中等极化”基组。[^20]该基组规模适中，$(10s, 6p, 4d/5s, 4p)$收缩为$[5s, 3p, 2d/3s, 2p]$，但含有足够弥散的极化函数，可获得高质量的相互作用能量。表I中标注为$ΔE^{(2)}$的相互作用能是他们使用Boys反均衡方法修正基组叠加误差后得到的二阶结果。[^21]

对于氢分子二聚体，我们计算了 Wiberg 和 Murcko[^22] 讨论的“交叉”($D_{2d}$)、“线性”($D_{\infty h}$)、“平行”($D_{2h}$) 和“T 形”($C_{2v}$) 取向的分子间相互作用能。我们采用 Sadlej 氢基组[^20]，并额外加设一组指数 0.075 的高斯 $d$ 函数，该指数值介于两个最弥散 $p$ 函数指数 0.1027 与 0.0324 之间。计算在 MP4(SDTQ) 水平[^23] 完成，使用 Gaussian 88 程序[^24]，$d$ 函数采用 5D 表示。每个二聚体由其取向和分离参数 $R_{\mathrm{HH}}$ 表征，$R_{\mathrm{HH}}$ 定义为不同 $\mathrm{H}_2$ 单体间氢原子的最短接触距离。与 Scheiner 的工作[^19] 一致，采用 Boys 反均衡方法[^21] 修正基组叠加误差，计算得到的相互作用能列于表 II。

在对 MMFF94 进行参数化时，我们使用已发表的脂肪族碳[^11]（MMFF 数值原子类型 1）vdW 参数，并调整氢原子（数值原子类型 5）的原子极化率 $\alpha_I$ 和缩放参数 $A_I$ [方程 (2)]，直至与计算得到的相互作用能良好吻合。最终取值为 $\alpha_I = 0.25\ \text{Å}^3$ 和 $A_I = 4.20\ \text{Å}^{1/4}$。$A_I$ 的数值与之前发表的 $\mathrm{H}$,He 值 $4.40\ \text{Å}^{1/4}$ 略有差异，并取代后者。这些参数给出 $\varepsilon_{IJ} = 0.0216\ \text{kcal/mol}$ 和 $R_{IJ}^* = 2.970\ \text{Å}$。该参数集用于所有连接碳的氢原子（即所有数值原子类型 5 的氢）。[^1] MM3 采用相似的势阱深度（$0.020\ \text{kcal/mol}$），但最小能量间距（定义为范德华半径的两倍）略大，为 $3.24\ \text{Å}$。[^6]

#### MMFF94、MM2X、MM2、MM3 与 CHARMm 的结果比较

表 I 与表 II 显示，MMFF94 参数对甲烷二聚体的从头算结果拟合较好，但对氢二聚体的描述虽尺度正确，却不够理想。就甲烷二聚体而言，仅 MM3 的相互作用能与 MMFF94 一样好；此外，MM3 在排斥性的“头对头”取向 F 上表现更佳，这得益于其氢原子向键内偏移，使 $\mathrm{C}-\mathrm{H}$ 键缩短、有效 $\mathrm{H}\cdots\mathrm{H}$ 接触距离增大。X 射线晶体学研究充分支持这种偏移：为使用球形原子最佳拟合分子电子密度，需将含氢键长缩短约 0.1 Å。类似的氢偏移无疑对 MMFF 也有帮助，但目前为保持计算速度暂未引入。

表 I 还表明，其他受测力场无一能与 MMFF94 或 MM3 媲美。QUANTA 3.2 版 CHARMm 参数在“头对头”取向 F 的短 $\mathrm{H}\cdots\mathrm{H}$ 接触处给出过度排斥，这与 LJ-12-6 势在短程行为不当[^25] 一致；有趣的是，同一参数在交错取向 A、B 的近距离处却排斥不足，导致势能最小区域相互作用能过负。MM2 势及其极相似的 MM2X 势表现亦差，两者均在 vdW 最小值区域过度稳定，此前对 MM2 的观察已指出此问题。[^6]

对氢二聚体，MM3 仍是最佳（表 II），尽管在吸引阱区域显得过度稳定（另一种解释是量子计算本身低估了阱深）。MMFF94 同样表现尚可。除线性构型外，表 II 所列取向均探测 $\mathrm{H}-\mathrm{H}$ 键中心附近的 vdW 性质，尤其突出 MM3 键缩短策略的效用。[^27] MM2X 在某些情况下再次过度稳定，MM2 与 CHARMm 亦有但较轻。所有情况下，$\varepsilon_{\mathrm{HH}}\sim$0.040 kcal/mol 的阱深均偏大；对 CHARMm 而言，最小能量间距 $R^*_{\mathrm{HH}}=2.66$ Å 也显过小。

### 氢键体系中范德华与静电相互作用的参数化

参数化所用的计算数据分为两部分：(1) 对423个HF/6-31G\*优化几何[^30]进行的HF/6-31G\*偶极矩计算[^28]，其中大多数我们还用Williams的PDM88方法[^31]拟合HF/6-31G\*分子静电势得到静电势拟合电荷；(2) 对图1所示66个HF/6-31G\*优化二聚体进行的HF/6-31G\*计算。已有报道指出HF/6-31G\*能良好描述氢键复合物。[^32]尽管这些计算未使用大基组或相关波函数，但应指出，即便采用大基组与相关方法，相互作用能与偶极矩也极难准确计算。Frisch等人[^33]对水二聚体及单体偶极矩的详尽研究在这方面既具启发性又令人警醒，Bartlett课题组[^34]为精确确定气相二聚化能所付出的努力亦同此理。此外，气相体系的精确数据效用有限，因为MMFF94采用有效对势，以平均方式体现分子极化率导致的高介电环境中分子偶极矩的增强。[^35]为考察理论模型选择对计算相互作用能的影响，我们还对HF/6-31G\*相互作用能做了基组叠加误差修正，并在HF/6-31G\*几何上进行了单点MP2/6-31+G\**计算。对少数体系，我们还在MP2/6-31G\*水平优化了几何。在某些情况下，我们发现相互作用能与几何存在明显差异（后文讨论），但无迹象表明基于这些更复杂计算模型的参数化会更优。

如下文小节详述，MMFF94的参数化分三阶段完成。第一阶段，我们通过拟合HF/6-31G\*偶极矩确定键电荷增量$\omega_{KI}$[方程(7)]。HF/6-31G\*模型通常把气相偶极矩高估10–20%，这恰好是以平均方式考虑高介电环境极性增强的有效对势所需。[^35]第二阶段，我们调整特定vdW与键电荷增量参数，以最佳再现经缩放的HF/6-31G\*相互作用能及氢键几何。拟合目标为：相互作用能绝对值比HF/6-31G\*结果大10–15%，氢键中杂原子间距缩短0.2–0.3 Å。MacKerell与Karplus[^36]最近采用了极为相似的方法，本工作亦以此为模板。这些调整也与Jorgensen课题组在OPLS参数化中发现的需求一致。[^37,38]第三阶段即最后阶段，我们通过以下方式实现自洽：先用缩放后的HF/6-31G\*偶极矩重新推导部分键电荷增量，再对二聚体的缩放HF/6-31G\*数据重新拟合。

#### 对HF/6-31G\*偶极矩的初始拟合

本次拟合使用Biosym联盟程序PROBE[^39]，针对覆盖MMFF94核心参数化全范围的423个分子构象，拟合HF/6-31G\*偶极矩分量$\mu_x$、$\mu_y$、$\mu_z$，从而确定键电荷增量参数$\omega_{KI}$。此法固有限制在于偶极矩并非“局域”量，因此某些$\omega_{KI}$的线性组合（从而部分原子电荷）可在几乎不增加最小二乘误差的情况下大幅变动。更优方案应是将$\omega_{KI}$同步拟合至同等规模的HF/6-31G\*静电势，但我们当时无此功能。为使偶极矩拟合可定解，我们通过以下方式固定部分电荷（通常为氢或其它端原子）对应的键电荷增量：

(a) 对于连接饱和碳的氢（数值原子类型分别为5与1），我们将氢电荷设为零，与MM2、MM3一致。其它方法（见后文“部分原子电荷确定方法比较”节）通常给出+0.15以内的非零脂肪族氢电荷，而Bader分析则得−0.05至−0.10的负电荷。[^40]我们在别处[^3]指出$q_H=0$的选择合理：若给这类氢赋予+0.05至+0.10的正电荷，所得MMFF扭转参数无法再现某些关键构象能模式。

(b) 对于连接烯烃或芳香碳的氢（氢为MMFF类型5，碳为类型2或37），我们把氢电荷固定为+0.115。该值能重现苯分子四极矩的迹，并适于再现苯二聚体边-面取向的偏好。[^41]OPLS中Jorgensen等人对芳香氢使用类似但略小的+0.115电荷。[^42]

(c) 由于取代环丁烷与环丁烯（碳的MMFF类型20与30）缺乏足够计算数据，我们将其键电荷增量设为对应无环体系的值。

(d) 对极性氢原子，我们将其键电荷增量固定在能反映HF/6-31G\*静电势拟合和/或Mulliken电荷趋势的数值。

在上述约束下，我们对HF/6-31G\*偶极矩进行最小二乘拟合。通常，所得键电荷增量的方差显示仍有少数情况未定解。此时，我们参照其它已确定参数或静电势拟合电荷的趋势，额外固定若干键电荷增量，再重复最小二乘。最终，未遇显著困难即获得定解拟合。

#### 对HF/6-31G\*分子间相互作用能与几何的初始拟合

除极性氢外，前述程序已为所有参与HF/6-31G\*二聚体体系的vdW与静电参数提供初值。为选择极性氢的vdW表示，我们寻找能尽可能再现广泛使用的SPC、[^43] TIP3P、[^43] TIP4P[^43]模型给出的孤立线性水二聚体性质的参数。这些有效对势模型已被证明能较好地再现液态水的性质，均给出O$\cdots$O距离约2.75 Å、相互作用能约$-6.4\ \text{kcal/mol}$。[^43]与HF/6-31G\*气相值（2.97 Å与$-5.62\ \text{kcal/mol}$）对比可见，HF/6-31G\*结果需调整：杂原子距离缩短，相互作用能绝对值增大。随后，我们将所得羟基氢表示推广至所有极性氢。

为在MMFF中再现SPC、TIP3P与TIP4P水模型的行为，我们需给羟基氢指定较小的原子极化率$\alpha_I$，并调整对应的$A_I$与$N_I$参数[见方程(2)与(5)]。出于前述原因，我们对含极性氢的vdW相互作用亦采用简单算术平均组合规则。所得$\alpha_I$值使水中羟基氢的最小能量间距$R^*_H = 1.6\ \text{Å}$（vdW半径0.8 Å），约为脂肪族氢的一半。鉴于极性氢周围电子密度降低，且其键缩短需求应比MM2、MM3对脂肪族氢的更大，[^44] 此对比并非不合理。另一方面，势阱深度$\varepsilon_{II}$与脂肪族氢相近，约$0.02\ \text{kcal/mol}$。

与MMFF94相反，OPLS、[^45] AMBER、[^7] 及CVFF[^8] 均对极性氢使用零（或近似零）vdW半径与势阱深度，SPC、TIP3P、TIP4P水模型亦然。[^43] 这些做法通过增大所连杂原子的vdW半径进行补偿，然而这使极性氢对电中性原子“不可见”。计算证据表明情况并非如此。以HF与Ne的线性H–F$\cdots$Ne与F–H$\cdots$Ne二聚体为例，O'Neil等的大基组CEPA计算[^46]显示，F–H$\cdots$Ne在势能最小处的F$\cdots$Ne距离（3.31 Å）大于H–F$\cdots$Ne（3.15 Å），这表明H–F中强极性氢具有有限的vdW尺寸。此外，F–H$\cdots$Ne比H–F$\cdots$Ne更稳定。我们有理由相信，这种额外稳定性源于H–F在氢端附近的电场强于氟端；更强的静电场使F–H$\cdots$Ne与Ne的诱导偶极（极化）相互作用更强，从而更显著地缩短平衡F$\cdots$Ne距离。因此，若无诱导偶极吸引，F–H$\cdots$Ne中的F$\cdots$Ne距离将比CEPA所得的0.16 Å差值更大。

除给H–F中的氢赋予非零vdW半径外，我们无法解释这一定性差异。然而，理论计算并不意味着极性氢半径为0.16 Å。鉴于氟的vdW半径约1.5 Å，H–F键长约1 Å，若氢vdW半径小于约0.5 Å，则实际上会被氟的半径掩盖。因此，HF中氢的真实vdW半径应略大于0.5 Å。氨或水与氩二聚体中交换排斥相互作用的各向异性[^47]以及我们对线性H–F$\cdots$He与F–H$\cdots$He二聚体的计算[^48]（发现后者在过零点与vdW最小处的F$\cdots$He距离均大0.25 Å）也为极性氢具有显著vdW半径的结论提供了额外计算支持。

关键vdW与静电参数的调整通过迭代完成。每一步都用当前非键参数估计值优化HF/6-31G\*二聚体，然后列表比较优化后的HF/6-31G\*与MMFF结合能、X⋯Z与H⋯Z距离及X–H⋯Z角（X–H为氢键给体，Z为杂原子受体）。如前所述，我们尽可能把X⋯Z距离调得比HF/6-31G\*值短0.2–0.3 Å。这些距离主要受最小能量间距$R_{IJ}^*$控制，因而受原子极化率$\alpha_I$影响[见方程(2)]；故当MMFF距离过大时，我们减小$\alpha_Z$和/或$\alpha_X$。相反，计算结合能主要取决于相互作用原子的部分电荷，因而与相关键电荷增量关联；当MMFF结合能绝对值相对于缩放HF/6-31G\*值过小时，我们调整H–X键或X、Z的其它键的键电荷增量以增强静电相互作用。例如，对给体水与受体吡啶氮的相互作用，我们调节了吡啶C–N键的极性。此过程约需十余次迭代；最终参数可能部分反映初值，但应无过度影响，拟合从头算数据的质量后文讨论。

#### 自洽迭代

除修正部分vdW参数外，上述对HF/6-31G\*相互作用能与几何的拟合还增大了许多氢键基团的键电荷增量。为使极性增强“系统化”，我们检查了所得MMFF偶极矩对先前423个结构的缩放HF/6-31G\*偶极矩的拟合情况，发现当后者放大约10%时拟合最佳。于是，我们将HF/6-31G\*偶极矩乘以1.1后重新拟合键电荷增量；为保留对二聚体数据的调整，我们把二聚体拟合中优化的键电荷增量加入约束集。随后，以重新推导的键电荷增量为新初值，再次拟合二聚体数据。此次调整对vdW参数或键电荷增量几乎无需进一步改动，表明已获得一套基本自洽的非键参数。

#### 金属及其它离子的参数

如别处所述，[^4]我们还获得了Zn$^{2+}$、Ca$^{2+}$、Mg$^{2+}$、Cu$^{2+}$、Cu$^+$、Fe$^{2+}$、Fe$^{3+}$等蛋白相关金属离子，以及水合氢离子、氢氧根离子和多种卤素、碱金属离子的初步参数。[^4]

#### MMFF94 范德华与静电参数

本节给出 MMFF94 非键参数的子集。完整参数集（包括第 V 部分[^4]描述的扩展 MMFF 参数化中定义的参数）约含 500 个键电荷增量，篇幅过大，此处无法全部列出；完整集合以计算机可读形式作为补充材料提供。[^49] 对应的 MM2X 参数已发表于前文补充材料。[^50] 表 III 和表 IV 列出的参数涉及以下 MMFF 数值原子类型：1、2、3、5、7、10、28、31、70。前七种依次对应饱和碳、烯碳、羰基碳、连碳氢、羰基氧、酰胺氮及酰胺氢；最后两种用于水中的氢与氧。因此，这些类型涵盖烷烃、烯烃、醛、酮、酰胺以及水。

表 III 列出 vdW 参数。第 1 列为 MMFF 数值原子类型，第 2 列为对应原子极化率 $\alpha_I$（单位 $\text{Å}^3$）。注意，第 3–5 列的有效电子数 $N_I$ 及缩放因子 $A_I$、$G_I$ 通常仅依赖于相互作用原子 $i$、$j$ 的元素种类，而非完整 MMFF 数值类型。第 6 列“D/A”标注该类型是否为氢键给体（D）、受体（A）或皆非（-）。如前所述，涉及给体/受体的 vdW 相互作用有特殊处理。为便于阅读，第 7 列给出代表性 MMFF 符号原子类型；同一数值类型常对应多个符号类型，符号首字母均表示元素。第 8 列说明参数来源：“C94”表示本文计算数据拟合所得，“E94”表示取自先前研究，[^11] 完整参数文件中“X94”与“#X94”表示第 V 部分扩展参数化所得。[^4]

方程 (7) 使用的键电荷增量参数列于表 IV。$BT_{IK}$ 为第 I 部分[^1]描述的“键类型索引”。注意“0 1 2”行表示在“1–2”C–C 键中，类型“2”的烯碳从键极性获得 $-0.1382$ 电荷，而类型“1”的烷碳获得等量反号电荷 $+0.1382$。因此，每个键电荷增量对应于对第二个列出原子（总是 MMFF 原子类型较高者）的电荷贡献。参数文件按整数规范索引排序：
$$
\text{CXQ} = \text{MC} \times (\text{I} \times \text{MA} + \text{K}) + \text{BT}_{IK}
$$
其中 MC 为不小于最大键类型索引 +1 的整数，MA 为最大数值原子类型索引 +1 的整数，且原子类型 I ≤ K。“Origin/comment”列中“#C94”标识的核心 MMFF94 键电荷增量被纳入最终约束集；“C94”表示该拟合所得。完整文件还包含标为“X94”、“#X94”及“E94”的参数。[^4]

OPTIMOL/MMFF 计算中使用刚性酶“活性位点”作为“环境分子”的相关非键参数见附录 A（补充材料）。[^51]

### 部分原子电荷确定方法的比较

本节将键电荷增量法与确定部分原子电荷的其它方法进行比较。

#### 键电荷增量法

键电荷增量法的主要优点是使MMFF94可直接应用于广泛化学结构。这一特性在药物化学环境中尤其重要：即使所有参数齐备，计算化学家也难以跟上快速演变的药物化学项目所涌现的大量想法与结构。幸运的是，该方法还能较好地再现构象能与分子间相互作用能（见下一节）。诚然，它过于简化——仅举一例：某类化学键的极性被当作常数，而实际上极性可显著依赖于化学环境；例如，CF4中的单个C–F键因碳供电子能力“饱和”效应而比CH3F中的对应键极性低得多。尽管如此，键电荷增量法仍足以通过通用性与准确性的检验，满足当前目的。任何适用于MMFF类力场的替代方法也必须具备同样能力。

#### OPLS方法

Jorgensen等已为众多常见有机官能团导出OPLS非键势。[^37,38,42]表V将OPLS对20个小分子与离子的电荷与MMFF94及其它电荷集进行比较。前13个分子取自Carlson等[^53]研究Mulliken与ESP电荷再现水合绝对与差分自由能的能力。为增加结构多样性并引入离子物种，我们又加入7个体系。注意OPLS通常使用联合原子模型，仅在苯与苯胺（在所考虑案例中）显式处理碳上氢；除吡啶与咪唑外，与MMFF的对应不受影响，因MMFF94对脂肪族氢赋予零电荷。

尽管推导MMFF94时未参考OPLS电荷，比较表明两套电荷通常行为非常相似。特别地，不带电分子中极性氢的电荷以及与sp3碳相连的负电元素或基团的电荷差异通常≤0.05。CH3SH差异较大：OPLS给极性氢+0.27，MMFF94给+0.18，这突出MMFF与OPLS的一个核心区别。OPLS部分参数来自纯液体模拟，部分通过拟合实验水合焓或模仿HF/6-31G\*二聚体气相能量与几何获得；相反，MMFF94所有核心非键参数均在统一框架下以HF/6-31G\*数据为基准共同导出。

两种电荷集在咪唑和甲基铵阳离子上差异最显著。对咪唑，OPLS给N1电荷−0.57，MMFF94给+0.033；N1上氢电荷OPLS为+0.42，MMFF94仅+0.27。需指出，N1为“吡咯型”氮，向芳环提供一对π电子，在表达芳香离域的Kekulé结构中形式带正电；而N3及三个碳在某一共振结构中形式带负电。因此，N1至少应比N3负电荷更少。MMFF94与ESP电荷（表V）符合此顺序，而OPLS电荷（详细来源未述）则不符合。

对甲基铵，MMFF94电荷集对氮键极化更强，因此下节（第三小节）比较中CH3NH3+⋯OH2二聚化能MMFF94比OPLS更负。MMFF假设N–H键电荷增量为0.45，因为我们认为连接阳离子氮的氢不应比连接中性氮的氢正电荷更少。MMFF94对咪唑鎓阳离子酸性氢也用+0.45，OPLS在此例给出相近+0.46。如前所述，MMFF94极性氢电荷选自ESP电荷趋势，或在ESP无助时（如甲基铵）参考Mulliken电荷。供参考，HF/6-31G\* Mulliken极性氢电荷：甲醇0.437、甲胺0.332、甲硫醇0.090、乙酰胺−0.39、乙酸0.468、苯胺0.359、咪唑0.399、水0.434、甲基铵0.472、咪唑鎓0.471。

#### 静电势（ESP）电荷

该方法使用拟合量子力学计算分子静电势得到的电荷，算法在静电势采样方式及最小二乘准则定义上各异。[^31,52–54]即使使用相同量子力学波函数（常为HF/6-31G\*），不同算法也会给出不同电荷集，故读者需注意：基于某一ESP电荷集的对比与结论未必适用于另一电荷集。

表V所列ESP电荷由Gaussian 92中实现的CHELPG程序[^54]基于HF/6-31G\*波函数获得，与Carlson等[^53]的HF/6-31G\* CHELPG电荷接近，差异源于我们使用HF/6-31G\*优化几何而非标准几何。为简化，我们对单键旋转等价的氢取平均电荷，如Carlson等所做，且分子力学/动力学计算必须按对称性如此处理。但Bayly等[^55]指出，这种事后平均需谨慎，因其可显著改变分子偶极矩和计算分子间相互作用强度。对其详细研究的*trans*-N-甲基乙酰胺和甲醇，平均后偶极矩升高约10%。另需警惕，我们发现偶极矩变化并不一致：*trans*-N-甲基乙酰胺的CHELPG[^54]与Besler-Merz-Kollman[^57]甲基电荷平均后偶极矩增加，而*cis*-N-甲基乙酰胺偶极矩不变甚至略降。虽仅差零点几德拜，却改变*cis*/*trans*偶极矩关系，可能影响相对水合自由能。

总体上看，CHELPG 电荷与 MMFF94 及 OPLS 电荷相近。一个定性差异是：对 CHELPG 集，连接 sp3 杂化碳的氢原子通常带有可观正电荷，约 +0.1。正如我们在论证 MMFF 将这类氢电荷设为零时所指出的，如此大小的正电荷会使 MMFF94 无法再现某些关键构象能。[^3]

Carlson 等[^53] 发现，他们的 CHELPG 电荷与 OPLS Lennard-Jones 参数联用，在大多数情况下可给出合理的绝对与相对水合自由能。然而他们也指出，CHELPG 电荷用于 TIP4P 水模拟乙酰胺时，水合自由能比实验约负 4 kcal/mol。此外，对水分子向羰基氧顺式 ($-10.17\ \text{kcal/mol}$) 或反式 ($-8.75\ \text{kcal/mol}$)  donating 氢键的二聚体，CHELPG 电荷给出的相互作用能比 OPLS 显著更负；OPLS 对应值分别为 $-9.30$ 与 $-6.67\ \text{kcal/mol}$。虽然 MMFF 与 CHELPG 都给羰基氧更大的负电荷 ($-0.57$ 与 $-0.637$，OPLS 为 $-0.50$)，但 MMFF94 极化明显较弱。我们发现 MMFF94 对顺、反二聚体的相互作用能分别为 $-9.14$ 与 $-7.18\ \text{kcal/mol}$，[^35] 与 OPLS 非常接近，提示 MMFF94 电荷在分子模拟中可能给出良好结果。相反，CHELPG 电荷遇到的困难恰恰说明：ESP 电荷拟合过程并未考虑分子间相互作用能或构象能，因此前者未必准确，也未必与已确定的扭转参数兼容。

另一担忧是 ESP 方法对我们的目标而言通用性不足：每遇新化学体系都需预先进行量子力学计算以获得所需部分原子电荷；而目前尚无涵盖多样化学片段的广泛 ESP 电荷库，也缺乏将这些片段稳健组合的算法。相关问题是 ESP 电荷对“内部”（或“埋藏”）电荷中心常难以确定。[^58,59] 例如，Williams[^58] 对丙氨酰二肽观察到 ESP 电荷随构象变化高达 0.76 e，Stouch 与 Williams[^59] 对甘油磷酰胆碱亦发现变化达 1.32 e。这种“飘忽”特性可能阻碍可转移性，并限制理论上从片段库组装复杂分子 ESP 电荷的精度。

#### 电荷／电负性均衡方法

已有多篇报道利用电荷或电负性均衡方法，包括Gasteiger[^60]、Mortier等[^61]、Mullay[^62]及Rappé与Goddard[^63]的方法。它们均基于原子（而非原子对）属性计算电荷，因此应能轻松通过通用性测试；且所得电荷比键增量法更完整地依赖于化学拓扑，部分方法还让电荷依赖于分子构象。遗憾的是，按现有参数化，这些方法给出的电荷与MMFF94所需电荷差异显著。例如，表V所列Gasteiger PEOE极性氢电荷[^60]通常仅为MMFF94、OPLS与CHELPG的一半，提示其分子间相互作用能将过小而不理想。

QEq（Rappé-Goddard）极性氢电荷[^63,64]亦比MMFF94与OPLS偏小；相反，CH3Cl中氯的QEq电荷（−0.43）似乎过大。更严重的是，脂肪族氢的正电荷往往远超MMFF94可接受范围。[^3] 另一问题是，经单键旋转等价的氢原子可得到差异显著的QEq电荷：例如甲醇CH3中，旁式（对羟基）与反式氢电荷分别为0.138与0.189。如前所述，要么对这些不等价电荷取平均（如表V所用），要么在模拟中频繁重算；但后者需电荷对核坐标解析导数易求，而表述这些导数并不简单。[^66]

诚然，QEq电荷对构象的依赖性可能是一项重要属性。Jorgensen与Gao的经典研究[^67]有力证明，OPLS酰胺基团电荷在*cis*→*trans*-N-甲基乙酰胺（NMA）时必须显著变化，才能解释实验上两种构象水合自由能几乎相等的意外结果；固定电荷模型会预期*trans*偶极更大、溶剂化更强。然而，原子电荷随构象的变化必须幅度与方向均正确才有益；对经典动机的Mortier与Rappé-Goddard方法，并无保证其能如此表现。对NMA，QEq电荷似乎未能满足：使用MP2/6-31G\*优化几何，QEq给出*trans*与*cis*偶极分别为2.80与3.90 D，[^65]而MMFF94对同一几何为4.44与4.55 D，MMFF优化几何则为4.31与4.46 D；作为参考，HF/6-31G\*计算对HF/6-31G\*优化几何为3.99与4.18 D，经调整的Jorgensen-Gao OPLS电荷为3.85与4.03 D。因此，QEq虽正确给出*cis*偶极更大，但大幅高估差值；相反，MMFF94固定电荷模型不仅再现从头算顺序，且给出合理的绝对与相对偶极值，而未修改的OPLS电荷则不能满足这些判据。

表V对乙酸根与甲基铵离子的QEq电荷同(CH2)6桥联铵-羧酸两性离子电荷的比较揭示了一个关键局限。具体而言，QEq给出的CO2(−)与NH3(+)基团电荷在分离离子中分别为−0.684与+0.326，但在两性离子中却为−0.279与−0.092；甲基铵中NH3(+)电荷和两性离子中CO2(−)电荷本已偏小，而两性离子中NH3(+)基团带负电荷显然不合理。显然，端基电荷不适当地泄漏到本应起缓冲作用的饱和六亚甲基链中。这一行为暴露了QEq方法的根本缺陷：它只是把两性离子当作中性体系处理，未能认识到其由基本隔离的离子子系统组成；同一问题自然适用于含带电残基的蛋白质，并会导致当远端残基电离状态改变时电荷显著变化。

最后，我们考虑Mortier[^61]与Mullay[^62]方法。前者采用电负性均衡，电荷依赖于连接性与几何；后者均衡“键电负性”，电荷仅依赖于连接性。两者似乎均按再现STO-3G电荷参数化，对丙氨酰二肽羰基氧给出的电荷大小仅约为MMFF94的一半。有趣的是，与QEq不同，Mullay方法能正确处理两性离子。然而，已发表电荷表明，这些方法（以及本节讨论的其它方法）在现有参数化下，均无法在MMFF类力场中给出有用的分子间相互作用能。

#### 其它方法

最后，我们简要提及 Del Re[^68] 与 Abraham 等[^69] 的方法。前者采用准量子力学途径，后者对扩展 π 体系引入显式量子组分。为比较，表 V 列出 Abraham 电荷，大多取自最新 “CHARGE2” 参数化。[^69b] 这些电荷与 MMFF94 及 OPLS 电荷相关良好，但大小通常仅约一半；若用于经验力场计算，如此缩小的电荷会严重低估静电相互作用。对 Del Re 方法，Rappé 与 Goddard[^63] 的比较显示，羰基氧通常被赋予约 −0.10 的电荷，这对我们的目标毫无用处。

#### 讨论

本节结束前，我们指出需区分：（1）在原型体系参数化力场时确定的电荷；（2）一般应用中电荷计算/组装程序产生的电荷。对某些方法，这一区分至关重要。若直接参数化某方法以再现相互作用能不现实，可先通过拟合相互作用能数据确定一套目标电荷，再参数化该方法以再现目标电荷。目标电荷可来自 MMFF94、OPLS 或其它合适参数化。然而，若再现相互作用能所需电荷由量子力学因素决定，则仅基于原子性质的纯经典方案可能灵活性不足；[^70] 相反，像 MMFF 那样基于键性质的方案，虽需更多参数，却固有更大灵活性，并可能达到更高精度。

### MMFF94 及其他力场的性能表现

#### 偶极矩

MMFF94 用于参数化的 423 个分子物种/构象的部分原子电荷对缩放后的 HF/6-31G\* 分子偶极矩（单位：德拜）的再现误差如下：[^71]

|            | MMFF94      | MM2          |
| ---------- | ----------- | ------------ |
| 偶极矩大小 | $0.39D$     | $0.64 D$     |
| 偶极矩方向 | $5.5^\circ$ | $10.8^\circ$ |

在上述比较中，使用 HF/6-31G\* 几何，并将从头算偶极矩乘以拟合过程中采用的 1.10 缩放因子（前已讨论）。表中同时列出对 398 个 MM2X 构象、使用同样缩放 HF/6-31G\* 偶极矩所得结果。[^18] 缩放后 HF/6-31G\* 偶极矩的 rms 值为 3.42 D，故 MMFF94 平均误差约 11%，MM2X 约 19%。尽管已属不错，MMFF94 的偶极大小误差仍偏大，静电相互作用的处理是亟需改进的领域之一。

#### 分子间相互作用能与几何

表 VI 总结了 MMFF94 再现其参数化所用 HF/6-31G\* 数据趋势的能力（模型 1）。最左列给出所考察二聚体；除环状二聚体外，先列给体，后列受体。第 2–4 列比较 HF/6-31G\* 与 MMFF94 结合能（kcal/mol）；第 5–7 列比较所列氢键中杂原子距离 X$\cdots$Z（Å）；其余列比较 H$\cdots$Z 距离、X–H$\cdots$Z 角（度）并给出相关 MMFF 原子类型。结合图 1 所示仔细绘制的结构，这些信息足以表征 HF/6-31G\* 几何。除环状氨二聚体（32，C2h 对称）与堆叠 trans-N-甲基乙酰胺二聚体（27）外，每个二聚体及其单体均从头算和 MMFF94 下完全优化。对这两个体系，MMFF94 给出具一个虚频的鞍点结构。前者在 HF/6-31G\* 水平下 C2h 环状二聚体为极小，"线性" Cs 二聚体（33）为鞍点；[^73] 但在包括 HF/6-31+G\* 在内的更高水平，[^73] 线性二聚体成为稳定结构，与 MMFF94 结果一致。堆叠 trans-N-甲基乙酰胺二聚体在 HF/6-31G\* 面上是否为极小尚不清楚，但应注意从头算能量极小化未完成，且两X$\cdots$Z距离已略有差异。

为与模型1比较，表VII列出另两种理论模型（模型2与3）的二聚化能，均使用表VI的HF/6-31G\*优化几何。模型2采用单点MP2/6-31+G\**波函数，模型3仍用HF/6-31G\*波函数但加入标准基组叠加误差(BSSE)修正。[^21]该修正给出$ΔE_{A-B}$为：
$$
\Delta E_{\text{A-B}} = E_{\text{A-B}} - E_{\text{A}} - E_{\text{B}}
$$
其中对完整体系AB及子体系A、B的计算均使用同一AB二聚体基组。表VIII还列出少量经几何优化MP2/DZP计算[^75]（模型4）得到的二聚体能与几何。对四种模型，均可通过以下方式生成“目标”二聚化能：统一缩放相互作用能，使线性水二聚体（1）能量为−6.5 kcal/mol；[^43]并统一调整从头算X⋯Z距离，使水二聚体O⋯O距缩短至2.75 Å。具体而言，相互作用能需分别增强−15.5%、−5.6%、+3.8%、+3.1%；杂原子距离前三种（均用HF/6-31G\*优化几何）需缩短−0.20 Å，第四种−0.15 Å。可见，经BSSE修正的HF/6-31G\*集给出最小二聚化能，需最大增幅；反之，MP2模型需最小增幅。MP2模型既增加真实相关稳定，又引入基组叠加误差，对水二聚体至少6-31G\*基下后者大于无相关计算。[^33]四种模型共同提供了拟再现二聚化能的不确定度背景，并用于评估MMFF再现表VI HF/6-31G\*趋势的任何局限。

四套目标相互作用能（未列出）在多数情况下吻合良好（如±0.5 kcal/mol），但存在显著例外。特别是BSSE修正集对强结合二聚体给出一致更负的缩放相互作用能，对阳离子⋯水二聚体（60–65）通常负3–4 kcal/mol；该集还给环状水二聚体（2）最小缩放能，并给大多数含二价硫二聚体更小作用能。相反，MP2模型对强结合二聚体给出略不负的缩放能，但对环状水二聚体及二价硫二聚体通常更负。 notably，MP2/DZP对HOH⋯S(CH3)2二聚体（47）给出缩放值−6.09 kcal/mol，幅度显然过大；当涉及第二周期原子时，相关对基组叠加误差可能异常增大。MP2/6-31+G\**对堆叠*trans*-N-甲基乙酰胺二聚体（27）的缩放二聚化能为−7.10 kcal/mol，几近HF/6-31G\*缩放值两倍。该变化可能部分源于基组叠加误差，尽管堆叠构型因HF模型忽略的London色散应有一定稳定化。综上，MP2类模型（2与4）存在严重困难；模型3（BSSE修正HF/6-31G\*）虽大多合理，但并不优于模型1（简单HF/6-31G\*）。因此，我们采用四种模型中最简单的模型1进行MMFF94参数化。

现在转向表 VI 所列 MMFF94 与 HF/6-31G\* 结果的比较。显然，MMFF94 结果与从头算计算高度相关。定量上看，66 个列出的相互作用能中有 63 个 MMFF94 值比 HF/6-31G\* 更负，且往往达到期望的 10–15%。总体而言，平均相互作用能 HF/6-31G\* 为 −7.23 kcal/mol，MMFF94 为 −8.04 kcal/mol，绝对值大 11%。HF/6-31G\* 计算（并得到普遍化学知识支持）所暗示的许多给体/受体能力比较均被 MMFF94 正确再现。例如，MMFF94 正确识别苯基与乙烯醇是比水、脂肪醇和醚（1, 3–6）更强的氢键给体（7, 9），却是更弱的受体（8, 10），并指出呋喃（11）是更弱的受体。同样，MMFF94 正确评定氨作为受体（34）强于作为给体（59），并准确判断乙烯胺与苯胺是比氨更强的给体（44, 45）。此外，MMFF94 与 HF/6-31G\* 对咪唑、吲哚、吡咯、吡啶等杂芳胺的强度评估（36–40）高度一致，也正确指定硫醇与硫醚（46–52）作为给体和受体均较弱。与 HF/6-31G\* 相比，定性误差仅出现在少数情况——例如环状甲酰胺（24）和水-甲酸甲酯弱结合二聚体（19），MMFF94 相互作用能比 HF/6-31G\* 约少负 1 kcal/mol；由于模型 2–4 在这些情况下也预测更负的结合能，提示 MMFF94 结果有误。

两个最大的定量差异出现在环状水二聚体（2）和堆叠 *trans*-N-甲基乙酰胺二聚体（27）：MMFF94 能量比 HF/6-31G\* 模型显著更负。然而，如前所述，MP2 模型也给出更负的结合能，表明 MMFF94 结果并非不合理。

表 VI 中 X$\cdots$Z 杂原子距离的比较显示，大多数 MMFF94 距离比 HF/6-31G\* 值短 0.2–0.3 Å，符合预期。仅在 *C*2*h* 环状水二聚体（2）的两个等价 O$\cdots$O 相互作用中，MMFF94 距离略长，且程度极小；此时 MMFF94 距离甚至短于 MP2/DZP 优化几何（表 VIII），提示缺陷可能在于 HF/6-31G\* 模型而非 MMFF94。总体上看，所列杂原子距离平均值为 HF/6-31G\* 3.105 Å，MMFF94 2.896 Å，相差 0.209 Å。最大不规则出现在含硫弱结合二聚体：例如，HF/6-31G\* 水-二甲基硫醚二聚体（47）的 O$\cdots$S 距离比水-硫化氢二聚体（52）短近 0.4 Å；MMFF94 定性再现此趋势，但变化幅度小得多——更高级别的 MP2/DZP 从头算优化（表 VIII）亦如此。

氢键角度再现良好，但仍存在一些显著差异，其中少数似乎反映 HF/6-31G\* 模型的局限而非 MMFF 缺陷。一例为 H2O 与 *cis,cis*-草酸二聚体（15）中列出的第二个 O–H$\cdots$O 相互作用：MMFF94 H$\cdots$O 距离过长、O–H$\cdots$O 角过小，均表明力场与从头算几何存在定性差异。另一例为水-二甲基硫醚二聚体（47）：HF/6-31G\* 给出分叉结构，而 MMFF94 给出单一、基本线性的 O–H$\cdots$S 氢键；此时 MP2/DZP 模型亦给出单一但更强扭曲的 O–H$\cdots$S 氢键（表 VIII）。第三例（表 VI 未显）为氨二聚体：如前所述，环状 *C*2*h* 结构（32）在 HF/6-31G\* 面上为极小，而在 MMFF94 及多种更高级从头算中则为鞍点；[^73,74]例如 MP2/DZP 模型与 MMFF94 均偏爱线性 $C_s$ 二聚体（33）。

我们还检验了MM2X力场[^18]以及更早版本的MMFF（称为“MMFF91”）再现这些二聚体数据的能力。发现MM2X表现亦佳：约半数MM2X相互作用能比未调整的HF/6-31G\*值更负，除一个外所有MM2X X⋯Z距离均更短。除环状水二聚体（误差−5.45 kcal/mol）和堆叠trans-N-甲基乙酰胺二聚体（误差−7.58 kcal/mol）外，MM2X与HF/6-31G\*二聚体能差从未超过约2 kcal/mol。然而，MM2X相互作用能总体上并未显示出我们在开发MMFF94时所针对的、相对于HF/6-31G\*值的增强。与MMFF94推导方法相反，MMFF91力场的静电参数（键电荷增量）仅通过前述方法拟合（未缩放）HF/6-31G\*偶极矩获得，非氢原子则使用先前发表的vdW参数。[^11]该力场误差远大于MMFF94或MM2X：66个二聚体中仅13个能量比（未调整）HF/6-31G\*更负，X⋯Z距离缩短者仅约四分之三；还发现一些大误差，其中4例MMFF91相互作用能比从头算值正4–6 kcal/mol。与MMFF94的对比表明，必须进行显式参数化才能获得目前总体良好的结果。

#### 与OPLS的比较

表IX比较了表VI中22个二聚体的MMFF94与OPLS结果。对线性H2O二聚体（1），列出TIP3P结果，因该常用模型与“MMFF”水构造相似；其余大多列出TIP4P模型结果。对比显示，两组在多数情况下给出相似的结合能与杂原子距离。对咪唑-水二聚体（36, 37），无论咪唑作为给体还是受体，MMFF94均给出显著更负的结合能。然而，我们完全优化的HF/6-31G\*计算给出理论结合能分别为−6.56与−7.06 kcal/mol，而OPLS推导时使用的部分HF/6-31G\*优化仅得−6.24与−6.24 kcal/mol。[^42]此外，MMFF94有意加深HF/6-31G\*结合能，而OPLS此处再现的是其推导所用的未调整（且未优化）能量。

对含二价硫二聚体（46, 47, 51, 52），OPLS给出更负结合能与更短杂原子距离，这与前述OPLS S–H键极性更大一致。OPLS杂原子距离亦比优化MP2/DZP距离（表VIII）短得多，提示其值可能过短。另一方面，MP2/6-31+G\**（表VII）尤其是MP2/DZP对这些二聚体的结合能更负，通常与OPLS吻合优于MMFF94或HF/6-31G\*；然而，这种更好吻合可能源于相关增强的基组叠加误差，属人为现象。我们注意到，经BSSE修正的HF/6-31G\*相互作用能显著不负，与OPLS吻合度低于MMFF94。因此，尽管OPLS参数已被发现能良好描述纯液体，但OPLS与MMFF表示何者更适用于水溶液模拟，仍有不确定性。

最后，我们指出，对水与甲基铵、[^77]胍基、[^45]咪唑鎓、[^45]乙酸根离子（60–62与66）的二聚体，MMFF94给出比OPLS更负的结合能。对这些体系，OPLS二聚化能均比表VI所列HF/6-31G\*值不负；相反，MMFF94能值均更负，平均约多5%。有意地，这些MMFF94增强幅度小于中性二聚体所寻求的值；我们推测，周围水分子诱导的额外极化对离子-水二聚体应较不重要，因为气相二聚体中强电场已诱导可观极化。Jorgensen等在开发OPLS时更进一步：他们将离子-水二聚化能设得比其HF/6-31G\*计算值更不负，认为从头算值高估气相二聚化能。[^77]然而，气相能量是否为应模仿的量尚不清楚；Bartlett对水-水二聚体约−4.7 kcal/mol的气相值[^34]显然不应被效仿。我们注意到，OPLS据报道能给出甲基铵与乙酸根离子等合理的水合热，[^77]因此MMFF94可能会高估这些量。需进行显式模拟以确定是否必须对带电体系重新参数化MMFF94。

#### 总结与讨论

默克分子力场（MMFF94）采用新颖的“Buf-14-7”形式描述范德华相互作用，并使用同样带缓冲的库仑项处理静电相互作用；后者通过简单易行的“键电荷增量”构建部分原子电荷，既保证通用性，又能良好描述广泛化学结构与相互作用。非键参数通过对甲烷、氢二聚体高质量从头算二聚化能显式参数化，并借助HF/6-31G\*计算，拟合缩放偶极矩及缩放HF/6-31G\*氢键二聚体分子间相互作用能与几何获得。所得参数能很好再现计算相互作用能与几何的数值与趋势。MMFF94对HF/6-31G\*数据的统一参数化旨在确保水溶液模拟中溶剂-溶剂、溶剂-溶质、溶质-溶质相互作用间取得恰当平衡；MacKerell、Wiorkiewicz-Kuczera与Karplus已强调，[^36]此平衡对凝聚相模拟获得可靠结果至关重要。

我们的方法与Jorgensen等开发OPLS的途径有相似之处。[^37,38,42] 他们同样使用HF/6-31G\*数据，尤其在缺乏实验凝聚相数据时；事实上，我们的许多氢键二聚体即源自他们描述的体系。我们的方法更与MacKerell、Wiorkiewicz-Kuczera与Karplus[^36]相似，他们在CHARMM新参数化中也采用了类似缩放的HF/6-31G\*数据。令人鼓舞的是，MMFF94与广泛使用的TIP3P、SPC水模型对孤立水二聚体的描述非常一致；此外，MMFF94与OPLS通常给出相似的电荷分布，并对氢键二聚体给出相似结果。鉴于OPLS在模拟应用中的成功，我们相信这种密切对应为MMFF94的前景提供了良好预兆。

另一方面，我们的方法与Hagler等推导Biosym联盟力场CFF93的途径差异显著。[^78] 与MMFF94一样，该联盟力场也由键电荷增量构建部分原子电荷；但在许多情况下，Biosym方法显然通过拟合晶体数据获得大量静电与vdW参数。此法最易用于烃、羧酸与酰胺——这些官能团晶体结构多且已测升华热。[^78] 即便在此，仍需关注：将能量极小化力场结构拟合至热平均晶体结构忽略了可能不可忽略的温度效应。MacKerell、Wiorkiewicz-Kuczera与Karplus[^36]在核酸碱基对理论研究中发现，当能量极小化（0 K）晶体在分子动力学模拟中升温至室温时，氢键长度通常增加约0.1 Å。Coppens等的中子衍射研究也定性一致：α-草酸二水合物晶体氢键长度在100 K至室温升温中增加0.04–0.06 Å；[^79,80] 100 K[^79]与299 K[^80] X射线测定显示单胞体积同步增大约4%。需进一步研究以确定CFF93在室温和1 atm模拟中预测氢键距离与晶体体积的准确度。[^81]

Biosym联盟方法的另一担忧是：对大多数官能团，相关晶体结构的升华热极少甚至缺失。此时应采取何种途径尚不清楚，因为仅凭晶体几何拟合导出非键能参数似不明智。一种可能途径是从二聚体量子计算获得非键参数；[^82] 另一种可能是采用近期聚碳酸酯所述程序：[^83] 因无升华热，仅通过晶体几何拟合确定统一缩放因子，用于缩放ESP电荷提取的键电荷增量。此法虽前景良好，但CFF93如何实现溶剂-溶剂、溶剂-溶质、溶质-溶质相互作用的恰当平衡尚待观察。例如，聚碳酸酯力场缩放后的键电荷增量给出羧酸基羰基氧电荷−0.448、羟基氢+0.355，其大小远小于我们为MMFF94拟合缩放HF/6-31G\*二聚体数据所需的−0.57与+0.50；此外，CFF93酸性羟基氢电荷小于MMFF94及其它三点水模型[^43,84]对水较难电离羟基氢所用的+0.40或更大值。

我们的方法也与MM3根本不同。关键差异在于MM3通常使用1.5介电常数，并选用再现气相（非极化增强）偶极的键偶极。为抵消前者，MM3通过加入较大Exp-6项拟合总相互作用势，这些项对氢键相互作用贡献高达6 kcal/mol稳定化。[^84]由此得到的氢键能按设计对应实验气相二聚化能，而非那些以平均方式考虑水相极化的力场所采用的更大值。例如MM3(94)对线性水二聚体给出−4.77 kcal/mol相互作用能，[^85]而SPC、TIP3P与MMFF94均约−6.5 kcal/mol；[^43]气相二聚化能估计约−5.4 kcal/mol。[^34,86]这些差异提示MM3可能未恰当配置用于显式水分子动力学模拟。

最后，我们的方法也与Kollman等不同，后者使用静电势拟合（ESP）电荷，最近采用新开发的RESP方法，[^87]用于AMBER计算。[^88]评估ESP电荷适用性时，应牢记MMFF94及当代力场对非键vdW与静电相互作用的表示高度简化；为补偿“正确”能量表达式中许多非键项的近似或完全省略，保留项的参数需通过对相应非键相互作用数据显式拟合确定。由于ESP电荷并非以此方式选择，无法保证其（或任何外部定义电荷集——即便“真实”电荷，若能定义）能满意再现分子间相互作用能。如前所述，Carlson等[^53]发现乙酰胺CHELPG ESP电荷给出过负的水合自由能。[^53]虽另一ESP电荷集可能表现更好，但很难确定某ESP方法能否一致地预测相互作用能，足以实现溶剂-溶剂、溶剂-溶质、溶质-溶质相互作用的恰当平衡。

为进一步关注非键相互作用建模中的简化，我们指出，目前几乎所有通用分子建模力场不仅忽略极化率，[^89]还忽略更高原子多极矩贡献；[^90,91]此外，大多使用固定、原子中心且与构象及原子间相互作用几何无关的电荷（如忽略电荷转移，量子力学划分方案指出后者在氢键相互作用中可能起显著但非主导作用[^92]）。而且，所有广泛使用的力场均采用过度简化的“球形原子”vdW模型，尽管MM2[^5]与MM3[^6]对C–H键的核偏移有所帮助。正如第I部分[^1]所设想，我们期待未来力场通过采用更优物理表示来纠正这些及其它不足，从而实现以下目标：定义一个既能准确描述气相分子性质，又能在凝聚相中表现恰当的力场。然而，虽实现此目标仍任重道远，但在理解并实践所需物理学的某些关键方面已取得实质进展。[^90,91,93–96]无疑，这类更精细力场的参数化将愈发困难；我们相信唯有计算数据才足以胜任，并期待MMFF94成为几乎完全源自计算数据的系列力场之一。

#### 补充材料

计算机可读的 ASCII 格式文件包含 vdW、键电荷增量及其它 MMFF94 参数，以及附录 A（OPTIMOL/MMFF 计算中用作酶位“环境分子”的非键参数）[^51]，均纳入补充材料。

#### 致谢

感谢 Martin Karplus 教授建议采用缩放 HF/6-31G\* 相互作用能；Bruce Bush 与 Chris Bayly 在 ESP 拟合讨论中提供的帮助；Mike Miller 将 PDM88 接口至 Gaussian 88。