## Merck 分子力场第四部分：MMFF94 的构象能量和几何结构

### 摘要

本文描述了 MMFF94 在构象能量、旋转势垒和平衡扭转角方面的参数化和性能。它描述了从高质量计算数据推导扭转参数的过程，并表征了 MMFF94 在重现计算和实验数据方面的能力，后者特别是与 MM3 相比。计算数据包括：(i) 基于 "MP4SDQ/TZP" 计算（在 MP2/6-31G* 几何结构上进行的 triple-zeta 加极化计算，定义为高度相关的 MP4SDQ 级别的近似）的约 250 个构象能量比较；和 (ii) 约 1200 个 MP2/TZP 对 "扭转剖面" 结构的比较，这些结构在从 MP2/6-31G* 几何结构衍生的几何结构上。扭转参数是在使用完整可用计算数据的约束最小二乘拟合中推导的，从而确保获得完全最优的参数集。最终参数重现 "MP4SDQ/TZP" 和 MP2/TZP 计算数据的均方根 (rms) 偏差分别为 0.31 和 0.50 kcal/mol。此外，MMFF94 重现了一组 37 个实验气相和溶液构象能量、焓和自由能，均方根偏差为 0.38 kcal/mol；作为比较，"MP4SDQ/TZP" 计算和 MM3 各给出均方根偏差为 0.37 kcal/mol。此外，MMFF94 重现了 28 个实验确定的旋转势垒，均方根偏差为 0.39 kcal/mol。鉴于实验构象能量和旋转势垒的多样性以及在某些情况下实验误差的明确指示，MMFF94 的结果显得优秀。然而，MMFF94 在处理将高极性官能团放置在紧密邻近的多功能化合物时遇到 somewhat 更大的困难，可能是因为它，像其他常用力场一样，过于简化了静电相互作用的描述。讨论了一些对 MMFF94 功能形式增强的建议。© 1996 by John Wiley & Sons, Inc.

*本文包括可从作者处索取或通过互联网在 ftp.wiley.com /public/journals/jcc/suppmat/17/587 或 http://journals.wiley.com/jcc 获取的补充材料。

†所有通信应发送给该作者。

这是介绍 MMFF94 系列文章的第四篇。1-4 本研究描述了 MMFF94 在构象能量和几何结构方面的参数化和性能。它指定了所使用的计算数据，定义了用于推导扭转参数的程序，并记录了 MMFF94 在以下方面的成功：(i) 重现理论和实验的构象能量和势垒值，和 (ii) 重现 ab initio 构象几何结构。与之前的文章一样，也将对前身 MM2X 力场的性能进行一些考虑。[^1][^5]

本文第二部分给出了 MMFF94 中使用的扭转势能形式。第三部分介绍了用于推导扭转参数的计算数据，并指定了用于定义用于构象能量的高级 “MP45DQ/TZP” 模型的程序。第四部分然后总结了用于推导参数相互一致值的程序；附录 A（补充材料）提供了更详细的说明。第五部分表征了 MMFF94 重现 ab initio 和实验构象能量和势垒的能力。本节还将 MMFF94 与 MM3 和 MM2X 在实验构象能量方面进行比较，并与 MM3 在旋转势垒方面进行比较，并显示 MMFF94 和 MM2X 在重现参考 MP2/6-31G* 平衡构象体的扭转角方面的表现。第六节讨论了 MMFF94 表述中的两个具体要素——1,4-静电相互作用的差异缩放，以及为连接到脂肪族 ($sp^3$ 杂化) 碳上的氢分配零部分原子电荷。第七节更详细地检查了有问题的案例，并提出了如何增强 MMFF94 的功能形式。第八节呈现了 MMFF94 扭转参数的一个子集，并指定了如何获取完整集。本节还定义了扭转相互作用与列表扭转参数匹配的方式。最后部分总结了这项工作并提供了一些结论。

### Merck 分子力场用于扭转相互作用的形式

MMFF94 采用也在 MM2,6 MM2X, 和 MM3’ 中使用的三重表示：

$$
\text{ET}_{ijkl} = 0.5(V_1(1 + \cos \Phi) + V2(1 - \cos 2\Phi) + V_3(1 + \cos 3\Phi))
$$

其中 $\Phi$ 是以度为单位的 $i-j-k-l$ 扭转角。常数 $V_1$, $V_2$, 和 $V_3$，以千卡每摩尔给出，取决于原子类型 I, J, K, 和 L，其中 i–j, j–k, 和 k–l 是键合对，以及在后文定义的“扭转类型”索引 $\text{TT}_{ijkl}$。后一个索引允许对四元环内和包含至少一个饱和碳的五元环内的扭转相互作用赋予特殊的扭转常数；它还允许对其中中心键或外围键是能够参与多重键或芳香键的 sp– 或 sp$^2$ 杂化原子对之间的单键的相互作用使用特殊值。这种类型的中心键出现在，例如，联苯、丁二烯和苯乙烯中。

### 用于参数化 MMFF94 的计算模型和数据

#### 构象能量的计算数据

使用 Gaussian 88,8 Gaussian 90,9 或 Gaussian 92,10，我们在 $\sim 380$ 个 MP2/6-31G* 优化的几何结构上进行了我们称之为 “MP45DQ/TZP” 级别的计算。这些计算大多数是针对平衡构象体，但大约 110 个使用了扭转约束来在一个或多个原子中心强制执行平面性，或探测构象最小值之间中间点的扭转势。这些计算，例如，允许对四元和五元环系统的平面与褶皱构象以及酰胺、乙烯胺和相关系统的平面与金字塔构象进行比较。总的来说，这些计算提供了 249 个相对 "MP4SDQ/TZP" 能量的比较。

"MP4SDQ/TZP" 计算是复合计算，将使用 6-31G* 类型基组$^2$ 评估的三阶和四阶 MP3 和 MP4SDQ 微扰校正$^1$ 添加到 MP2/TZP 能量上。指定 "TZP" 表示使用极化的 triple-zeta 基组。我们使用了 Dunning$^13$ 的 triple-zeta 基组用于氢 [5s/3s] 和第一行原子 [10s,6p/5s,3p]，以及 McLean 和 Chandler$^14$ 的用于第二行原子 [12s,9p/6s,5p]。对这些基组，我们为氢添加了一组指数为 0.80 的 p 型高斯极化函数，并为 C, N, O, 和 F 添加了指数为 0.60, 0.85, 1.20, 和 1.65 的单个 d 组，以及为 P, S, 和 Cl 添加了指数为 0.50, 0.65, 和 0.80 的单个 d 组。这些极化指数是从 Dunning 的相关一致基组,[^15] Roos 和 Siegbahn 的基组,[^16] 和 Pople 的 6-311G** 基组[^17] 中使用的极化指数构建的正则化值。为了一致性，对于非氢原子，我们在使用 6-31G 基组进行 "MP4SDQ/TZP" 模型中使用的 MP3 和 MP4SDQ 微扰相关校正时使用了相同的极化指数。我们在本文中将这个修改的基组表示为 6-31G#。

"MP4SDQ/TZP" 数据还提供了沿扭转剖面离散点处构象能量的若干比较。为了以计算上较少负担的方式扩展这些比较，我们在 $\sim 1450$ 个扭转递增的几何结构上进行了单点 MP2/TZP 计算。这些几何结构是从基础 MP2/6-31G* 平衡几何结构通过将一个扭转键旋转指定量（例如，$\pm 30^\circ$, $\pm 60^\circ$, ...）衍生的，并且为了最小化空间冲突，然后通过对所有扭转角施加强约束来优化所得结构。[^18] 为了使相对能量的比较有意义，我们也以相同方式优化了基础 MP2/6-31G* 几何结构。这些优化使用了 OPTIMOL[^1]，MMFF 和 MMZX 的主分子力学平台，并使用了精炼但尚未完全优化的 MMFF 参数值。这些前体 MMFF 参数本身是使用较早的一组构象能量数据获得的。该数据，其某些方面已在另一种背景下使用,$^19$ 利用了在 HF/6-31G* 几何结构上的 MP3/6-31 + G** 计算。[^12] MP2/TZP 单点计算提供了关于扭转能量剖面和旋转势垒的数据，并产生了 1192 个相对能量的比较。在力场优化几何结构上的单点 ab initio 能量先前已被 Allinger 及其同事有效地用于力场开发。[^20]

#### 构象能量计算模型的比较

对 34 个构象能量比较的基准 ab initio 计算，大多数用于本研究中后面讨论的与实验比较的系统，表明通过使用 6-31G# 基组评估三阶和四阶微扰校正，相对于未近似的 MP4SDQ/TZP 计算，仅产生 0.04 kcal/mol 的均方根误差。相比之下，MP2/TZP 和 MP4SDQ/TZP 相对能量之间的均方根差为 0.24 kcal/mol（作为比较，HF/TZP 和 MP4SDQ/TZP 之间的差为 0.91 kcal/mol）——我们觉得足够大，以证明使用四阶校正进行电子相关是合理的。我们还考虑了使用完整或近似的 MP4SDQ/TZP 计算，这些计算添加了来自三重激发的四阶贡献。[^11] 对于八个系统，每个系统都有相对较大的三重贡献，我们比较了在 MP4SDQ/TZP 和 MP4SDQ/TZP 级别计算的构象能量与完整 QCISD(T)/TZP 计算，再次在 MP2/6-31G* 优化的几何结构上评估。我们发现添加 MP4 三重实际上略微恶化了与 QCISD(T)[^21] 结果对这些要求高的系统的一致性。尽管我们后来检查了第九个系统，其中 MP4 三重贡献显著改善了一致性，但我们选择保留更简单且大约便宜三倍的 MP4SDQ 模型。最后，我们还为 34 个测试系统的大多数在 6-31G* , 6-31 + G\**  , DZP,[^22] 和 6-311G\** 基组的不同电子相关级别计算了构象能量。然而，除了使用类似的 6-311G\*\* 基组的（ somewhat 更昂贵的）计算外，相对于 TZP 模型的变化足够大，导致我们采用后者。复合 "MP4SDQ/TZP" 模型似乎代表了在可用计算资源下最佳的计算上易处理的模型。[^23]作为该模型的进一步验证，我们后来显示 "MP4SDQ/TZP" 计算预测实验确定的构象能量优于更简单的 MP2/TZP、MP2/6-31G* 或 HF/6-31G* 计算——在大多数情况下，显著更好。

### MMFF94 扭转参数推导总结

用于推导 MMFF94 扭转参数的程序详细讨论在附录 A（补充材料）中给出，可在网上访问。[^24] 本节提供那些程序的简要说明。

#### 基本方法

我们使用程序 TORFIT（在这些实验室开发）通过最小二乘拟合先前描述的计算数据来推导扭转参数。为了重现能量和几何结构，我们使用了一种迭代方法，其中我们首先在非常接近参考 MP2/6-31G* 优化几何结构的几何结构上拟合相对“MP4SDQ/TZP”构象能量。然后，随着扭转参数变得更好定义，我们在力场优化的几何结构上拟合它们，这些几何结构 increasingly 类似于最终的 MMFF 优化几何结构。我们通过在涉及“MP4SDQ/TZP”比较的结构连续 MMFF 优化期间应用逐渐减小的二次扭转角约束来实现此程序。基于扭转递增结构的比较在 MP2/TZP 和连续 MMFF 能量评估中都使用了先前描述的几何结构。

#### 扭转参数的初始值

为了构建一个无偏的初始扭转参数集，我们将所有参数设为零，除了某些预期值较大的双重参数（参见附录 A）。例如，在酰胺中关于 C-N 键旋转的双重参数在本工作的后期阶段被赋予 6 kcal/mol 的初始值。

#### 最小二乘惩罚函数约束

所有构象能量数据在每次最小二乘拟合中同时使用。这些拟合最小化了方程 (2) 中显示的平方和：

$$
SOS = \sum w_i(\text{CE}_i^{\text{MMFF}} - \text{CE}_i^{\text{ref}})^2 + p\sum(V_n(\text{IJKL}) - V_n^0(\text{IJKL}))^2
$$

第一个求和遍历 249 个“MP4SDQ/TZP”和 1192 个 MP2/TZP 构象能量差的集合，其中“ref”表示“MP4SDQ/TZP”或 MP2/TZP 能量差。量 $w_i$ 是一个权重因子，通常对于“MP4SDQ/TZP”比较选择为 1.0，对于更众多的 MP2/TZP 比较选择为 0.2。第二个求和添加惩罚函数约束，用于保持每个 $V_n(\text{IJKL})$ 扭转参数[^25] 接近其输入值。在没有它们的情况下，参数之间的相关性通常导致产生物理有效性可疑的参数的大变化，同时仅略微减少平方和。惩罚函数约束倾向于在可能的情况下将参数保持为零，或者在涉及简单参数相关性时保持相等的量级。

#### TORFIT

在读入输入扭转参数并注意哪些要优化和哪些要保持恒定后，TORFIT 顺序处理结构文件列表。对于第 $i$ 个条目，它读取相关构象体对的分子结构，并计算来自要优化的输入扭转参数对 MMFF 构象能量差的贡献。通过将此量 $T_i^0$ 加到参考和输入 MMFF 构象能量差之间的差上，TORFIT 确定总扭转贡献[^26]：

$$
T_i = T_i^0 + \text{CE}_i^{\text{ref}} - \text{CE}_i^{\text{MMFF}}
$$

MMFF 将必须产生此贡献以使 $\text{CE}_i^{\text{MMFF}}$ 的调整值（即 $\text{CE}_i^{\text{MMFF}} - T_i^0 + T_i$）等于 $\text{CE}_i^{\text{ref}}$。然后 TORFIT 将 $T_i$ 视为要拟合的观测量。此表述使得 TORFIT 能够施加拉格朗日约束以控制参数相关性。然而，对于 MMFF94，它被证明同样有效且远更便于直接施加惩罚函数约束。

#### 最小二乘精修

使用初始的扭转参数集，我们从 MP2/6-31G* 几何结构出发，优化了"MP4SDQ/TZP"构象体，同时对所有扭转角使用了较强的扭转约束力常数（100 kcal/mol/rad$^2$）。接着，我们进行了第一次线性最小二乘精修，以得到扭转参数的新估计值。然后，我们使用 successively 减小的扭转约束力常数重复此过程（参见附录 A）。最后，我们通过将所有幅度小于 0.05 kcal/mol 的扭转参数设为零，并重新优化剩余的非零参数，消除了小的"干扰值"参数。

此过程产生了我们称之为"MMFF93"的参数集。我们随后意识到有几个方面需要改进。例如，一个方面涉及本研究中 later 讨论的中等大小环烷基环的构象能量。另一个方面涉及 MMFF93 倾向于高估酰胺参考 MP2/6-31G* 结构中氮原子的金字塔化程度。为了弥补这些缺陷，我们在每种情况下都使用了所有受影响的构象能量，重新推导了扭转参数的子集。为了减少酰胺形成金字塔构型的倾向，我们还更改了仲酰胺和叔酰胺（MMFF 原子类型为 3, 1, 28 和 3, 1, 1，连接到酰胺氮原子，其本身为类型 10）的面外力常数，从 $-0.030$ 和 $-0.034$ 改为 $-0.02$ 和 $\text{A}/\text{deg}^2$；原始值源自对 HF/6-31G* 二阶导数的拟合。[^3] 这些修改导致酰胺中 Wilson 面外角的均方根值，所反映的整体褶皱程度与参考 MP2/6-31G* 结构中发现的非常相似。[^3]

在针对 302 种 J/KL 原子类型和扭转类型组合产生的 906 个一重、二重或三重扭转参数中，组合方案得到了 248 个零值扭转参数（27%）。此外，39 个无法优化的二重参数（参见附录 A）被固定在其初始赋值。因此，619 个非零扭转参数被拟合到 $\sim 1440$ 个构象能量差。虽然每个扭转自由度的观测值比率 2.3 并不高，但在最小二乘程序中使用惩罚函数权重似乎仍然产生了一组精简且定义明确的参数。

#### 构象能量权重的非标准值

在少数情况下，我们尝试对特定的构象能量比较使用了较大的权重 ($w_i$)。例如，在酰胺中较小的"MP4SDQ/TZP"平面性势垒的 MMFF 估计值较差，且与氮原子处 MMFF 和 MP2/6-31G* 几何结构存在较大差异相关的情况下，使用了这种增大的权重。在另外一些情况下，由于对相对于局部最小值的扭转递增结构能量重现性差，导致 MMFF 优化的扭转角与参考 MP2/6-31G* 值显著不符，也使用了增大的权重。还有其他情况，即 MMFF 优化的扭转角与 ab initio 值显著不符，需要向构象比较集合中添加数据（参见附录 A）。最后一类情况是，部分计算数据无法在严重损害对其他数据的拟合的情况下得到满意拟合。在这两类情况下，我们无法解决不兼容性问题，并将扭转递增比较的 21 个权重因子（17 个用于乙二胺，4 个用于 N-甲基甲亚胺）设置为小值，从而将这些比较从扭转参数拟合中移除（参见"局限性"部分）。

权重因子的更改、额外计算数据的生成，以及在本工作过程中对 MMFF 功能形式的修改（参见"两个方面"部分），比 MMFF94 推导过程中任何其他点都更清晰地表明，复杂力场的开发需要是一个自适应过程。

#### MMFF94 参数的相互一致确定

我们将前述推导扭转参数的程序与第三部分[^3]中描述的推导二次力常数以及参考键长和键角的程序交织进行。在最终推导 MMFF94 扭转参数之前，我们还重新评估或在必要时重新推导了涉及极性分子间相互作用的非键参数。[^2] 这种迭代方法使得每种类型的参数都能在其他类型参数日益精修的背景下得到优化。

### MMFF94 相对于其他力场的性能

#### 计算的构象能量和势垒

在下表中，"构象能量"指的是基于 "MP4SDQ/TZP" 的 249 次比较，而"扭转剖面能量"指的是用于推导参数的 1171 次 MP2/TZP 扭转增量比较。所有结果均以千卡每摩尔的均方根偏差表示：

|              | MMFF94 | MM2X |
| ------------ | ------ | ---- |
| 构象能量     | 0.31   | 1.12 |
| 扭转剖面能量 | 0.50   | 1.57 |

作为参考，用于测试 MMFF94 的构象能量和扭转剖面能量的均方根值分别为 3.88 kcal/mol 和 4.37 kcal/mol，而用于评估 MM2X 的略小的 ab initio 数据集的相应值分别为 2.30[^27] 和 4.38 kcal/mol。因此，MMFF94 在每种情况下都能解释约 90% 的 ab initio 相对能量变异，而 MM2X 仅能解释约 50%。

MMFF94 重现 "MP4SDQ/TZP" 构象能量的能力如表 I 所示（用于识别构象体的五字符构象索引在第一部分[^1]中定义）。拟合的总体质量体现在 MMFF94 在 249 次比较中的 239 次重现了 "MP4SDQ/TZP" 能量差的符号。此外，所有十次符号错误都涉及较小的相对能量绝对误差。定性预测错误的最大绝对误差为 0.42 kcal/mol，出现在甲氧基环己烷的轴向-C$_1$ 和 equatorial-C$_1$ 构象体（分别为 OR04c 和 OR04b）的比较中，下一小节讨论的比较表明，是参考的 "MP4SDQ/TZP" 计算而非 MMFF94 计算存在问题。

一些与 MMFF94 描述蛋白质主链构象能力相关的比较，与 MMFF94 在分子动力学模拟中的预期用途尤其相关。特别是，AM09 和 AM10 系列探索了 Pople 及其同事[^28]通过计算研究的甘氨酸和丙氨酸二肽类似物的构象能量，而相关的 AM16 和 AM17 系列（参见图 1）将研究扩展到了完整的（甲基封端的）二肽。表 I 显示，对于甘氨酸二肽类似物（AM09b 和 AM09a），MMFF94 将 C5 构象体置于 C7 之上 1.14 kcal/mol，对于甲基封端的二肽（分别为 AM16b 和 AM16a）则高出 1.62 kcal/mol。其他比较表明，对于丙氨酸二肽类似物（AM10a）和二肽（AM17a），MMFF94 都将 C7$_{eq}$ 构象体置于能量最低，并将 C5 和 C7$_{as}$ 形式（构象体 b 和 c）分别置于高出 1.12 和 1.83 kcal/mol 以及 1.68 和 2.26 kcal/mol 的位置。此外，在每个系列中，MMFF94 将 $\alpha'$、$\beta_2$ 和 $\alpha_1$ 构象体（d、e 和 f）置于比 C7$_{eq}$ 高 2.3 至 5.5 kcal/mol 的位置。所有这些 MMFF94 构象能量都与参考的 "MP4SDQ/TZP" 值高度一致。需要指出的是，后者与 Pople 及其同事报告的一些较低级别的 HF/6-31 + G* / /HF/6-31 + G* 构象能量有显著差异，但与他们的 MP2/6-31 + G** / /HF/6-31 + G* 值相当吻合。[^28] 同样重要的是，用于推导 MMFF94 参数的扭转增量结构包括基于每个 AM09 和 AM10 构象体键旋转的广泛子集。这些比较有助于确定平衡扭转角并探测代表构象互变异构势垒的区域；这些数据也通过 MMFF94 得到了很好的描述。

尽管 MMFF94 在整体上表现良好，但仍存在一些值得关注的领域。因此，在 249 个 MMFF94 构象能量中，虽然有 227 个与参考 "MP4SDQ/TZP" 值的偏差在 0.5 kcal/mol 以内，但有 18 个显示出 0.5-1 kcal/mol 的偏差，还有 4 个偏差高达 2 kcal/mol。大多数较大的差异发生在高极性、多官能团化合物中。类似的困难也影响了 MP2/TZP 扭转增量结构集中的一些构象比较。本文后面将讨论一些此类特别棘手的情况。

#### 实验构象能量

为了了解 MMFF94 和 MM2X 预测实验的效果，特别是与备受推崇的 MM3 力场相比，我们检查了一组 37 个构象能量（表 II）。许多相同的比较已被用于推导或验证其他分子力场。[^29]-[^31] 重要的是要从一开始就认识到，实验测定结果构成了多种可观测量的混合体。只有在极少数情况下，例如对于 1,3-丁二烯和 2-甲基-1,3-丁二烯，实验测量的量与理论计算得到的量相同，即两个势能最小值之间的能量差。虽然少数测定对应于基态振动能级之间的能量差，但大多数给出的是在室温或有时低于室温下的相对焓；有些，例如甲基环己烷、环己醇、甲氧基环己烷和环己胺的那些，代表的是相对自由能。此外，虽然大多数实验测量是在气相中进行的，但有些是针对溶液中的相互转换。最重要的是，所有这些都存在误差——有时是显著误差，如下文引用的不同实验结果集所清楚表明的那样。由于这些原因，即使是对能量最小值之间差异的精确理论计算也不会与实验完全一致。为了对实验进行一定的检验，特别是在有两个或更多实验结果可用的情况下，表 II 中的所有比较都是我们也使用 "MP4SDQ/TZP" 模型结合 MP2/6-31G* 优化几何结构计算了理论构象能量的那些比较。对于其中一些，还获得了未近似的 MP4SDQ/TZP，甚至 QCISD(T)/TZP 构象能量。

当表 II 中列出多个实验结果时，报告的均方根偏差使用的是与 "MP4SDQ/TZP" 模型最一致的结果，或者，对于 MM3，使用的是与 MM3 最一致的结果。对于环己胺，我们使用了 1.1 kcal/mol，即所列实验范围的下限。我们首先注意到，"MP4SDQ/TZP" 能量与实验的差异均方根偏差仅为 0.37 kcal/mol，大约是实验相对能量的均方根值 2.33 kcal/mol 的六分之一。我们检查的其他 ab initio 方法表现较差。具体来说，在相同 MP2/6-31G* 几何结构上的 MP2/TZP 计算显示出略高的均方根偏差 0.44 kcal/mol，而 MP2/6-31G*/MP2/6-31G* 和 HF/6-31G*/HF/6-31G* 计算则显示出显著更高的均方根偏差，分别为 0.69 和 0.73 kcal/mol。这些比较支持选择 "MP4SDQ/TZP" 模型。即使将 MMFF 的某个版本拟合到次优模型 MP2/TZP，似乎也不太可能像 MMFF94 那样好地预测实验，因为 MMFF94 对实验的拟合优于 MP2/TZP（见下文）。特别明显的是，仅拟合到 MP2/6-31G* 或 HF/6-31G* 构象能量的力场，其预期精度将远低于 MMFF94，因为这些理论方法本身重现实验构象能量的效果远不如人意。

表 II 中呈现的比较还表明，MM3 和 MMFF94 的均方根偏差分别为 0.37 和 0.38 kcal/mol，在精度上与 "MP4SDQ/TZP" 相当，而 MM2X（均方根偏差 0.84 kcal/mol）的表现则差得多。此外，它们表明，将 MMFF94 拟合到高质量的计算数据同时赋予了其重现实验的能力。认为 MMFF94 还是 MM3 更准确，取决于人们相信实验测定还是 ab initio 计算能更好地衡量真实的构象能量。因此，虽然 MM3 重现实验的效果略好于 MMFF94，但表 II 显示 MMFF94（均方根偏差 0.33 kcal/mol）重现 "MP4SDQ/TZP" 构象能量的效果远优于 MM3（均方根偏差 0.49 kcal/mol）。鉴于 "MP4SDQ/TZP" 与实验之间，以及针对同一构象差异的不同实验测定之间（见下文）存在显著差异，对于这些体系，实验比理论更准确这一点并不立即显而易见。

现在将对 MMFF94 和 MM3 与理论和实验的比较进行概述。对于 N-甲基乙酰胺，MMFF94 和 ab initio "MP4SDZ/TZP" 关于顺反差异的结果，与通过温度依赖性红外强度在氮基质中获得的 2.3 kcal/mol 的"粗略" $\Delta H$[^32] 更为接近，而与来自 NMR 线形分析[^33]的较大的 $\Delta G$ 2.8 kcal/mol 一致性较差；MM3 更接近后者。[^34] 这两种力场在 N-甲基甲酰胺上的表现相当。

对于甲酸和甲酸甲酯的反式与顺式比较，实验和 ab initio 理论之间出现了相对较大的差异。[^35] 尚不清楚这些差异主要反映了理论还是实验的局限性。对于乙醛酸，能量较高的构象体将一个 COOH 部分置于不利的反式构象，但有利地定位了向外张开的羟基，以便与第二个羰基氧形成氢键。在这里，构象能量差异的微波测定值恰好落在 "MP4SDZ/TZP" 和 MMFF94 值之间。这个差异是 MMFF94 在拟合 ab initio "MP4SDZ/TZP" 相对能量时最大的差异之一。这很可能表明 MMFF94 的函数形式（以及 MM3 等的函数形式）过于简单，无法一致地很好地处理高极性、多官能团化合物。

2-丁酮是一个特别有趣的案例，因为实验测定发现，在液相中 skew 构象体比 cis 构象体高 1.0–1.3 kcal/mol，但在气相中则高 2.0–2.2 kcal/mol。[^36] 较高的气相值曾被用于开发和评估力场模型，[^29],[^30] 并且似乎得到了 Wiberg 和 Martin 在 HF/3-21G 优化几何结构上进行的 MP2/6-31G* 计算的支持（参见表 III）。[^37] 然而，当使用 MP2/6-31G* 优化的几何结构时，cis 构象体仅优先 1.497 kcal/mol，这个值仅略高于液相测量范围。此外，在 MP2/6-31G* 和几乎相同的 MP2/TZP 优化几何结构上进行的各种更高级别的计算都强烈支持较低的范围。如表 III 所示，对于基组为 DZP 及更高质量的情况，计算的构象能量差对价键基组、极化基组和电子相关级别都相对不敏感。这些计算得出的最佳估计值约为 1.2 kcal/mol，我们将其计算为 MP2/TZP(3d, 2f; 3p, 2d) 三重第一极化、双重第二极化的能量差 1.091 kcal/mol，再加上对 MP2 之外的电子相关性的约 0.1 kcal/mol 的容限。表 II 中引用的均方根偏差使用了另一种实验估计值，我们在表中将其列为所述范围 1.0–1.3 kcal/mol 的平均值。我们认为测得的 2.0–2.2 kcal/mol 的气相差值是错误的。

卤代烷本身就是一个值得探讨的话题。正如 Dixon 和 Smart 所指出的，1,2-二氟乙烷的反式、旁式差异一直是深入研究的主题，实验测定值范围从 –1.41 kcal/mol 到 +1.98 kcal/mol。[^38] 这个巨大的范围，特别是反式、旁式差异的符号甚至都存在争议，表明实验测定可能产生非常大的误差，即使对于看似简单的体系也是如此。Dixon 和 Smart 倾向于（见表 II）最近通过气相 $^{19}$F 和 $^{1}$H 高分辨率 NMR 得到的 0.8 kcal/mol 的估计值。该值与他们非常大的基组 (TZ + 2D + P) 计算以及我们更适中（但相关性更高）的 "MP4SDQ/TZP" 计算非常一致——并且与 MMFF94 一致。对于 1,2-二氯乙烷，已经报道了更多种类的实验测定，尽管测得的构象能量差异落在相对较窄的范围内。表 II 中列出的旁式-反式差异为 1.16 kcal/mol，代表了 Dixon 等人引用的 13 次此类测定的平均值，[^39] 与我们的 "MP4SDQ/TZP" 结果和 MMFF94 非常一致。对于 1-卤丙烷，实验表明氟代物、[^40] 氯代物、[^40],[^41] 并且值得注意的是，甚至溴代物[^42] 都偏爱旁式构象。"MP4SDQ/TZP" 和 MMFF94 的结果并不完全一致，但差异不大。关于溴化物、氯化物和氟化物的 MM3 研究尚未发表。

对于 2-甲氧基四氢吡喃，MMFF94 正确地将平伏键甲氧基构象体置于"异头效应"稳定的直立键甲氧基构象体之上，但显著夸大了这一差异。"MP4SDQ/TZP" 和 MM3 的结果，相比之下，与实验吻合良好（在 tetrahydronaphthalene 中 $\Delta H$ = 1.05 kcal/mol）。[^43] 对于环己胺，所有关于直立键 - 平伏键差异的实验结果（在溶液中为 $\Delta G$）[^44] 都大于 "MP4SDQ/TZP" 和 MMFF94 的差异。然而，ab initio 计算也低估了环己醇和甲氧基环己烷的相应且更确定的构象能量差异，低估了 0.2–0.5 kcal/mol。碰巧的是，MMFF94 密切重现了胺和醇的 "MP4SDQ/TZP" 结果，因此也低估了实验差异，但在甲基醚的情况下却以恰恰使 MMFF94 与实验一致的方式偏离了 ab initio 结果。甲氧基环己烷似乎是一个 "MP4SDQ/TZP" 计算出错的案例。有趣的是，基础的 MP2/TZP 计算错误地更强烈地偏爱直立键构象体，偏爱程度达 0.21 kcal/mol。

MP3 和 MP4SDQ 微扰校正沿着正确的方向调整了构象差异，但调整得不够远；也许需要进一步的相关性校正，或者可能存在构象依赖的"基组叠加误差"有利于轴向形式，体积和表面积计算表明轴向形式略微更紧凑。MP3 和 MP4SDQ 微扰校正沿着正确的方向调整了构象差异，但调整得不够远；也许需要进一步的相关性校正，或者可能存在构象依赖的"基组叠加误差"有利于轴向形式，体积和表面积计算表明轴向形式略微更紧凑。

对于乙醇，Allinger 及其同事[^43] 参数化了 MM2 和 MM3，以重现基于测量的气相 O-H 伸缩带红外强度以及振子强度相等的假设得出的对反式构象约 0.4 kcal/mol ($\Delta G$) 的实验偏好。[^45] 然而，一项微波测定将旁式构象体仅置于高 0.12 kcal/mol 的位置。[^46] "MP4SDQ/TZP" 计算与后一种测定更吻合，但实际上略微偏爱旁式。值得注意的是，我们发现，在 MP2/TZP 优化几何结构上进行的 MP2/TZP 计算也将旁式构象体置于较低位置，低 0.032 kcal/mol，并且在 MP2/TZP 几何结构上进行的 QCISD(T)/TZP 计算进一步将差异增加到 0.111 kcal/mol，有利于旁式乙醇。在实验方面，MMFF94 更接近地重现了微波结果（我们认为这更有依据），而 MM3 重现了红外结果。然而，令人不安的是，非常好的理论在定性上仍然与实验存在差异。

对于所检查的烷烃和烯烃，实验、"MP4SDQ/TZP"、MMFF94、MM2X 和 MM3 的结果总体上非常一致。MMFF94 错误地排列了 2,3-二甲基丁烷的两种构象体的顺序，尽管绝对误差不大。对于环辛烷，所有方法都正确识别了能量最低的构象体。对于这个体系，Anet[^47] 将一个具有 $D_{4d}$ ("crown")、$D_2$ ("twist-chair-chair") 或 $C_{2p}$ ("chair-chair") 对称性的 crown 家族构象体置于能量最低的 $C_s$ 对称性 "boat-chair" 构象体（表 I 中的构象体 RA14b）之上 $1.9 \pm 0.2$ kcal/mol。"MP4SDQ/TZP" 计算与此非常一致，将高度对称的 $D_{4d}$ crown 构象体 (RA14a) 置于 $C_s$ boat-chair 之上 2.00 kcal/mol，并将 $D_2$ twist-chair-chair 置于 boat-chair 之上 2.13 kcal/mol。MMFF94 将 twist-chair-chair 置于 boat-chair 之上 1.44 kcal/mol，与理论和实验在定性上一致，但发现 $D_{4d}$ crown 是一个双重部分最大值，位于 $D_2$ twist-chair-chair 之上 0.18 kcal/mol。

振动分析[^48]预测，在室温下，MMFF94 中 twist-chair-chair 构象的布居为 21%，大约是 Anet 测量的 crown 家族布居 6% 的三倍。显然，MMFF94 给出的空间能差异太小，而 "MP4SDO/TZP" 模型的差异可能大致正确。然而，MMFF94 确实发现 twist-chair-chair 的熵比 boat-chair 高 1.50 eu，这与 Anet 估计的 $1 \pm 1$ eu 在定性上一致。正如 Allinger 及其同事指出的那样，[^7] twist-chair-chair 的对称数为 4 但具有手性这一事实*不利于*该构象体，不利程度为 $R \ln 2 = -1.38$ eu。然而，对于 MMFF94，我们发现熵的振动贡献足以抵消这种对称数贡献。MM3 预测的 twist-chair-chair 的相对空间能甚至比 MMFF94 预测的更低（参见表 II）。尽管如此，使用刚才引用的不利熵差 $-1.38$ eu，Allinger 及其同事计算出室温下 twist-chair-chair 的布居为 7%，与 Anet 的结果非常一致。然而，他们的计算似乎忽略了导致 MMFF94 出现差异的振动对焓和熵的贡献。最后，我们注意到，"MP4SDO/TZP" 和 MMFF94 计算发现 $C_2$ twist-boat-chair（构象体 RA14c）位于 $C_5$ boat-chair 之上 1.71 和 1.99 kcal/mol。第四个稳定构象体 RA14d 具有 $S_4$ 对称性，[^49] 位于 boat-chair 之上，对于 "MP4SOD/TZP" 和 MMFF94 分别为 2.97 和 3.27 kcal/mol。在 298 K 时，相对于 twist-chair-chair (RA14b)，RA14a、RA14c 和 RA14d 的 MMFF94 自由能分别为 0.72、1.42 和 3.22 kcal/mol。

对于环壬烷，所调查的所有四种方法都一致认为，具有 $D_3$ 对称性的 [333] 构象体[^50]（表 I 中的 RA16b）能量最低，并且在低温下将占主导地位。根据 NMR 峰积分面积，Anet 和 Krane[^51] 发现第二个构象体（他们认为这是具有 $C_2$ 对称性的 [225] 构象体 (RA16c)）在 128 K 时占混合物的 12%。假设力场计算的相对熵为 +3.5 eu，他们得出结论，这第二个构象体位于 [333] 之上 0.95 kcal/mol ($\Delta H$)，并且在室温下会略微有利。基于将 $^{13}$C-NMR 线宽对倒数温度作图时发现的非线性偏离，他们推断存在第三种构象，他们将其指定为具有 $C_2$ 对称性的 [144] 构象体 (RA16a)，在 178 K 时以 0.5–1.5% 的相对浓度存在，对应于 $1.6 \pm 0.2$ kcal/mol 的 $\Delta G$。假设力场计算的相对熵为 3.3 eu，他们将此结构在焓上置于 [333] 之上 $2.2 \pm 0.2$ kcal/mol。这些 $\Delta H$ 和 $\Delta S$ 的值，如果被认为是与温度无关的，则在 100 K 时得出 [333]、[225] 和 [144] 构象体的布居分别为 95%、5% 和 0.01%，在 298 K 时分别为 43%、51% 和 6% $\pm$ 2%（Anet 和 Krane 在他们的研究中将后一组数值四舍五入为 40%、50% 和 10%）。

MMFF94 将 [225] 和 [144] 构象体在能量上 ($\Delta E$) 置于 [333] 之上 1.21 和 1.41 kcal/mol，这在定性上与 "MP4SDO/TZP" 的相对能量（分别为 0.99 和 1.97 kcal/mol）一致，但定量上不一致。从表 IV 可以看出，MMFF94 为 [225] 和 [144] 构象体分配的相对熵与 Anet 和 Krane 假设的非常相似。然而，对于 MMFF94，在 298 K 时的焓校正不利于 [225] 0.47 kcal/mol（错误地），但相对于 [333] 有利于 [144] 0.11 kcal/mol，结果是预测 [333]、[225] 和 [144] 在室温下的布居分别为 49%、17% 和 30%。这些布居与从 Anet 和 Krane 数据得到的布居有些不同。然而，当将使用 MP2/6-316$^8$ 振动频率获得的熵和焓贡献[^48] 应用于 "MP4SDO/TZP" 相对能量时，发现预测的布居为 26%、60% 和 12%（表 IV），符合得更好。此外，*ab initio* 模型将 [225] 和 [144] 构象体在 298 K 时的焓置于 [333] 之上 0.84 和 1.76 kcal/mol，与 Anet 和 Krane 在较低温度下估计的 0.95 和 $2.2 \pm 0.2$ kcal/mol 合理地一致。

报告的关于环壬烷的 MM3 计算更准确地再现了 Anet 和 Krane 的结果，[^7] 但似乎使用了有利于 [225] 和 [144] 构象体的相对熵，这些熵包含了对称数校正 ($R \ln 6 - R \ln 2 = 2.19$ eu)，但忽略了 MMFF94 和 MP2/6-31G$^8$ 振动分析发现很重要的振动贡献。最近，Allinger 等人报道了环壬烷的 MM4 计算，该计算正确地包含了所有热化学贡献。[^52] 这些计算得出在 100 K 时 [333]、[225] 和 [144] 的布居分别为 79%、10% 和 11%，在 298 K 时分别为 20%、34% 和 37%。特别是在 100 K 时，实验数据表明第三种构象体的存在量仅为约 0.01%，这些结果与实验有相当大的差异。然而，Allinger 等人提出，[144] 的 NMR 共振信号被埋藏在[333] 构象体的信号之下而未被观测到，并且一个 Anet 和 Krane 未考虑的构象体对应于实验检测到的第三种（次要）物质。我们将此构象体（我们称之为 RA16e）在表 IV 中表示为 [9a][^53]；它是 Dale 构象体 [9] = [144][^50] 的一个不对称版本，与其共享相同的环扭转角定性模式。MM4 计算得出在 100 K 时 [333] + [144]、[225] 和 [9a] 的布居分别为 90%、10% 和 0%，在 298 K 时分别为 58%、34% 和 7%，这些与根据 Anet 和 Krane 检测到的三种构象体实验推断出的布居相当接近。然而，我们的 ab initio 结果与 Anet 和 Krane 对 [333]、[225] 和 [144] 的指定一致。此外，"MP4SDO/TZP"--MP2/6-31G$^+$ 模型将 [9a] 构象体在 298 K 时置于 [333] 之上，能量差 3.37 kcal/mol，焓差 3.20 kcal/mol，自由能差 1.41 kcal/mol，导致预测的在 298 K 时仅含 2% [9a] 的组成；MMFF94 给出了可比的结果。此外，ab initio 模型预测在 178 K 时 [9a] 的布居仅约为 0.2%，可能太小而无法解释观察到的 NMR 线宽展宽。我们相信 Anet 和 Krane 的最初解释是正确的，并表明 MM4 为 [144] 和 [9a] 构象体获得的相对空间能太低。

现在回到对表 II 的讨论，我们注意到表中引用的结果也允许与 UFF[^30] 和 CHARMm[^31] 进行一些比较。Gundertofte 等人最近关于构象能量和旋转势垒的研究[^29a] 允许与在 MacroModel 中实现的 MM2*、MM3* 和 AMBER* 力场；在 Chem3D Plus 中实现的改进 MM2 力场；在 CERIUS$^2$ 中实现的 DREIDING、UFF 和 MMFF93 力场；在 Alchemy 中实现的 TRIPOS 力场版本；在 PCModel 中实现的 MMX 力场；以及在 Insight/Discover 中实现的 CVFF 和 CFF(91) 力场进行更广泛的比较；Gundertofte 等人还检查了 MM2(85)、MM2(91) 和 MM3(92)，[^29a] 并在早期工作中评估了半经验 AM1 和 PM3 模型（两者表现都很差）。[^29b]

对于表 I 中的体系，CHARMm[^31] 似乎表现良好，尽管可进行的比较太少，无法得出确切的结论。UFF 在许多情况下也表现得相当好，但在异头 2-甲氧基羟基体系中颠倒了轴向和平伏键构象体的稳定性顺序，颠倒了 2-丁酮中顺式和斜式构象体的稳定性，错误预测了 1,2-二氟乙烷中反式和旁式构象体的顺序，并且显著高估了环己烷 twist–boat 构象体的相对能量。[^30] 我们应该注意，这些 UFF 计算忽略了静电相互作用。

Gundertofte 等人发现在忽略静电相互作用的计算中，UFF 存在类似的问题，并且当使用基于推荐的 QEq 电荷平衡程序的电荷时，遇到了更明显的困难；由此产生的 UFF 模型产生的均方根误差超过了所计算构象能量的均方根值！DREIDING、Tripos 力场、CVFF 和 CFF(91) 的表现也相对较差——尽管 CFF(91) 仅在含卤素化合物中遇到显著困难，此时必须使用后备通用参数。在所调查的 15 种力场实现中，MMFF93——MMFF94 的直接前身——位列最佳之列；MMFF93 在统计上与其他力场不相上下，与所考虑的各种 MM2 和 MM3 实现并列，并且在实际测试分数上超过了除 MM2* 之外的所有力场（如果使用了上面讨论的 2-丁酮的替代实验值，它甚至可能略微超过 MM2*）。[^29a] 鉴于 MMFF93 和 MMFF94 在 Gundertofte 等人考虑的体系上预计差异不大（有时甚至没有差异），这些比较证实了 MMFF94 与 MM2 和 MM3 一样，在预测实验构象能量方面总体上是成功的。

#### 实验旋转势垒

在表 V 中，我们比较了 30 个分子体系的实验和 MMFF94 旋转势垒。在可能的情况下，我们从先前用于力场开发的汇编中提取了这些比较。[^29],[^54] 我们还列出了已发表的 MM3 势垒（如果有）。对于少数情况，我们列出了从受约束的 MP2/6-31G* 优化几何结构上的 "MP4SDQ/TZP" 计算获得的 ab initio 势垒，或者从扭转增量几何结构上的 MP2/TZP 计算更粗略估计的 ab initio 势垒，以进行比较。MMFF94 势垒基于涉及过渡区结构的能量比较，这些结构在施加扭转角约束下进行了优化；在过渡态受约束扭转角的值不能由对称性决定的情况下，使用了一系列紧密递增的值来定位过渡态。

对表 V 的检查表明，MMFF94 非常好地重现了实验势垒。列出的总体均方根偏差为 0.39 kcal/mol，仅占比较中包含的 28 个实验测定势垒的均方根值 3.67 kcal/mol 的 10% 多一点。然而，在某些情况下发现了较大的差异，而在其他情况下，实验势垒似乎确定得不好，特别是在从均方根比较中排除的两种情况下。以下是对这些情况的评论。

在甲基旋转中，有几个案例比较突出。在新戊烷中，甲基旋转势垒的实验值似乎有点高，因为 ab initio 计算显示随着拥挤度增加，势垒上升较为平缓。MMFF94 势垒也低于实验值，但 MM3 势垒（有意地）更低。相比之下，ab initio 结果与实验发现一致，即甲基势垒实际上在丙烯中比在乙醛中高，尽管 MMFF94 未能重现这一趋势。另一方面，MMFF94 非常好地重现了 CH$_3$—O 势垒的显著实验差异。MMFF94 还准确地重现了其他所列 CH$_3$—X 势垒的实验值和趋势。

在其他 C—C 势垒中，丁烷的 syn 势垒一直是众多理论研究的主题。[^55] MMFF94 和 "MP4SDQ/TZP" 计算都给出了比 Allinger 及其同事引用的实验估计值 4.54 kcal/mol 更大的势垒值。"MP4SDQ/TZP" 势垒为 5.79 kcal/mol，然而，这代表了高质量的 ab initio 计算，这些计算显然倾向于高估这个量。[^55] 作为比较，MM3 势垒为 4.8 kcal/mol[^17]，MMFF94 势垒为 5.21 kcal/mol，仅略高一些。

1,3-丁二烯和丙烯醛的条目表明，跨越 sp$^2$ 杂化碳原子之间的形式单键的部分共轭会导致相当大的势垒。MMFF94 非常好地重现了引用的实验势垒，尽管也存在其他有时不一致的实验结果。[^56] MM3 相对于反式构象体的丁二烯势垒为 7.31 kcal/mol[^57]，显著高于 MMFF94 的 6.19 kcal/mol 势垒。这种情况下的差异是因为 MM3 的参数化是为了重现 Carriera 通过分析拉曼倍频光谱推导出的 7.16 kcal/mol 的实验势垒。[^58] 然而，我们注意到，Carriera 的分析假设了一个扭转势，该势将第二个丁二烯构象体视为顺式构象体（C=C—C=C 扭转角为零）。相比之下，各种高质量的 ab initio 计算已将此第二种构象识别为旁式。[^3],[^59] Bock 及其同事[^60] 特别质疑了 Carriera 的分析，并使用类似的实验数据结合 ab initio 计算来指定旁式构象，并确定了表 V 中引用的 5.96 kcal/mol 的势垒；同一研究小组随后采用类似方法获得了 6.05 kcal/mol 的势垒。[^59] 类似地，Wiberg 和 Rosenberg 使用 ab initio 计算结合新的实验数据，得出结论认为旁式形式能更好地解释早期提出平面顺式结构所依据的那些实验观察结果。[^61] Furakawa 及其同事[^62] 在推导光谱力场时，也得出结论认为第二个构象体可能是旁式。因此，在我们看来，最终源自高质量 ab initio 计算的 MMFF94 势垒比 MM3 势垒更可信。

更重要的是，MMFF94 给出了 1,3-丁二烯第二个构象体的旁式结构，而 MM3(Pi) 计算产生顺式结构。[^57] 虽然热平均结构可能确实是顺式，但我们相信证据的权重表明真正的能量最小结构是旁式。第四部分[^3] 给出了进一步的讨论。

表 V 中的接下来五个条目涉及围绕连接苯环的键的旋转。这里的情况很复杂，因为理论与实验之间——以及实验与实验之间——存在巨大差异。因此，虽然实验、理论、MMFF94 和 MM3 都一致认为苯酚是平面的，并且羟基旋转出苯环平面的势垒为 $\sim 3.5$ kcal/mol，但苯甲醚的势垒一直难以通过实验表征。Kollman 及其同事的一项理论研究[^63] 中引用的一项实验结果将气相势垒定为 3.6 kcal/mol，略高于苯酚的势垒。他们引用的另一项研究发现了 5.7 kcal/mol 的气相势垒，而第三项据说得出的势垒"小于 3.1 kcal/mol"。显然，这里存在很大的实验误差。正如 Vincent 和 Hillier 在另一项最近的 ab initio 研究[^64] 中所做的那样，Kollman 及其同事提出，实验分析中忽略了一个显著的 $V_4$ 贡献，导致对势垒的高估相当大。"MP4SDO/TZP" 势垒为 1.91 kcal/mol，与引用的实验势垒相反，它比苯酚的势垒小，这正如基于较大的甲基应与苯环的邻位氢遇到更大的空间排斥，从而 destabilizing 平面基态所预期的那样。我们相信，密切重现此 ab initio 结果的 MMFF94 势垒是合理的。然而，我们将苯甲醚从均方根偏差的计算中排除，因为没有明确的实验结果可供比较。MM3 的 1.1 kcal/mol 势垒[^65] 似乎太小了。

苯乙酮的情况同样复杂，因为对位取代的苯甲醛和苯乙酮存在两组看似不一致的实验数据。一组以表 V 中列出的苯乙酮值 3.15 kcal/mol 为代表，使用红外光谱测量势垒，通常在气相中进行。[^66] 对于苯乙酮，该方法从单个观测到的振动频率和假设的扭转势 $V_2$ 形式外推势垒。第二组使用动态 NMR 光谱直接测量互变过程，但在溶剂中进行，并将势垒表示为活化焓和/或活化自由能。对于苯乙酮，这第二种方法在 CHCl$_2$F-CHClF$_2$ 中给出了 5.35 kcal/mol 的势垒。[^67] 对于苯甲醛，它在溶剂 CHCl$_2$F-CHClF$_2$、二甲醚和二氯甲烷中给出了约 7.7 kcal/mol 的势垒，相比之下，Durig 的红外方法在气相中测得的结果为 4.61 kcal/mol。[^66]

很难看出苯甲醛和苯乙酮在溶液和气相中获得的非常不同的结果如何能够协调一致。它们不能简单地归因于溶剂极性的差异，这一点从对位取代苯甲醛和苯乙酮的 NMR 势垒在从甲苯变为例如二氯甲烷或氯乙烷作为溶剂时，并未发生任何实质性或一致性的变化这一事实中可见一斑。[^67] 此外，对于苯乙酮，我们发现计算得到的平面平衡形式的 MP2/6-31G* 偶极矩为 3.48 Debye 单位，在过渡态结构中仅略微下降到 3.41 Debye 单位。因此，简单的理论考虑表明，溶剂极性对势垒的影响应该很小，甚至没有影响。然而，Durig 等人发现红外方法对于纯液体中的苯甲醛给出了更高的势垒 6.68 kcal/mol（相对于气相中的 4.61 kcal/mol），反映了凝聚相中"扭转频率的大位移"。[^66] 但是，我们并不知道中性体系的单分子速率过程在从气相到非极性溶剂时通常会显著减慢。Ab initio 计算支持更大的、源自 NMR 的势垒。我们在计算 MMFF94 的均方根偏差时使用了这个势垒。

对于二甲基二硫化物，MMFF94 和 MP2/TZP 计算给出的 S—S 势垒超过 8 kcal/mol。这些势垒在定性上与 6.8 kcal/mol 的实验值一致。[^68] 然而，后者是一个估计值，结合对甲基旋转势垒 1.5 kcal/mol 的估计以及其他两个参数的假设值，解释了在一定温度范围内的气相熵和热容。很难确定这个实验势垒的误差限应该是什么。我们怀疑 ab initio 势垒更可靠，因此在确定 MMFF94 的均方根偏差时排除了这个体系。低得多的 MM3 势垒 5.53 kcal/mol 源自对从相对低级别的 HF/3-21G* 计算获得的 5.55 kcal/mol 的 ab initio 势垒的拟合。[^69]

部分因为 Allinger 及其同事在少数情况下参数化 MM3 时使用了显著不同的旋转势垒实验值，我们没有引用 MM3 的总体均方根偏差。然而，对表 V 所列结果的调查表明，其均方根偏差将与 MMFF94 的相似。基于已发表数据的比较也可以与 UFF[^54] 和 CHARMm[^31] 进行。这些比较虽然有限，但表明 UFF 和 CHARMm 也表现相当好。在少数情况下，也可以将烷烃旋转势垒的比较与使用 Hagler 及其同事最近描述的 CFF93 力场获得的结果进行比较。[^70] "量子力学力场"，CFF93 的前身，[^70] 源自 HF/6-31G* 数据，正如我们所看到的，这些数据重现实验构象能量的效果远不如用于推导 MMFF94 的 "MP4SDQ/TZP" 模型。已发表的结果表明，CFF93 给出乙烷的甲基旋转势垒为 2.75 kcal/mol，丙烷为 3.11 kcal/mol，新戊烷为 3.95 kcal/mol，并且它给出丁烷中 anti→gauche 和 syn (gauche→gauche) 转化的势垒分别为 3.47 和 4.95 kcal/mol。[^70] 这些 CFF93 势垒与使用 MMFF94 和 MM3 获得的势垒相当。一个构象能量差也可以比较：CFF93 将丁烷的旁式构象体置于反式之上 0.72 kcal/mol，而 MMFF94 和 MM3 分别为 0.78 和 0.81 kcal/mol（表 II）。

Gundertofte 等人在之前引用的工作中也简要考虑了旋转势垒。[^29] 他们发现 MMFF93，即 MMFF94 的前身，是他们检查的 15 种力场实现中最好的。

#### 扭转角

下面显示的比较是通过使用 MP2/6-31G* 几何结构作为每种情况的输入结构，优化 348 个 MMFF94 平衡构象体和 315 个 MM2X 构象体获得的。该比较涵盖了 MMFF94 总共 7974 个扭转角和 MM2X 总共 7409 个扭转角。下面引用的结果以相对于参考 MP2/6-31G* 扭转角的均方根偏差（以度为单位）表示：

|        | MMFF94 | MM2X  |
| ------ | ------ | ----- |
| 扭转角 | 5.83   | 11.38 |

显然，MMFF94 的表现远优于 MM2X。

MMFF94 的一个相对困难的领域涉及酰胺中的扭转角，其中一些给出得相对较差，因为参考 MP2/6-31G* 结构中氮原子的金字塔化程度被 MMFF94 要么低估要么高估了。还出现了一些情况，其中 MMFF94 和 MP2/6-31G* 的扭转角存在明显差异，但 MMFF94 的结构不一定有误。这类情况特别涉及酯中连接氧的甲基、酰胺中连接氮的甲基以及某些羰基化合物中连接羰基碳的甲基的取向。这些情况是，在 MP2/TZP 表面上对扭转增量结构（用于 MMFF94 推导中以定义平衡扭转角）获得的相对能量表明，参考 MP2/6-31G* 结构本身并不是更高级别 MP2/TZP 表面上的平衡构象体。当我们排除 24 个有文件记录的此类情况的扭转角后，剩余比较的均方根偏差降至 5.42°。然而，这种减少可能低估了两个表面上构象差异的真实影响，因为我们远未获得更高级别表面的完整数据。为了获得可能影响的上限，我们排除了所有涉及酰胺、酯和不饱和酮中连接羰基碳的甲基；酰胺中连接氮的甲基；以及酯中连接氧的甲基的扭转角。排除这些扭转角后，7464 个剩余扭转角的均方根偏差降至 4.23°。相对于在高水平 ab initio 表面上优化的构象体，所能获得的均方根偏差的最佳估计可能约为 5°。

### MMFF 功能形式和参数化的两个方面

#### 1,4-静电相互作用的缩放

分子力场的开发者不可避免地要在包含哪些项以及采用何种函数形式方面做出许多选择。就 MMFF94 而言，MMFF94 对范德华势使用了一种新颖的"缓冲"形式，并通过在分母中引入类似的缓冲常数来修改库仑形式。像通常一样，MMFF94 排除了 1,2- 和 1,3-相互作用——或者等效地，使用零缩放因子。但是，虽然 MM2[^6] 和 MM3[^7] 对 1,4-非键相互作用使用缩放因子 1，其他力场选择中间值。[^31],[^71],[^72] 由于 1,4-相互作用通常涉及一对邻位相关键的侧面接触，而不是其他情况下通常遇到的或多或少是正面接触的相互作用，因此它们很可能需要区别对待。

缩放 1,4-非键相互作用的必要性是在 MMFF94 开发过程中发现的，当时我们将大量高极性、多官能团化合物（如羟基羧酸及其酯以及二羧酸）添加到参数化集中。在使用当时隐含的 1,4-相互作用缩放因子为 1 的情况下，我们在一些相关的构象能量中获得了比预期更大的误差，但发现减小静电缩放因子的值可以减少最大的误差。最终，我们为 1,4-静电缩放因子选择了 0.75 的值。我们还检查了缩放 1,4-范德华相互作用对构象能量的影响，但发现使用不同于 1 的缩放因子没有优势。

#### 脂肪族氢原子上的电荷

在参数化 MM2[^6] 和 MM3[^7] 时，Allinger 及其同事将氢和 sp$^3$ 杂化碳之间键的偶极矩设为零。我们将这一思想延续到 MM2X 和 MMFF94 中，为此类氢分配零部分电荷。其他力场 [^70],[^73]-[^75] 和其他电荷分配程序 [^2],[^76] 通常为脂肪族氢分配 0.05–0.15 的正电荷，尽管有时也会分配小的负电荷。[^2],[^77] 这里我们考虑 MMFF94 中所做选择的基础，并描述其对构象能量的影响。

在对 MMFF94 的早期前体进行初步开发时，我们发现当为脂肪族氢分配了显著的正电荷时，某些构象能量变得非常难以拟合。一个特别令人关注的情况涉及环己醇，其中出现两个平伏键和两个轴向构象体（图 2）。在这里，"MP4SDO$_2$/TZP" 计算，就像我们之前进行的各种 ab initio 计算一样，发现 equatorial-C$_1$ 构象体 (OH07c) 能量最低。这些计算进一步表明，equatorial-C$_s$ (OH07a) 和 axial-C$_1$ (OH07d) 构象体高出十分之几千卡每摩尔，并且发现 axial-C$_s$ 构象体 (OH07b) 比 equatorial-C$_1$ 构象体高出超过 1 kcal/mol（参见表 VI）。因此，构象体 OH07c 和 OH07d 似乎导致了实验观察到的对平伏键环己醇约 $\sim 0.5$ kcal/mol 的偏好（参见表 II）。出现的问题尤其涉及 OH07b 的位置，这是能量相对较高的 C$_s$ 对称性轴向构象体。在这种构象中，羟基氢向后折叠到环上，并与附近的亚甲基碳发生有利的相互作用。当脂肪族氢带正电时，这些碳带有净负电荷。因此，带正电的脂肪族氢选择性地稳定了 axial-C$_s$ 形式，甚至可以使其能量低于 axial-C$_1$ 构象体。例如，当脂肪族氢被分配 0.10 的正电荷（并且碳电荷相应调整）但不对力场进行其他更改时，MMFF94 将 axial-C$_s$ 形式置于 axial-C$_1$ 构象体之下 1.44 kcal/mol。Ab initio 计算和实验观察都强烈表明，axial-C$_s$ 构象体实际上能量更高，实验观察发现在甲氧基环己烷中存在类似的轴向、平伏键分离（参见表 II），而在甲氧基环己烷中，axial-C$_s$ 构象体由于空间位阻原因是不可行的。

为了确定给脂肪族氢分配非零电荷对总力场性能的影响，我们通过使用一系列修改的 C-H 键电荷增量（这些增量分别赋予脂肪族氢 $-0.05, 0.05, \text{和 } 0.10$ 的电荷）[^78] 重新拟合完整的 "MP4SDO$_2$/TZP" 和 MP$_2$/TZP 构象和扭转剖面能量，推导出了新的扭转参数集。一些相关结果显示在表 VI 中。这些结果表明，MMFF 无法有效地调整扭转贡献来抵消环己醇 axial-C$_s$ 形式的大静电稳定化作用。这一发现可以从四个构象体中存在的旁式和反式 CCCO 或 CCOH 相互作用的数量来理解。这些相互作用数量之间的关系使得对旁式和反式 CCCO 和 CCOH 扭转相对能量的任何改变，都无法在不损害其他构象比较的情况下将 axial-C$_s$ 构象体的能量提高到所需程度。悬而未决的问题是，对影响其他项的参数的更改，或其他力场中包含的附加项的贡献，是否能够产生必要的抵消。对于 MMFF，表 VI 中引用的均方根差异表明对于环己醇，脂肪族氢电荷为零几乎是 optimal 的。我们应该注意，其他构象比较也会因带正电的脂肪族氢而受到损害。例如，当脂肪族氢不带电时，MMFF94 大致正确地给出了甲氧基环己烷的 axial-C$_1$ 和 equatorial-C$_1$ 构象体之间的差异。然而，当这些氢带有 0.10 的正电荷时，对于重新推导的力场，差异上升到约 1.6 kcal/mol，远高于表 II 中引用的实验值 0.45 kcal/mol。

即使对脂肪族氢使用零电荷也不足以确保环己醇（和其他体系）的构象比较结果良好。特别是，我们发现，除非 MMFF 对涉及羟基氢的拥挤相互作用分配显著的空间排斥，否则我们无法拟合 OH07 和 OH06（环戊醇）的构象能量。这一考虑，以及其他因素，导致我们在进行这项工作时改变了 MMFF 的形式。在某个阶段，我们曾为极性氢分配较小的半径，并对所有势阱深度 $\varepsilon_{ij}$ 和最小能量间距 $R^*_{ij}$ 使用相同的组合规则。然而，正如别处详细说明的那样，MMFF94 现在为极性氢分配较大的半径，但当此类氢与氢键受体相互作用时，会减小 $\varepsilon_{ij}$ 和 $R^*_{ij}$。尽管可能不美观，但这种混合方法的优点在于允许 MMFF94 很好地描述氢键相互作用，同时保留拟合 otherwise 麻烦的构象能量所需大小的空间排斥。

#### MMFF94 功能形式的局限性和可能的改进

如前所述，表 I 所列的 249 个构象比较中，有 18 个与参考“MP4SDQ/TZP”值的偏差在 0.5–1 kcal/mol 之间，另有 4 个偏差在 1–2 kcal/mol 之间。这些情况许多发生在两个或多个强极性基团紧密邻近的化合物中，这表明困难可能源于 MMFF94 静电表示的缺陷。在本节中，我们讨论这些及其他异常情况，并提出功能形式上可能的改进。

特别有问题的是乙醛酸、乙醇酸、草酸和丙酮酸的 CA04-、CA05-、CA08- 和 CA09-系列比较，以及乙醇酸甲酯的 CE10-系列比较，其中大多数涉及具有相邻 C=O 基团的结构。此集合中最大的误差出现在表 I 中引用的乙醛酸构象体 CA04a–CA04b 比较中。同一比较也包含在表 II 中，其中实验和“MP4SDQ/TZP”构象能量也可以看到彼此差异很大。

对于乙二胺（另一种极性多功能化合物），甚至出现了 2–3 kcal/mol 的更大误差。虽然反式、旁式构象能量差（表 I 中的 NH18a – NH18b）本身被 MMFF94 准确给出，但涉及绕 C—N 键 $\pm 30^\circ$ 和 $\pm 60^\circ$ 旋转的扭转增量 MP2/TZP 比较（结果未显示）则不然。对于 MMFF94，静电相互作用对构象能量产生了很大的贡献，这些贡献在大小和模式上与 MP2/TZP 能量反映的构象剖面有很大不同。当将相关的 MP2/TZP 构象能量包含在最小二乘拟合中时，一些推导出的扭转参数变得严重受损，以至于力场无法再充分描述简单胺的构象比较。在本工作的后期阶段，如前所述，我们因此通过在实际中将权重因子 $w_i$ 设为零，将乙二胺的 17 个 MP2/TZP 比较从最小二乘拟合中移除。这样做，我们接受了 MMFF94 的功能形式无法处理这些构象比较的含义。

我们怀疑乙二胺的问题可能主要源于 MMFF94 忽略了极化率。其使用简单的原子中心电荷也可能是一个因素，但似乎不是主要原因。为了探索后一种可能性，我们创建了一个偏心电荷模型，通过将每个 C—N 键旋转异构体中的氮电荷中心沿由连接的氢和碳原子形成的伪三重轴物理位移 0.1 Å。我们选择的这种位移在大小和方向上与水的 TIP4P 模型中所做的位移相似，它使得有效的 N—N 距离成为 C—N 旋转角的函数，从而改变了静电对 C—N 旋转剖面的贡献。然而，不幸的是，我们发现这种修改改善了乙二胺的一些有问题的相对能量，但损害了其他一些。

另一个困难的案例涉及 N-甲基甲亚胺 (IM02a) 和结构相似的 N-甲基甲脒 (IM04b) 的反式构象体中甲基的平衡取向。如图 3 所示，前者的一个甲基 C—H 键与 N=C 双键形成重叠构象，很像丙烯中 C—H 键与 C=C 双键重叠，而后者的两个 C—H 键与 N=C 双键形成交错构象。我们无法找到任何方法来满意地解释这种约 $\sim 60^\circ$ 的取向偏好变化。碰巧的是，MMFF94 参数支持正确的甲基取向，但描述了 N-甲基甲亚胺中 essentially 自由的甲基旋转，因此，低估了 IM02t–IM02a 比较的势垒约 $\sim 2$ kcal/mol。这种偏好变化可能反映了甲脒中增强的超共轭相互作用。如果是这样，很难看出如何在力场模型中适应这种效应，除非为两个体系中甲基化的氮分配不同的原子类型，尽管它们的环境看起来非常相似。

最后一个值得注意的案例涉及共振离域的胍阳离子以及类似物种（如脒阳离子）中的 C—N 键旋转。例如，胍阳离子中 NH$_2$ 基团 $90^\circ$ 的面外旋转移除了该 C—N 键的部分 pi 键合，并将带电的 pi 体系限制在碳和剩余两个 NH$_2$ 基团上。结果，与正交 NH$_2$ 基团形成的 C—N 键应该伸长，并且电荷分布应该发生显著变化。包含键-扭转交叉项的力场，如 MM3 和 CFF93，可以容易地重现键的伸长。然而，正确模拟电荷分布的变化则是另一回事。MMFF94，像其他当代力场一样，错误地使胍中的三个氮原子等价，与构象无关。这种等价虽然适用于平面体系，但可能导致对 C—N 键旋转的构象能量学的描述相对较差。

我们怀疑，需要比 MMFF94 和其他当代力场中使用的更复杂的分子静电势描述，才能准确描述极性、多官能团化合物。我们建议，前面讨论的环己醇和甲氧基环己烷构象体以及本节讨论的体系构成了一组要求苛刻的测试系统，任何改进的力场模型都应该被要求解决这些问题。

#### MMFF94 扭转参数

在本节中，我们描述了 MMFF94 扭转参数的一个小子集。完整集包含在第一部分[^1]的补充材料中，并且可以以计算机可读的形式访问。[^80] 表 VII 中列出的参数源自以下数值原子类型的各种组合：1、2、3、5、7、10 和 28。这些原子类型分别描述饱和碳、烯碳、羰基碳、连接碳的氢、羰基氧、酰胺氮和酰胺氢。它们涵盖了简单的烷烃、烯烃、醛、酮和酰胺。在这个有限的原子类型集合内，列表参数是完整的。

表 VII 所示的参数文件格式如下。第一列给出扭转类型索引 TT$_{IIKL}$ 的值。该索引通常取值为 "0"，但当 J-K 键的键类型索引[^3] BT$_{IK}$ 为 1 时为 "1"；当 BT$_{IK}$ 为 "0" 但 BT$_{II}$ 和/或 BT$_{KL}$ 为 "1" 时为 "2"；当 i、j、k 和 l 都是同一四元环的成员时为 "4"；当四个原子是五元环的成员且至少一个是 sp$^3$ 杂化碳（MMFF 原子类型 1）时为 "5"。扭转参数使用规范索引排序
$$
CXT = MC*(J*MA^3 + K*MA^2 + I*MA + L) + TT_{IIKL}
$$
其中 MC 至少是允许的最大扭转类型索引加 1，MA 至少是允许的最大 MMFF 原子类型加 1。[^81]因此，$J$ 变化最慢，$K$ 次之。对于 $I$、$L$ 以及变化最快的 $TT_{IIKL}$，对排序的影响可以在表 VII 中看到。

对于无法使用主要数值 MMFF 原子类型和相关扭转类型索引 $TT_{IIKL}$ 解析的一重、二重和三重扭转参数请求，首先通过第一部分中概述的降级等价程序处理。参数搜索可能以请求完全通配的 $M:0-J-K-0$ 参数（其中 $M$ 表示扭转类型索引 $TT_{IIKL}$）结束，或者，在少数情况下，可能定位到"半通配" $M:0-J-K-L$ 或 $M:I-J-K-0$ 参数。如有必要，会调用一个仔细校准的经验规则。[^4]

### 结论性讨论

本文完成了新的 Merck 分子力场 (MMFF94) 核心计算推导部分的推导和文档编制。它描述了使用量子力学计算数据对扭转相互作用和构象能量进行参数化的过程。高水平数据提供了 249 次在优化的 MP2/6-31G$^*$ 几何结构上计算的 "MP4SDQ/TZP" 相对构象能量的比较，并产生了 1192 次 MP2/TZP 对扭转增量结构的相对能量的比较，这些结构探测了绕特定化学键旋转的能量后果。将 MMFF94 扭转参数拟合到此计算数据使用了 TORFIT，这是一个在这些实验室开发的强大程序，能够同时考虑所有计算的构象能量。重要的是，拟合程序是自适应的，允许使用中间结果来定义力场模型并指导额外计算数据的生成和使用。

按照当前标准，MMFF94 表现相当好。它重现 "MP4SDQ/TZP" 构象能量和 MP2/TZP 对扭转增量结构的比较，均方根偏差分别为 0.31 和 0.50 kcal/mol，而 ab initio 相对能量的均方根值分别为 3.88 和 4.37 kcal/mol。MM2X 的表现明显差得多。对一组 37 个实验确定的构象能量、焓和自由能以及 28 个旋转势垒的多样化比较进一步证明，MMFF94 即使仅针对计算数据进行参数化，其预测构象能量和旋转势垒的能力也与 MM3 相当。在每种情况下，MMFF94 的均方根偏差大约为 0.4 kcal/mol，而实验测定的均方根值分别为 2.3 和 3.7 kcal/mol。MMFF94 能较好地给出扭转角；相对于 MP2/6-31G$^*$ 优化几何结构的均方根误差大约为 5°。

MMFF94 推导中使用的力场模型和方法论都可以通过多种方式进一步改进。理想情况下，分子几何结构和构象能量的数据应来自单一的计算模型，但这在当前工作中不可行。力场模型中的一些显著局限性也需要解决。特别是，对于含有两个或多个紧密邻近的高极性部分的分子遇到的相对较大的困难，可能源于 MMFF94 和其他当代力场中使用的过于简化的静电表示。虽然已经进行了一些开创性研究，[^5] 但未来的力场需要一致性地包含极化率，并且应该采用比使用固定的原子中心电荷所能获得的更复杂和更准确的静电表示，也许可以通过包含原子中心偶极子来实现。[^8] 一篇引用此内容及其他可能扩展的综述最近已经出现。[^8] 前面一节讨论了许多要求苛刻的测试系统，这些系统可能对开发或验证未来物理上更优越的力场有用。另一个可能证明有益的修改是根据扭转相互作用的局部对称性适应线性组合来重新表述扭转势。例如，这种修改将把扭转运动与面外运动解耦；对于像乙烷这样的系统，它将产生一个单一的复合扭转坐标，符合光谱学的表述。

我们认为扭转参数的确定是 MMFF94 开发中一个特别强大的组成部分。定义 MMFF94 推导特殊性质的一个要素是它在最小二乘拟合中同时使用所有可用的构象能量数据。对比鲜明的"官能团"构建方法已在大多数其他力场推导中使用。虽然这种方法的实际局限性尚不清楚，但我们更偏好这种方法，通过其构建方式，允许参数达到相互一致的值。MMFF94 参数化的第二个方面赋予了一个特别重要的优势。特别是，其源自 ab initio 数据的推导确保了 MMFF94 在其核心参数化范围内都能同样好地预测构象能量和势垒。相比之下，可靠地开发像 MM2 或 MM3 这样的实验推导力场所需的构象能量数据，对于需要由通用有机/生物有机力场（如 MMFF94）准确描述的有机结构范围的大部分——实际上是绝大部分——来说是有限的或完全缺乏的。此外，ab initio 误差往往在大小上相对适中且在性质上是可预测的。正如前面讨论的几个例子中明显的那样，相比之下，相对构象能量和势垒的实验测定误差可能很大且不可预测。第三个要素涉及用于获得 MMFF94 扭转参数化所用计算数据的相对较高的理论水平。相比之下，CFF93 方法使用相对简单的 HF/6-31G* 计算。我们的结果表明，这种方法上的差异可能对推导出的力场解释构象能量的能力产生显著影响。因此，HF/6-31G* 计算预测实验观察到的相对构象能量的效果（均方根偏差 0.73 kcal/mol）比本工作中使用的 "MP4SDQ/TZP" 计算（均方根偏差 0.37 kcal/mol）差得多。很明显，仅基于 HF/6-31G* 数据推导的力场不可能比 HF/6-31G* 计算本身更准确地预测实验构象能量。要达到与 MMFF94（均方根偏差 0.40 kcal/mol）相当的精度水平，这样的力场还需要以某种方式针对实验进行校准。但是，虽然这种校在某些情况下是可行的，但通常无法进行，因为可用的有用实验数据太少。在定义 MMFF94 的潜在应用范围时，特别值得注意的是基于甘氨酸和丙氨酸二肽及二肽类似物在 MP2/6-31G* 几何结构上的 "MP4SDQ/TZP" 能量进行的一系列构象比较。当结合 also 对实现分子间相互作用平衡参数化的仔细关注来考虑时，我们认为，对此高质量数据的良好拟合证明了将 MMFF94 指定为"蛋白质"力场以及"有机"力场是合理的。我们相信它在这两个领域都会表现良好。

### 补充材料

扭转和其他 MMFF94 参数的计算机可读文件[^80] 以及附录 A（关于 MMFF94 扭转参数推导的详细讨论）[^24] 可在补充材料中获取。